---
ms.date: 06/05/2017
keywords: powershell,cmdlet
title: Windows PowerShell 5.0 中的新增功能
description: 这些发行说明介绍了 Windows PowerShell 5.x 中的新增功能和更改。
ms.openlocfilehash: 82d3e10fa417085911242241dcfc54e931df8eb4
ms.sourcegitcommit: 488a940c7c828820b36a6ba56c119f64614afc29
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/27/2020
ms.locfileid: "92663367"
---
# <a name="whats-new-in-windows-powershell-50"></a><span data-ttu-id="32a81-104">Windows PowerShell 5.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-104">What's New in Windows PowerShell 5.0</span></span>

<span data-ttu-id="32a81-105">Windows PowerShell 5.0 新增了大量功能，不仅扩展并提升了自身的用途和可用性，还方便用户能够更轻松、全面地控制和管理基于 Windows 的环境。</span><span class="sxs-lookup"><span data-stu-id="32a81-105">Windows PowerShell 5.0 includes significant new features that extend its use, improve its usability, and allow you to control and manage Windows-based environments more easily and comprehensively.</span></span>

<span data-ttu-id="32a81-106">Windows PowerShell 5.0 可向后兼容。</span><span class="sxs-lookup"><span data-stu-id="32a81-106">Windows PowerShell 5.0 is backward-compatible.</span></span> <span data-ttu-id="32a81-107">为 Windows PowerShell 4.0、Windows PowerShell 3.0 和 Windows PowerShell 2.0 设计的 cmdlet、提供程序、模块、管理单元、脚本、函数和配置文件通常适用于 Windows PowerShell 5.0，无需更改。</span><span class="sxs-lookup"><span data-stu-id="32a81-107">Cmdlets, providers, modules, snap-ins, scripts, functions, and profiles that were designed for Windows PowerShell 4.0, Windows PowerShell 3.0, and Windows PowerShell 2.0 generally work in Windows PowerShell 5.0 without changes.</span></span>

## <a name="installing-windows-powershell"></a><span data-ttu-id="32a81-108">安装 Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="32a81-108">Installing Windows PowerShell</span></span>

<span data-ttu-id="32a81-109">Windows PowerShell 5.0 默认安装在 Windows Server 2016 Technical Preview 和 Windows 上</span><span class="sxs-lookup"><span data-stu-id="32a81-109">Windows PowerShell 5.0 is installed by default on Windows Server 2016 Technical Preview and Windows</span></span>
10.

<span data-ttu-id="32a81-110">若要在 Windows Server 2012 R2、Windows 8.1 企业版或 Windows 8.1 专业版上安装 Windows PowerShell 5.0，请下载并安装 [Windows Management Framework 5.0](https://aka.ms/wmf5download)。</span><span class="sxs-lookup"><span data-stu-id="32a81-110">To install Windows PowerShell 5.0 on Windows Server 2012 R2, Windows 8.1 Enterprise, or Windows 8.1 Pro, download and install [Windows Management Framework 5.0](https://aka.ms/wmf5download).</span></span> <span data-ttu-id="32a81-111">请务必先阅读下载详细信息并确保满足所有系统要求，然后再安装 Windows Management Framework 5.0。</span><span class="sxs-lookup"><span data-stu-id="32a81-111">Be sure to read the download details, and meet all system requirements, before you install Windows Management Framework 5.0.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="32a81-112">本主题内容</span><span class="sxs-lookup"><span data-stu-id="32a81-112">In this topic</span></span>

- [<span data-ttu-id="32a81-113">KB 3000850 中的 Windows PowerShell 4.0 DSC 更新</span><span class="sxs-lookup"><span data-stu-id="32a81-113">Windows PowerShell 4.0 DSC updates in KB 3000850</span></span>](#windows-powershell-40-updates-in-november-2014-update-rollup-kb-3000850)
- [<span data-ttu-id="32a81-114">Windows PowerShell 5.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-114">New features in Windows PowerShell 5.0</span></span>](#new-features-in-windows-powershell-50)
- [<span data-ttu-id="32a81-115">Windows PowerShell 4.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-115">New features in Windows PowerShell 4.0</span></span>](#new-features-in-windows-powershell-40)
- [<span data-ttu-id="32a81-116">Windows PowerShell 3.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-116">New features in Windows PowerShell 3.0</span></span>](#new-features-in-windows-powershell-30)

## <a name="windows-powershell-40-updates-in-november-2014-update-rollup-kb-3000850"></a><span data-ttu-id="32a81-117">2014 年 11 月更新汇总中的 Windows PowerShell 4.0 更新 (KB 3000850)</span><span class="sxs-lookup"><span data-stu-id="32a81-117">Windows PowerShell 4.0 updates in November 2014 update rollup (KB 3000850)</span></span>

<span data-ttu-id="32a81-118">针对 Windows PowerShell 4.0 中 Windows PowerShell Desired State Configuration (DSC) 的许多更新和改进均在 [2014 年 11 月 Windows RT 8.1、Windows 8.1 和 Windows Server 2012 R2 更新汇总](https://support.microsoft.com/kb/3000850/) (KB 3000850) 中提供。</span><span class="sxs-lookup"><span data-stu-id="32a81-118">Many updates and improvements to Windows PowerShell Desired State Configuration (DSC) in Windows PowerShell 4.0 are available in the [November 2014 update rollup for Windows RT 8.1, Windows 8.1, and Windows Server 2012 R2](https://support.microsoft.com/kb/3000850/) (KB 3000850).</span></span> <span data-ttu-id="32a81-119">你可以通过在 Windows PowerShell 中运行 `Get-Hotfix -Id KB3000850` 以确定你的系统上是否已安装 KB 3000850。</span><span class="sxs-lookup"><span data-stu-id="32a81-119">You can determine if KB 3000850 is installed on your system by running `Get-Hotfix -Id KB3000850` in Windows PowerShell.</span></span>

- <span data-ttu-id="32a81-120">对 [PSDesiredStateConfiguration](/powershell/module/PSDesiredStateConfiguration) 模块中现有 cmdlet 的更新。</span><span class="sxs-lookup"><span data-stu-id="32a81-120">Updates to existing cmdlets in the [PSDesiredStateConfiguration](/powershell/module/PSDesiredStateConfiguration) module</span></span>
  - <span data-ttu-id="32a81-121">[Get-DscResource](/powershell/module/PSDesiredStateConfiguration) 更加快速（特别是在 ISE 中）。</span><span class="sxs-lookup"><span data-stu-id="32a81-121">[Get-DscResource](/powershell/module/PSDesiredStateConfiguration) is faster (especially in ISE).</span></span>
  - <span data-ttu-id="32a81-122">[Start-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) 有一个新的 -UseExisting 参数，使用该参数可重新应用上一次应用的配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-122">[Start-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) has a new parameter, -UseExisting, which reapplies the last applied configuration.</span></span>
  - <span data-ttu-id="32a81-123">已修复 [Start-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) -Force。</span><span class="sxs-lookup"><span data-stu-id="32a81-123">[Start-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) -Force has been fixed.</span></span>
  - <span data-ttu-id="32a81-124">[Get-DscLocalConfigurationManager](/powershell/module/PSDesiredStateConfiguration) 显示有关引擎状态的更多有用信息。</span><span class="sxs-lookup"><span data-stu-id="32a81-124">[Get-DscLocalConfigurationManager](/powershell/module/PSDesiredStateConfiguration) displays more useful information about the engine state.</span></span>
  - <span data-ttu-id="32a81-125">[Test-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) 现在可返回计算机名称以及 True 或 False。</span><span class="sxs-lookup"><span data-stu-id="32a81-125">[Test-DscConfiguration](/powershell/module/PSDesiredStateConfiguration) now returns the computer name along with True or False.</span></span>
  - <span data-ttu-id="32a81-126">[New-DscChecksum](/powershell/module/PSDesiredStateConfiguration) 现在支持 UNC 路径。</span><span class="sxs-lookup"><span data-stu-id="32a81-126">[New-DscChecksum](/powershell/module/PSDesiredStateConfiguration) now supports UNC paths.</span></span>

- <span data-ttu-id="32a81-127">[PSDesiredStateConfiguration](/powershell/module/PSDesiredStateConfiguration) 模块中新的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-127">New cmdlets in the [PSDesiredStateConfiguration](/powershell/module/PSDesiredStateConfiguration) module</span></span>
  - <span data-ttu-id="32a81-128">[Update-DscConfiguration](/powershell/module/PSDesiredStateConfiguration/Update-DscConfiguration)：按需执行请求服务器检查。</span><span class="sxs-lookup"><span data-stu-id="32a81-128">[Update-DscConfiguration](/powershell/module/PSDesiredStateConfiguration/Update-DscConfiguration): Performs an on-demand pull server check.</span></span>
  - <span data-ttu-id="32a81-129">[Stop-DscConfiguration](/powershell/module/PSDesiredStateConfiguration/Stop-DscConfiguration)：停止已运行的配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-129">[Stop-DscConfiguration](/powershell/module/PSDesiredStateConfiguration/Stop-DscConfiguration): Stops a configuration that is already running.</span></span>
  - <span data-ttu-id="32a81-130">[Remove-DscConfigurationDocument](/powershell/module/PSDesiredStateConfiguration/Remove-DscConfigurationDocument)：使你能够在各个阶段中（挂起、之前或当前）删除配置文档。</span><span class="sxs-lookup"><span data-stu-id="32a81-130">[Remove-DscConfigurationDocument](/powershell/module/PSDesiredStateConfiguration/Remove-DscConfigurationDocument): Lets you remove configuration documents in various stages (pending, previous, or current).</span></span>

- <span data-ttu-id="32a81-131">语言增强功能</span><span class="sxs-lookup"><span data-stu-id="32a81-131">Language enhancements</span></span>
  - <span data-ttu-id="32a81-132">DependsOn 现在支持复合资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-132">DependsOn now supports composite resources.</span></span>
  - <span data-ttu-id="32a81-133">DependsOn 现在支持资源实例名称中带有数字。</span><span class="sxs-lookup"><span data-stu-id="32a81-133">DependsOn now supports numbers in resource instance names.</span></span>
  - <span data-ttu-id="32a81-134">计算结果为空的节点表达式不再引发错误。</span><span class="sxs-lookup"><span data-stu-id="32a81-134">Node expressions that evaluate to empty no longer throw errors.</span></span>
  - <span data-ttu-id="32a81-135">已修复当节点表达式计算结果为空时发生的错误。</span><span class="sxs-lookup"><span data-stu-id="32a81-135">An error that occurs if a node expression evaluates to empty has been fixed.</span></span>
  - <span data-ttu-id="32a81-136">配置调用的配置现在可在 Windows PowerShell 控制台中使用。</span><span class="sxs-lookup"><span data-stu-id="32a81-136">Configurations calling configurations now work in the Windows PowerShell console.</span></span>

- <span data-ttu-id="32a81-137">请求模式增强功能</span><span class="sxs-lookup"><span data-stu-id="32a81-137">Pull mode enhancements</span></span>
  - <span data-ttu-id="32a81-138">请求模式现在支持所有的 ZIP 文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-138">Pull mode now supports all ZIP files.</span></span>
  - <span data-ttu-id="32a81-139">**AllowModuleOverwrite** 现在可正常工作。</span><span class="sxs-lookup"><span data-stu-id="32a81-139">**AllowModuleOverwrite** now works correctly.</span></span>

- <span data-ttu-id="32a81-140">复原能力改进</span><span class="sxs-lookup"><span data-stu-id="32a81-140">Resiliency improvements</span></span>
  - <span data-ttu-id="32a81-141">新的 **DebugMode** 使你能够重新加载资源模块。</span><span class="sxs-lookup"><span data-stu-id="32a81-141">New **DebugMode** lets you reload resource modules.</span></span>
  - <span data-ttu-id="32a81-142">如果出现配置失败，pending.mof 文件则不会被删除。</span><span class="sxs-lookup"><span data-stu-id="32a81-142">If a configuration failure occurs, the pending.mof file is not deleted.</span></span>
  - <span data-ttu-id="32a81-143">当元配置设置损坏时，本地配置管理器 (LCM) 更具有复原能力。</span><span class="sxs-lookup"><span data-stu-id="32a81-143">The Local Configuration Manager (LCM) is now more resilient when metaconfiguration settings have become corrupted.</span></span>

- <span data-ttu-id="32a81-144">诊断改进</span><span class="sxs-lookup"><span data-stu-id="32a81-144">Diagnostic improvements</span></span>
  - <span data-ttu-id="32a81-145">当 LCM 将计时器设置为与你已指定的设置不同时，会显示一条警告。</span><span class="sxs-lookup"><span data-stu-id="32a81-145">A warning is displayed when the LCM sets the timer to different settings than you have specified.</span></span>
  - <span data-ttu-id="32a81-146">错误日志文件现在包括 Windows PowerShell 资源的调用堆栈。</span><span class="sxs-lookup"><span data-stu-id="32a81-146">Error log files now contain the call stack for Windows PowerShell resources.</span></span>

- <span data-ttu-id="32a81-147">灵活性改进</span><span class="sxs-lookup"><span data-stu-id="32a81-147">Flexibility improvements</span></span>
  - <span data-ttu-id="32a81-148">LocalConfigurationManager 资源拥有一个新属性， **ActionAfterReboot** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-148">The LocalConfigurationManager resource has a new property, **ActionAfterReboot**.</span></span>
    - <span data-ttu-id="32a81-149">ContinueConfiguration（默认值）：在目标节点重启后自动恢复配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-149">ContinueConfiguration (default value): Automatically resumes a configuration after a target node restarts.</span></span>
    - <span data-ttu-id="32a81-150">StopConfiguration：不会在节点重启后自动恢复配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-150">StopConfiguration: Do not automatically resume a configuration after a node restarts.</span></span>
  - <span data-ttu-id="32a81-151">现在一致性运行可以比 PULL 操作发生的更频繁，或者反之亦然。</span><span class="sxs-lookup"><span data-stu-id="32a81-151">A consistency run can now occur more often than a PULL operation, or vice-versa.</span></span>
  - <span data-ttu-id="32a81-152">版本控制支持：DSC 现在可以识别在较新的客户端上生成的文档（包括使用 [WMF 5.0](https://aka.ms/wmf5download) 生成的文档）。</span><span class="sxs-lookup"><span data-stu-id="32a81-152">Versioning support: DSC can now recognize a document that was generated on a newer client (included with [WMF 5.0](https://aka.ms/wmf5download)).</span></span>

- <span data-ttu-id="32a81-153">错误防护改进</span><span class="sxs-lookup"><span data-stu-id="32a81-153">Error prevention improvements</span></span>
  - <span data-ttu-id="32a81-154">现在在应用配置前，会强制执行模块版本。</span><span class="sxs-lookup"><span data-stu-id="32a81-154">Module version is now enforced before a configuration is applied.</span></span>
  - <span data-ttu-id="32a81-155">现在已为 Get-TargetResource、Set-TargetResource 或 Test-TargetResource 调用正确地设置了 **DebugPreference** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-155">**DebugPreference** is now set correctly for Get-, Set-, or Test-TargetResource calls.</span></span>

- <span data-ttu-id="32a81-156">凭据处理改进</span><span class="sxs-lookup"><span data-stu-id="32a81-156">Credential handling improvements</span></span>
  - <span data-ttu-id="32a81-157">现在如果同时指定 **Certificate** 和 **PSDscAllowPlainTextPassword** ，则可使用证书。</span><span class="sxs-lookup"><span data-stu-id="32a81-157">A certificate is now used, if both **Certificate** and **PSDscAllowPlainTextPassword** are specified.</span></span>
  - <span data-ttu-id="32a81-158">凭据是解密的、甚至对 Get-TargetResource 来说也是如此。</span><span class="sxs-lookup"><span data-stu-id="32a81-158">Credentials are decrypted, even for Get-TargetResource.</span></span>
  - <span data-ttu-id="32a81-159">元配置凭据为加密的和解密的。</span><span class="sxs-lookup"><span data-stu-id="32a81-159">Metaconfiguration credentials are encrypted and decrypted.</span></span>
  - <span data-ttu-id="32a81-160">当 PSCredential 在嵌入对象中时，它们是解密的。</span><span class="sxs-lookup"><span data-stu-id="32a81-160">PSCredentials are now decrypted when they are in an embedded object.</span></span>

- <span data-ttu-id="32a81-161">内置资源改进</span><span class="sxs-lookup"><span data-stu-id="32a81-161">Built-in resource improvements</span></span>
  - <span data-ttu-id="32a81-162">Package 资源</span><span class="sxs-lookup"><span data-stu-id="32a81-162">The Package resource</span></span>
    - <span data-ttu-id="32a81-163">不再安装错误的包（无论从本地或 Web 资源中安装）。</span><span class="sxs-lookup"><span data-stu-id="32a81-163">No longer installs the wrong package (either from local or web sources).</span></span>
    - <span data-ttu-id="32a81-164">现在支持 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="32a81-164">Now supports HTTPS.</span></span>
  - <span data-ttu-id="32a81-165">现在在 [Package 资源](/powershell/scripting/dsc/reference/resources/windows/packageresource)中支持 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="32a81-165">There is now support for HTTPS in the [Package resource](/powershell/scripting/dsc/reference/resources/windows/packageresource).</span></span>
  - <span data-ttu-id="32a81-166">[Archive 资源](/powershell/scripting/dsc/reference/resources/windows/archiveresource)现在支持凭据。</span><span class="sxs-lookup"><span data-stu-id="32a81-166">[Archive resource](/powershell/scripting/dsc/reference/resources/windows/archiveresource) now supports credentials.</span></span>

## <a name="new-features-in-windows-powershell-50"></a><span data-ttu-id="32a81-167">Windows PowerShell 5.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-167">New features in Windows PowerShell 5.0</span></span>

- [<span data-ttu-id="32a81-168">Windows PowerShell 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-168">New features in Windows PowerShell</span></span>](#new-features-in-windows-powershell)
- [<span data-ttu-id="32a81-169">Windows PowerShell Desired State Configuration 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-169">New features in Windows PowerShell Desired State Configuration</span></span>](#new-features-in-windows-powershell-desired-state-configuration)
- [<span data-ttu-id="32a81-170">Windows PowerShell ISE 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-170">New features in Windows PowerShell ISE</span></span>](#new-features-in-windows-powershell-ise)
- [<span data-ttu-id="32a81-171">Windows PowerShell Web 服务中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-171">New features in Windows PowerShell Web Services</span></span>](#new-features-in-windows-powershell-web-services-management-odata-iis-extension)
- [<span data-ttu-id="32a81-172">Windows PowerShell 5.0 中值得注意的 Bug 修复</span><span class="sxs-lookup"><span data-stu-id="32a81-172">Notable bug fixes in Windows PowerShell 5.0</span></span>](#notable-bug-fixes-in-windows-powershell-50)

### <a name="new-features-in-windows-powershell"></a><span data-ttu-id="32a81-173">Windows PowerShell 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-173">New features in Windows PowerShell</span></span>

- <span data-ttu-id="32a81-174">从 Windows PowerShell 5.0 开始，你可以通过使用类，通过使用正式语法和类似于其他面向对象的编程语言的语义进行开发。</span><span class="sxs-lookup"><span data-stu-id="32a81-174">Starting in Windows PowerShell 5.0, you can develop by using classes, by using formal syntax and semantics that are similar to other object-oriented programming languages.</span></span> <span data-ttu-id="32a81-175">**Class** 、 **Enum** 和其他关键字已添加到 Windows PowerShell 语言中以支持新增功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-175">**Class** , **Enum** , and other keywords have been added to the Windows PowerShell language to support the new feature.</span></span>
  <span data-ttu-id="32a81-176">有关使用类的详细信息，请参阅 about_Classes。</span><span class="sxs-lookup"><span data-stu-id="32a81-176">For more information about working with classes, see about_Classes.</span></span>

- <span data-ttu-id="32a81-177">Windows PowerShell 5.0 引入了一个新的结构化信息流，可用于在脚本和其调用方（或主机环境）之间传输结构化数据。</span><span class="sxs-lookup"><span data-stu-id="32a81-177">Windows PowerShell 5.0 introduces a new, structured information stream that you can use to transmit structured data between a script and its callers (or hosting environment).</span></span> <span data-ttu-id="32a81-178">现在可使用 Write-Host 将输出发出到信息流。</span><span class="sxs-lookup"><span data-stu-id="32a81-178">You can now use Write-Host to emit output to the information stream.</span></span> <span data-ttu-id="32a81-179">信息流也适用于 PowerShell.Streams、作业、计划作业和工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-179">Information streams also work for PowerShell.Streams, jobs, scheduled jobs, and workflows.</span></span> <span data-ttu-id="32a81-180">以下功能支持信息流。</span><span class="sxs-lookup"><span data-stu-id="32a81-180">The following features support the information stream.</span></span>
  - <span data-ttu-id="32a81-181">一个新的 Write-Information cmdlet，使你能够指定 Windows PowerShell 如何处理命令的信息流数据。</span><span class="sxs-lookup"><span data-stu-id="32a81-181">A new Write-Information cmdlet that lets you specify how Windows PowerShell handles information stream data for a command.</span></span> <span data-ttu-id="32a81-182">Write-Host 是 Write-Information 的包装器。</span><span class="sxs-lookup"><span data-stu-id="32a81-182">Write-Host is a wrapper for Write-Information.</span></span> <span data-ttu-id="32a81-183">Write-Information 也是受支持的工作流活动。</span><span class="sxs-lookup"><span data-stu-id="32a81-183">Write-Information is also a supported workflow activity.</span></span>
  - <span data-ttu-id="32a81-184">两个新的通用参数 InformationVariable 和 InformationAction，使你能够确定如何显示来自命令的信息流。</span><span class="sxs-lookup"><span data-stu-id="32a81-184">Two new common parameters, InformationVariable and InformationAction, let you determine how information streams from a command are displayed.</span></span> <span data-ttu-id="32a81-185">InformationAction 有效的值是 SilentlyContinue、Stop、Continue、Inquire、Ignore 或 Suspend，默认值是 SilentlyContinue。</span><span class="sxs-lookup"><span data-stu-id="32a81-185">Valid values for InformationAction are SilentlyContinue, Stop, Continue, Inquire, Ignore, or Suspend, with SilentlyContinue being the default.</span></span> <span data-ttu-id="32a81-186">InformationVariable 将字符串指定为你希望将来自命令的 Write-Host 数据保存到其中的变量的名称。</span><span class="sxs-lookup"><span data-stu-id="32a81-186">InformationVariable specifies a string as the name of a variable to which you want the Write-Host data from a command saved.</span></span>
  - <span data-ttu-id="32a81-187">一个新的首选项变量 InformationPreference，它指定在 Windows PowerShell 会话中信息流数据的默认首选项。</span><span class="sxs-lookup"><span data-stu-id="32a81-187">A new preference variable, InformationPreference, specifies your default preference for information stream data in a Windows PowerShell session.</span></span> <span data-ttu-id="32a81-188">默认值是 SilentlyContinue。</span><span class="sxs-lookup"><span data-stu-id="32a81-188">The default value is SilentlyContinue.</span></span>
  - <span data-ttu-id="32a81-189">已添加两个新的工作流通用参数 PSInformation 和 InformationAction。</span><span class="sxs-lookup"><span data-stu-id="32a81-189">Two new workflow common parameters, PSInformation and InformationAction, have been added.</span></span>
  - <span data-ttu-id="32a81-190">当你使用 Format-Table 命令时，表列现评估通过流传递的前 300ms 的数据来自动进行格式设置。</span><span class="sxs-lookup"><span data-stu-id="32a81-190">When you use the Format-Table command, table columns are now automatically formatted by evaluating the first 300ms of data that passes through the stream.</span></span>

- <span data-ttu-id="32a81-191">与 [Microsoft Research](https://research.microsoft.com/) 协作添加了一个新的 cmdlet，即 ConvertFrom-String。</span><span class="sxs-lookup"><span data-stu-id="32a81-191">In collaboration with [Microsoft Research](https://research.microsoft.com/), a new cmdlet, ConvertFrom-String, has been added.</span></span> <span data-ttu-id="32a81-192">ConvertFrom-String 使你能够从文本字符串的内容中提取和分析结构化对象。</span><span class="sxs-lookup"><span data-stu-id="32a81-192">ConvertFrom-String lets you extract and parse structured objects from the content of text strings.</span></span> <span data-ttu-id="32a81-193">有关详细信息，请参阅 ConvertFrom-String。</span><span class="sxs-lookup"><span data-stu-id="32a81-193">For more information, see ConvertFrom-String.</span></span>
- <span data-ttu-id="32a81-194">新的 Convert-String cmdlet 基于你在 -Example 参数中提供的示例自动设置文本的格式。</span><span class="sxs-lookup"><span data-stu-id="32a81-194">A new Convert-String cmdlet automatically formats text based on an example that you provide in an -Example parameter.</span></span>
- <span data-ttu-id="32a81-195">新的模块 Microsoft.PowerShell.Archive 包括了使你能够将文件和文件夹压缩到存档文件（也被称为 ZIP）、从现有 ZIP 文件中提取文件以及使用其中压缩的较新版本文件更新 ZIP 文件的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-195">A new module, Microsoft.PowerShell.Archive, includes cmdlets that let you compress files and folders into archive (also known as ZIP) files, extract files from existing ZIP files, and update ZIP files with newer versions of files compressed within them.</span></span>
- <span data-ttu-id="32a81-196">新的模块 PackageManagement 使你能够在 Internet 上发现并安装软件包。</span><span class="sxs-lookup"><span data-stu-id="32a81-196">A new module, PackageManagement, lets you discover and install software packages on the Internet.</span></span>
  <span data-ttu-id="32a81-197">PackageManagement（以前被称为 OneGet）模块是一个管理器或现有包管理器（也被称为包提供程序）的多路复用器，使用单个 Windows PowerShell 界面统一管理 Windows 包。</span><span class="sxs-lookup"><span data-stu-id="32a81-197">The PackageManagement (formerly known as OneGet) module is a manager or multiplexer of existing package managers (also called package providers) to unify Windows package management with a single Windows PowerShell interface.</span></span>
- <span data-ttu-id="32a81-198">新的模块 PowerShellGet 使你能够在 [PowerShell 库](https://www.powershellgallery.com/)上，或者在可以通过运行 Register-PSRepository cmdlet 来进行设置的内部模块存储库上查找、安装、发布和更新模块和 DSC 资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-198">A new module, PowerShellGet, lets you find, install, publish, and update modules and DSC resources on the [PowerShell Gallery](https://www.powershellgallery.com/), or on an internal module repository that you can set up by running the Register-PSRepository cmdlet.</span></span>
- <span data-ttu-id="32a81-199">已添加了一个新的语言关键字 **Hidden** ，用于指定默认情况下成员（属性或方法）不显示在 Get-Member 结果中（除非添加了 -Force 参数）。</span><span class="sxs-lookup"><span data-stu-id="32a81-199">A new language keyword, **Hidden** , has been added to specify that a member (a property or a method) is not shown by default in Get-Member results (unless you add the -Force parameter).</span></span>
  <span data-ttu-id="32a81-200">已标记为隐藏的属性或方法也不会出现在 IntelliSense 结果中，除非你位于成员应为可见的上下文中；例如，当在类方法中时自动变量 $This 应显示隐藏成员。</span><span class="sxs-lookup"><span data-stu-id="32a81-200">Properties or methods that have been marked hidden also do not show up in IntelliSense results, unless you are in a context where the member should be visible; for example, the automatic variable $This should show hidden members when in the class method.</span></span>
- <span data-ttu-id="32a81-201">已增强了 New-Item、Remove-Item、Get-ChildItem 的功能，用于支持创建和管理[符号链接](https://en.wikipedia.org/wiki/Symbolic_link)。</span><span class="sxs-lookup"><span data-stu-id="32a81-201">New-Item, Remove-Item, and Get-ChildItem have been enhanced to support creating and managing [symbolic links](https://en.wikipedia.org/wiki/Symbolic_link).</span></span> <span data-ttu-id="32a81-202">New-Item 的 **ItemType** 参数接受一个新的值 **SymbolicLink** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-202">The **-ItemType** parameter for New-Item accepts a new value, **SymbolicLink**.</span></span> <span data-ttu-id="32a81-203">现在可通过运行 New-Item cmdlet 在单行中创建符号链接。</span><span class="sxs-lookup"><span data-stu-id="32a81-203">Now you can create symbolic links in a single line by running the New-Item cmdlet.</span></span>
- <span data-ttu-id="32a81-204">Get-ChildItem 也有一个新的 -Depth 参数，可将该参数与 -Recurse 参数一起使用，以限制递归。</span><span class="sxs-lookup"><span data-stu-id="32a81-204">Get-ChildItem also has a new -Depth parameter, which you use with the -Recurse parameter to limit the recursion.</span></span> <span data-ttu-id="32a81-205">例如，Get-ChildItem -Recurse -Depth 2 从当前文件夹、当前文件夹中的所有子文件夹，以及子文件夹中的所有文件夹返回结果。</span><span class="sxs-lookup"><span data-stu-id="32a81-205">For example, Get-ChildItem -Recurse -Depth 2 returns results from the current folder, all of the child folders within the current folder, and all of the folders within the child folders.</span></span>
- <span data-ttu-id="32a81-206">现在，使用 Copy-Item，可以将文件或文件夹从一个 Windows PowerShell 会话复制到另一个会话中；也就是说，可以将文件复制到已连接到远程计算机（包括正在运行 Nano Server 的计算机，因此没有其他接口）的会话中。</span><span class="sxs-lookup"><span data-stu-id="32a81-206">Copy-Item now lets you copy files or folders from one Windows PowerShell session to another, meaning that you can copy files to sessions that are connected to remote computers, (including computers that are running Nano Server, and thus have no other interface).</span></span> <span data-ttu-id="32a81-207">若要复制文件，请将 PSSession ID 指定为新的 -FromSession 和 -ToSession 参数的值，并添加 -Path 和 -Destination 以分别指定源路径和目标位置。</span><span class="sxs-lookup"><span data-stu-id="32a81-207">To copy files, specify PSSession IDs as the value of the new -FromSession and -ToSession parameters, and add -Path and -Destination to specify origin path and destination, respectively.</span></span> <span data-ttu-id="32a81-208">例如，Copy-Item -Path c:\\myFile.txt -ToSession $s -Destination d:\\destinationFolder。</span><span class="sxs-lookup"><span data-stu-id="32a81-208">For example, Copy-Item -Path c:\\myFile.txt -ToSession $s -Destination d:\\destinationFolder.</span></span>
- <span data-ttu-id="32a81-209">除了控制台主机 ( **powershell.exe** ) 外，Windows PowerShell 转录已经得到改进以应用到所有主机应用程序（例如 Windows PowerShell ISE）。</span><span class="sxs-lookup"><span data-stu-id="32a81-209">Windows PowerShell transcription has been improved to apply to all hosting applications (such as Windows PowerShell ISE) in addition to the console host ( **powershell.exe** ).</span></span> <span data-ttu-id="32a81-210">脚本选项（包括启用 system-wide 脚本）可以通过启用“打开 PowerShell 脚本”  组策略设置（位于 Administrative Templates/Windows Components/Windows PowerShell）来进行配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-210">Transcription options (including enabling a system-wide transcript) can be configured by enabling the **Turn on PowerShell Transcription** Group Policy setting, found in Administrative Templates/Windows Components/Windows PowerShell.</span></span>
- <span data-ttu-id="32a81-211">新的“详细脚本跟踪”功能让你能够启用系统上使用的 Windows PowerShell 脚本的详细跟踪和分析。</span><span class="sxs-lookup"><span data-stu-id="32a81-211">A new detailed script tracing feature lets you enable detailed tracking and analysis of Windows PowerShell scripting use on a system.</span></span> <span data-ttu-id="32a81-212">在启用详细脚本跟踪后，Windows PowerShell 会将所有的脚本块记录到 **Microsoft-Windows-PowerShell/Operational** 的 Windows 事件跟踪 (ETW) 事件日志中。</span><span class="sxs-lookup"><span data-stu-id="32a81-212">After you enable detailed script tracing, Windows PowerShell logs all script blocks to the Event Tracing for Windows (ETW) event log, **Microsoft-Windows-PowerShell/Operational**.</span></span>
- <span data-ttu-id="32a81-213">从 Windows PowerShell 5.0 开始，新的加密消息语法 cmdlet 通过使用加密保护消息的 IETF 标准格式对内容的加密和解密提供支持，如 [RFC5652](https://tools.ietf.org/html/rfc5652) 中所述。</span><span class="sxs-lookup"><span data-stu-id="32a81-213">Starting in Windows PowerShell 5.0, new Cryptographic Message Syntax cmdlets support encryption and decryption of content by using the IETF standard format for cryptographically protecting messages as documented by [RFC5652](https://tools.ietf.org/html/rfc5652).</span></span> <span data-ttu-id="32a81-214">已将 Get-CmsMessage、Protect-CmsMessage 和 Unprotect-CmsMessage cmdlet 添加到 [Microsoft.PowerShell.Security](/powershell/module/Microsoft.PowerShell.Security) 模块中。</span><span class="sxs-lookup"><span data-stu-id="32a81-214">The Get-CmsMessage, Protect-CmsMessage, and Unprotect-CmsMessage cmdlets have been added to the [Microsoft.PowerShell.Security](/powershell/module/Microsoft.PowerShell.Security) module.</span></span>
- <span data-ttu-id="32a81-215">[Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) 中新的 cmdlet 包括 Get-Runspace、Debug-Runspace、Get-RunspaceDebug、Enable-RunspaceDebug 和 Disable-RunspaceDebug，使你能够在运行空间上设置调试选型，以及在运行空间上开始和停止调试。</span><span class="sxs-lookup"><span data-stu-id="32a81-215">New cmdlets in the [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) module, Get-Runspace, Debug-Runspace, Get-RunspaceDebug, Enable-RunspaceDebug, and Disable-RunspaceDebug, let you set debug options on a runspace, and start and stop debugging on a runspace.</span></span> <span data-ttu-id="32a81-216">针对调试任意运行空间（即不是 Windows PowerShell 控制台或 Windows PowerShell ISE 会话默认的运行空间），Windows PowerShell 使你能够在脚本中设置断点，并添加了断点以停止脚本运行，直到你可以附加调试器来调试运行空间脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-216">For debugging arbitrary runspaces (that is, runspaces that are not the default runspace for a Windows PowerShell console or Windows PowerShell ISE session) Windows PowerShell lets you set breakpoints in a script, and have added breakpoints stop the script from running until you can attach a debugger to debug the runspace script.</span></span> <span data-ttu-id="32a81-217">已将对任意运行空间的嵌套调试支持添加到了运行空间的 Windows PowerShell 脚本调试器中。</span><span class="sxs-lookup"><span data-stu-id="32a81-217">Nested debugging support for arbitrary runspaces has been added to the Windows PowerShell script debugger for runspaces.</span></span>
- <span data-ttu-id="32a81-218">已将一个新的 Format-Hex cmdlet 添加到了 [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) 模块中。</span><span class="sxs-lookup"><span data-stu-id="32a81-218">A new Format-Hex cmdlet has been added to the [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) module.</span></span>
  <span data-ttu-id="32a81-219">Format-Hex 使你可以以十六进制格式查看文本或二进制数据。</span><span class="sxs-lookup"><span data-stu-id="32a81-219">Format-Hex lets you view text or binary data in hexadecimal format.</span></span>
- <span data-ttu-id="32a81-220">已将 Get-Clipboard 和 Set-Clipboard cmdlet 添加到了 [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) 模块中；它们易于将内容传输到 Windows PowerShell 会话以及从其中传输内容。</span><span class="sxs-lookup"><span data-stu-id="32a81-220">Get-Clipboard and Set-Clipboard cmdlets have been added to the [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) module; they ease the transfer of content to and from a Windows PowerShell session.</span></span> <span data-ttu-id="32a81-221">剪贴板 cmdlet 支持图像、音频文件、文件列表和文本。</span><span class="sxs-lookup"><span data-stu-id="32a81-221">The Clipboard cmdlets support images, audio files, file lists, and text.</span></span>
- <span data-ttu-id="32a81-222">新的 Clear-RecycleBin cmdlet 已添加到 [Microsoft.PowerShell.Management](/powershell/module/Microsoft.PowerShell.Management) 模块中；此 cmdlet 清空固定驱动器（包括外部驱动器）的回收站。</span><span class="sxs-lookup"><span data-stu-id="32a81-222">A new cmdlet, Clear-RecycleBin, has been added to the [Microsoft.PowerShell.Management](/powershell/module/Microsoft.PowerShell.Management) module; this cmdlet empties the Recycle Bin for a fixed drive, which includes external drives.</span></span> <span data-ttu-id="32a81-223">默认情况下，你会收到确认 Clear-RecycleBin 命令的提示，因为该 cmdlet 的 ConfirmImpact 属性设置为 ConfirmImpact.High。</span><span class="sxs-lookup"><span data-stu-id="32a81-223">By default, you are prompted to confirm a Clear-RecycleBin command, because the ConfirmImpact property of the cmdlet is set to ConfirmImpact.High.</span></span>
- <span data-ttu-id="32a81-224">新的 New-TemporaryFile cmdlet 使你能够创建临时文件作为脚本的一部分。</span><span class="sxs-lookup"><span data-stu-id="32a81-224">A new cmdlet, New-TemporaryFile, lets you create a temporary file as part of scripting.</span></span> <span data-ttu-id="32a81-225">默认情况下，新的临时文件创建在 ```C:\Users\<user name>\AppData\Local\Temp``` 中。</span><span class="sxs-lookup"><span data-stu-id="32a81-225">By default, the new temporary file is created in ```C:\Users\<user name>\AppData\Local\Temp```.</span></span>
- <span data-ttu-id="32a81-226">Out-File、Add-Content 和 Set-Content cmdlet 现在有一个新的 -NoNewline 参数，使用该参数将在输出后省略新的行。</span><span class="sxs-lookup"><span data-stu-id="32a81-226">The Out-File, Add-Content, and Set-Content cmdlets now have a new -NoNewline parameter, which omits a new line after the output.</span></span>
- <span data-ttu-id="32a81-227">New-Guid cmdlet 利用 .NET Framework Guid 类以生成 GUID，这在当你正在编写脚本或 DSC 资源时很有用。</span><span class="sxs-lookup"><span data-stu-id="32a81-227">The New-Guid cmdlet leverages the .NET Framework Guid class to generate a GUID, useful when you are writing scripts or DSC resources.</span></span>
- <span data-ttu-id="32a81-228">由于文件版本信息可能会产生误导（尤其是在修补文件后），因此新的 FileVersionRaw 和 ProductVersionRaw 脚本属性可用于 FileInfo 对象。</span><span class="sxs-lookup"><span data-stu-id="32a81-228">Because file version information can be misleading, particularly after a file is patched, new FileVersionRaw and ProductVersionRaw script properties are available for FileInfo objects.</span></span> <span data-ttu-id="32a81-229">例如，可以运行下面的命令来显示 powershell.exe 的这些属性值，其中 $pid 包含正在运行的 Windows PowerShell 会话的进程 ID：`Get-Process -Id $pid -FileVersionInfo | Format-List *version* -Force`</span><span class="sxs-lookup"><span data-stu-id="32a81-229">For example, you can run the following command to display the values of these properties for powershell.exe, where $pid contains the process ID for a running session of Windows PowerShell: `Get-Process -Id $pid -FileVersionInfo | Format-List *version* -Force`</span></span>
- <span data-ttu-id="32a81-230">新的 Enter-PSHostProcess 和 Exit-PSHostProcess cmdlet 使你能够在独立于正在 Windows PowerShell 控制台中运行的当前进程的进程中调试 Windows PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-230">New cmdlets Enter-PSHostProcess and Exit-PSHostProcess let you debug Windows PowerShell scripts in processes separate from the current process that is running in the Windows PowerShell console.</span></span> <span data-ttu-id="32a81-231">运行 Enter-PSHostProcess 以输入或附上一个特定的进程 ID，然后运行 Get-Runspace 以返回进程内活动的运行空间。</span><span class="sxs-lookup"><span data-stu-id="32a81-231">Run Enter-PSHostProcess to enter, or attach to, a specific process ID, and then run Get-Runspace to return the active runspaces within the process.</span></span> <span data-ttu-id="32a81-232">当你完成进程内的脚本调试后，运行 Exit-PSHostProcess 从进程中分离出来。</span><span class="sxs-lookup"><span data-stu-id="32a81-232">Run Exit-PSHostProcess to detach from the process when you are finished debugging the script within the process.</span></span>
- <span data-ttu-id="32a81-233">已将一个新的 Wait-Debugger cmdlet 添加到了 [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) 模块中。</span><span class="sxs-lookup"><span data-stu-id="32a81-233">A new Wait-Debugger cmdlet has been added to the [Microsoft.PowerShell.Utility](/powershell/module/Microsoft.PowerShell.Utility) module.</span></span> <span data-ttu-id="32a81-234">在脚本中运行下一个语句时，可运行 Wait-Debugger 以停止调试器中的脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-234">You can run Wait-Debugger to stop a script in the debugger before running the next statement in the script.</span></span>
- <span data-ttu-id="32a81-235">Windows PowerShell 工作流调试器现在支持命令或 Tab 自动补全，并且你可以调试嵌套的工作流函数。</span><span class="sxs-lookup"><span data-stu-id="32a81-235">The Windows PowerShell Workflow debugger now supports command or tab completion, and you can debug nested workflow functions.</span></span> <span data-ttu-id="32a81-236">现在，可以按 **Ctrl+Break** 进入正在运行的脚本、本地和远程会话以及工作流脚本中的调试器。</span><span class="sxs-lookup"><span data-stu-id="32a81-236">You can now press **Ctrl+Break** to enter the debugger in a running script, in both local and remote sessions, and in a workflow script.</span></span>
- <span data-ttu-id="32a81-237">已将 Debug-Job cmdlet 添加到 [Microsoft.PowerShell.Core](/powershell/module/Microsoft.PowerShell.Core) 模块中，用于调试 Windows PowerShell 工作流、后台以及在远程会话中运行的作业的运行作业脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-237">A Debug-Job cmdlet has been added to the [Microsoft.PowerShell.Core](/powershell/module/Microsoft.PowerShell.Core) module to debug running job scripts for Windows PowerShell Workflow, background, and jobs running in remote sessions.</span></span>
- <span data-ttu-id="32a81-238">已为 Windows PowerShell 作业添加一个新状态 AtBreakpoint。</span><span class="sxs-lookup"><span data-stu-id="32a81-238">A new state, AtBreakpoint, has been added for Windows PowerShell jobs.</span></span> <span data-ttu-id="32a81-239">AtBreakpoint 状态在作业正在运行包含设置断点的脚本以及脚本命中断点时应用。</span><span class="sxs-lookup"><span data-stu-id="32a81-239">The AtBreakpoint state applies when a job is running a script that includes set breakpoints, and the script has hit a breakpoint.</span></span> <span data-ttu-id="32a81-240">当作业在调试断点处停止时，必须运行 Debug-Job cmdlet 来调试该作业。</span><span class="sxs-lookup"><span data-stu-id="32a81-240">When a job is stopped at a debug breakpoint, you must debug the job by running the Debug-Job cmdlet.</span></span>
- <span data-ttu-id="32a81-241">Windows PowerShell 5.0 实现了在 $PSModulePath 中的相同文件夹内对单个 Windows PowerShell 模块的多个版本的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-241">Windows PowerShell 5.0 implements support for multiple versions of a single Windows PowerShell module in the same folder in $PSModulePath.</span></span> <span data-ttu-id="32a81-242">已将 RequiredVersion 属性添加到了 ModuleSpecification 类中，用于帮助获取模块的所需版本；此属性与 ModuleVersion 属性相互排斥。</span><span class="sxs-lookup"><span data-stu-id="32a81-242">A RequiredVersion property has been added to the ModuleSpecification class to help you get the desired version of a module; this property is mutually exclusive with the ModuleVersion property.</span></span> <span data-ttu-id="32a81-243">RequiredVersion 现在作为 Get-Module、Import-Module 和 Remove-Module cmdlet 的 FullyQualifiedName 参数的值的一部分受到支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-243">RequiredVersion is now supported as part of the value of the FullyQualifiedName parameter of the Get-Module, Import-Module, and Remove-Module cmdlets.</span></span>
- <span data-ttu-id="32a81-244">你现在可以通过运行 Test-ModuleManifest cmdlet 执行模块版本验证。</span><span class="sxs-lookup"><span data-stu-id="32a81-244">You can now perform module version validation by running the Test-ModuleManifest cmdlet.</span></span>
- <span data-ttu-id="32a81-245">现在 Get-Command cmdlet 的结果显示版本列；一个新的版本属性已添加到 CommandInfo 类中。</span><span class="sxs-lookup"><span data-stu-id="32a81-245">Results of the Get-Command cmdlet now display a Version column; a new Version property has been added to the CommandInfo class.</span></span> <span data-ttu-id="32a81-246">Get-Command 从相同模块的多个版本中显示命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-246">Get-Command shows commands from multiple versions of the same module.</span></span> <span data-ttu-id="32a81-247">Version 属性也是 CmdletInfo 的派生类的一部分：CmdletInfo 和 ApplicationInfo。</span><span class="sxs-lookup"><span data-stu-id="32a81-247">The Version property is also part of derived classes of CmdletInfo: CmdletInfo and ApplicationInfo.</span></span>
- <span data-ttu-id="32a81-248">Get-Command 拥由一个新的参数 -ShowCommandInfo，它将 ShowCommand 信息作为 PSObjects 返回。</span><span class="sxs-lookup"><span data-stu-id="32a81-248">Get-Command has a new parameter, -ShowCommandInfo, that returns ShowCommand information as PSObjects.</span></span> <span data-ttu-id="32a81-249">当通过使用 Windows PowerShell 远程在 Windows PowerShell ISE 中运行 Show-Command 时，这是非常有用的功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-249">This is especially useful functionality for when Show-Command is run in Windows PowerShell ISE by using Windows PowerShell remoting.</span></span> <span data-ttu-id="32a81-250">-ShowCommandInfo 参数替换了 Microsoft.PowerShell.Utility 模块中现有的 Get-SerializedCommand 函数，但 Get-SerializedCommand 脚本仍可用于支持下层脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-250">The -ShowCommandInfo parameter replaces the existing Get-SerializedCommand function in the Microsoft.PowerShell.Utility module, but the Get-SerializedCommand script is still available to support downlevel scripting.</span></span>
- <span data-ttu-id="32a81-251">新的 Get-ItemPropertyValue cmdlet 使你能够获取属性的值，而无需使用点表示法。</span><span class="sxs-lookup"><span data-stu-id="32a81-251">A new Get-ItemPropertyValue cmdlet lets you get the value of a property without using dot notation.</span></span> <span data-ttu-id="32a81-252">例如，在 Windows PowerShell 的较旧版本中，可以运行以下命令来获取 PowerShellEngine 注册表项的 Application Base 属性的值：(Get-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\PowerShell\\3\\PowerShellEngine -Name ApplicationBase).ApplicationBase  。</span><span class="sxs-lookup"><span data-stu-id="32a81-252">For example, in older releases of Windows PowerShell, you can run the following command to get the value of the Application Base property of the PowerShellEngine registry key: **(Get-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\PowerShell\\3\\PowerShellEngine -Name ApplicationBase).ApplicationBase**.</span></span> <span data-ttu-id="32a81-253">从 PowerShell 5.0 开始，可运行 **Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Microsoft\\PowerShell\\3\\PowerShellEngine -Name ApplicationBase** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-253">Starting in Windows PowerShell 5.0, you can run **Get-ItemPropertyValue -Path HKLM:\\SOFTWARE\\Microsoft\\PowerShell\\3\\PowerShellEngine -Name ApplicationBase**.</span></span>
- <span data-ttu-id="32a81-254">Windows PowerShell 控制台现在使用语法着色，就像 Windows PowerShell ISE 中一样。</span><span class="sxs-lookup"><span data-stu-id="32a81-254">The Windows PowerShell console now uses syntax coloring, just as in Windows PowerShell ISE.</span></span>
- <span data-ttu-id="32a81-255">新的 NetworkSwitch 模块包括的 cmdlet 使你能够将交换机、虚拟 LAN (VLAN) 和基本第 2 层网络交换机端口配置应用到 Windows Server 2012 R2 徽章认证的网络交换机中。</span><span class="sxs-lookup"><span data-stu-id="32a81-255">A new NetworkSwitch module contains cmdlets that enable you to apply switch, virtual LAN (VLAN), and basic Layer 2 network switch port configuration to Windows Server 2012 R2 logo-certified network switches.</span></span>
- <span data-ttu-id="32a81-256">已将 FullyQualifiedName 参数添加到 Import-Module 和 Remove-Module cmdlet 中，用于支持存储单个模块的多个版本。</span><span class="sxs-lookup"><span data-stu-id="32a81-256">The FullyQualifiedName parameter has been added to Import-Module and Remove-Module cmdlets, to support storing multiple versions of a single module.</span></span>
- <span data-ttu-id="32a81-257">Save-Help、Update-Help、Import-PSSession、Export-PSSession 和 Get-Command 拥有一个新的参数，ModuleSpecification 类型的 FullyQualifiedModule。</span><span class="sxs-lookup"><span data-stu-id="32a81-257">Save-Help, Update-Help, Import-PSSession, Export-PSSession, and Get-Command have a new parameter, FullyQualifiedModule, of type ModuleSpecification.</span></span> <span data-ttu-id="32a81-258">添加此参数以按模块的完全限定名称来指定它。</span><span class="sxs-lookup"><span data-stu-id="32a81-258">Add this parameter to specify a module by its fully qualified name.</span></span>
- <span data-ttu-id="32a81-259">**$PSVersionTable.PSVersion** 的值已更新为 5.0。</span><span class="sxs-lookup"><span data-stu-id="32a81-259">The value of **$PSVersionTable.PSVersion** has been updated to 5.0.</span></span>
- <span data-ttu-id="32a81-260">WMF 5.0 (PowerShell 5.0) 包括 Pester  模块。</span><span class="sxs-lookup"><span data-stu-id="32a81-260">WMF 5.0 (PowerShell 5.0) includes the **Pester** module.</span></span> <span data-ttu-id="32a81-261">Pester 是 PowerShell 的单元测试框架。</span><span class="sxs-lookup"><span data-stu-id="32a81-261">Pester is a unit testing framework for PowerShell.</span></span> <span data-ttu-id="32a81-262">它提供了几个易于使用的关键字，可用于为脚本创建测试。</span><span class="sxs-lookup"><span data-stu-id="32a81-262">It provides a few simple-to-use keywords that let you create tests for your scripts.</span></span>

### <a name="new-features-in-windows-powershell-desired-state-configuration"></a><span data-ttu-id="32a81-263">Windows PowerShell Desired State Configuration 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-263">New features in Windows PowerShell Desired State Configuration</span></span>

- <span data-ttu-id="32a81-264">Windows PowerShell 语言增强功能使你能够通过使用类来定义 Windows PowerShell Desired State Configuration (DSC) 资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-264">Windows PowerShell language enhancements let you define Windows PowerShell Desired State Configuration (DSC) resources by using classes.</span></span> <span data-ttu-id="32a81-265">Import-DscResource 现在是一个真正的动态关键字；Windows PowerShell 分析指定模块的根模块，搜索包含 DscResource 特性的类。</span><span class="sxs-lookup"><span data-stu-id="32a81-265">Import-DscResource is now a true dynamic keyword; Windows PowerShell parses the specified module's root module, searching for classes that contain the DscResource attribute.</span></span> <span data-ttu-id="32a81-266">现在可使用类来定义 DSC 资源，其中既不需要模块文件夹中的 MOF 文件，也不需要模块文件夹中的 DSCResource 子文件夹。</span><span class="sxs-lookup"><span data-stu-id="32a81-266">You can now use classes to define DSC resources, in which neither a MOF file nor a DSCResource subfolder in the module folder is required.</span></span> <span data-ttu-id="32a81-267">Windows PowerShell 模块文件可以包含多个 DSC 资源类。</span><span class="sxs-lookup"><span data-stu-id="32a81-267">A Windows PowerShell module file can contain multiple DSC resource classes.</span></span>
- <span data-ttu-id="32a81-268">新的 ThrottleLimit 参数已添加到 PSDesiredStateConfiguration 模块中的以下 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-268">A new parameter, ThrottleLimit, has been added to the following cmdlets in the PSDesiredStateConfiguration module.</span></span> <span data-ttu-id="32a81-269">添加 ThrottleLimit 参数以指定你希望命令同时在上面进行工作的目标计算机或设备的数量。</span><span class="sxs-lookup"><span data-stu-id="32a81-269">Add the ThrottleLimit parameter to specify the number of target computers or devices on which you want the command to work at the same time.</span></span>
  - <span data-ttu-id="32a81-270">Get-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-270">Get-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-271">Get-DscConfigurationStatus</span><span class="sxs-lookup"><span data-stu-id="32a81-271">Get-DscConfigurationStatus</span></span>
  - <span data-ttu-id="32a81-272">Get-DscLocalConfigurationManager</span><span class="sxs-lookup"><span data-stu-id="32a81-272">Get-DscLocalConfigurationManager</span></span>
  - <span data-ttu-id="32a81-273">Restore-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-273">Restore-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-274">Test-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-274">Test-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-275">Compare-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-275">Compare-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-276">Publish-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-276">Publish-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-277">Set-DscLocalConfigurationManager</span><span class="sxs-lookup"><span data-stu-id="32a81-277">Set-DscLocalConfigurationManager</span></span>
  - <span data-ttu-id="32a81-278">Start-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-278">Start-DscConfiguration</span></span>
  - <span data-ttu-id="32a81-279">Update-DscConfiguration</span><span class="sxs-lookup"><span data-stu-id="32a81-279">Update-DscConfiguration</span></span>
- <span data-ttu-id="32a81-280">通过集中式的 DSC 错误报告，丰富的错误信息不仅可以记录在事件日志中，同样也可以发送到一个中心位置以供日后分析使用。</span><span class="sxs-lookup"><span data-stu-id="32a81-280">With centralized DSC error reporting, rich error information is not only logged in the event log, but it can be sent to a central location for later analysis.</span></span> <span data-ttu-id="32a81-281">可以使用此中心位置来存储在其环境中针对任何服务器而发生的 DSC 配置错误。</span><span class="sxs-lookup"><span data-stu-id="32a81-281">You can use this central location to store DSC configuration errors that have occurred for any server in their environment.</span></span> <span data-ttu-id="32a81-282">在元配置中定义报表服务器后，所有的错误会发送到报表服务器，然后存储在数据库中。</span><span class="sxs-lookup"><span data-stu-id="32a81-282">After the report server is defined in the meta-configuration, all errors are sent to the report server, and then stored in a database.</span></span> <span data-ttu-id="32a81-283">无论是否已配置目标节点以从请求服务器中请求配置，你都可以设置此功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-283">You can set up this functionality regardless of whether or not a target node is configured to pull configurations from a pull server.</span></span>
- <span data-ttu-id="32a81-284">针对 Windows PowerShell ISE 的改进使创作 DSC 资源变得轻松。</span><span class="sxs-lookup"><span data-stu-id="32a81-284">Improvements to Windows PowerShell ISE ease DSC resource authoring.</span></span> <span data-ttu-id="32a81-285">现在可以执行以下操作。</span><span class="sxs-lookup"><span data-stu-id="32a81-285">You can now do the following.</span></span>
  - <span data-ttu-id="32a81-286">通过在块内的空行上输入 **Ctrl+Space** ，列出 **配置** 或 **节点** 块内的所有 DSC 资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-286">List all DSC resources within a **configuration** or **node** block by entering **Ctrl+Space** on a blank line within the block.</span></span>
  - <span data-ttu-id="32a81-287">**枚举** 类型的资源属性的自动完成。</span><span class="sxs-lookup"><span data-stu-id="32a81-287">Automatic completion on resource properties of the **enumeration** type.</span></span>
  - <span data-ttu-id="32a81-288">DSC 资源的 **DependsOn** 属性的自动完成基于配置中的其他资源实例。</span><span class="sxs-lookup"><span data-stu-id="32a81-288">Automatic completion on the **DependsOn** property of DSC resources, based on other resource instances in the configuration.</span></span>
  - <span data-ttu-id="32a81-289">改进的资源属性值的 Tab 自动补全。</span><span class="sxs-lookup"><span data-stu-id="32a81-289">Improved tab completion of resource property values.</span></span>
- <span data-ttu-id="32a81-290">用户现在可以通过将 **PSDscRunAsCredential** 特性添加到节点块来运行一组指定凭据下的某个资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-290">A user can now run a resource under a specified set of credentials by adding the **PSDscRunAsCredential** attribute to a Node block.</span></span> <span data-ttu-id="32a81-291">例如，PSDscRunAsCredential = Get-Credential Contoso\\DscUser。</span><span class="sxs-lookup"><span data-stu-id="32a81-291">For example, PSDscRunAsCredential = Get-Credential Contoso\\DscUser.</span></span> <span data-ttu-id="32a81-292">此功能可用于创建配置来运行 Windows Installer 和可执行的安装程序、访问基于用户的注册表配置单元或执行当前用户上下文以外的其他任务。</span><span class="sxs-lookup"><span data-stu-id="32a81-292">This functionality is useful for creating configurations that run Windows Installer and executable installers, access the per-user registry hive, or perform other tasks outside the current user context.</span></span>
- <span data-ttu-id="32a81-293">已为 **Configuration** 关键字添加 32 位（基于 x86）的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-293">32-bit (x86-based) support has been added for the **Configuration** keyword.</span></span>
- <span data-ttu-id="32a81-294">Windows PowerShell 现在包括对 DSC 配置的自定义帮助的支持，该帮助是由通过将 \[CmdletBinding()] 添加到生成的配置函数来定义的。</span><span class="sxs-lookup"><span data-stu-id="32a81-294">Windows PowerShell now includes support for custom help for DSC configurations, defined by adding \[CmdletBinding()] to the generated configuration function.</span></span>
- <span data-ttu-id="32a81-295">新的 **DscLocalConfigurationManager** 特性将配置块设指定为元配置，用于配置 DSC 本地配置管理器。</span><span class="sxs-lookup"><span data-stu-id="32a81-295">A new **DscLocalConfigurationManager** attribute designates a configuration block as a meta-configuration, which is used to configure the DSC Local Configuration Manager.</span></span> <span data-ttu-id="32a81-296">此特性将配置限制为仅包含配置 DSC 本地配置管理器的项。</span><span class="sxs-lookup"><span data-stu-id="32a81-296">This attribute restricts a configuration to containing only items which configure the DSC Local Configuration Manager.</span></span> <span data-ttu-id="32a81-297">在处理期间，此配置生成 \*.meta.mof 文件，然后通过运行 Set-DscLocalConfigurationManager cmdlet 将其发送到相应的目标节点。</span><span class="sxs-lookup"><span data-stu-id="32a81-297">During processing, this configuration generates a \*.meta.mof file that is then sent to the appropriate target nodes by running the Set-DscLocalConfigurationManager cmdlet.</span></span>
- <span data-ttu-id="32a81-298">Windows PowerShell 5.0 中现允许部分配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-298">Partial configurations are now allowed in Windows PowerShell 5.0.</span></span> <span data-ttu-id="32a81-299">可以将配置文档以片段的形式传递到节点。</span><span class="sxs-lookup"><span data-stu-id="32a81-299">You can deliver configuration documents to a node in fragments.</span></span> <span data-ttu-id="32a81-300">对于要接收配置文档的多个片段的节点，必须将其本地配置管理器首先设置为指定预期片段</span><span class="sxs-lookup"><span data-stu-id="32a81-300">For a node to receive multiple fragments of a configuration document, the node's Local Configuration Manager must be first set to specify the expected fragments</span></span>
- <span data-ttu-id="32a81-301">跨计算机同步是 Windows PowerShell 5.0 中 DSC 中的新增功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-301">Cross-computer synchronization is new in DSC in Windows PowerShell 5.0.</span></span> <span data-ttu-id="32a81-302">通过使用内置 WaitFor\* 资源（ **WaitForAll** 、 **WaitForAny** 和 **WaitForSome** ），你现可在配置运行期间指定跨计算机的依赖关系，而无需外部业务流程。</span><span class="sxs-lookup"><span data-stu-id="32a81-302">By using the built-in WaitFor\* resources ( **WaitForAll** , **WaitForAny** , and **WaitForSome** ), you can now specify dependencies across computers during configuration runs, without external orchestrations.</span></span> <span data-ttu-id="32a81-303">以下资源通过 WS-Man 协议使用 CIM 连接进行节点到节点同步。</span><span class="sxs-lookup"><span data-stu-id="32a81-303">These resources provide node-to-node synchronization by using CIM connections over the WS-Man protocol.</span></span>
  <span data-ttu-id="32a81-304">配置可以等待另一台计算机特定的资源状态更改。</span><span class="sxs-lookup"><span data-stu-id="32a81-304">A configuration can wait for another computer's specific resource state to change.</span></span>
- <span data-ttu-id="32a81-305">Just Enough Administration (JEA) 是一个新的委派安全性功能，它利用 DSC 和 Windows PowerShell 受限运行空间以帮助保护企业免于数据丢失或员工（有意或无意）造成的泄露。</span><span class="sxs-lookup"><span data-stu-id="32a81-305">Just Enough Administration (JEA), a new delegation security feature, leverages DSC and Windows PowerShell constrained runspaces to help secure enterprises from data loss or compromise by employees, whether intentional or unintentional.</span></span> <span data-ttu-id="32a81-306">若要详细了解 JEA（包括从哪里可下载 xJEA DSC 资源），请参阅 [Just Enough Administration](/powershell/scripting/learn/remoting/jea/overview)。</span><span class="sxs-lookup"><span data-stu-id="32a81-306">For more information about JEA, including where you can download the xJEA DSC resource, see [Just Enough Administration](/powershell/scripting/learn/remoting/jea/overview).</span></span>
- <span data-ttu-id="32a81-307">以下新的 cmdlet 已添加到 PSDesiredStateConfiguration 模块中。</span><span class="sxs-lookup"><span data-stu-id="32a81-307">The following new cmdlets have been added to the PSDesiredStateConfiguration module.</span></span>
  - <span data-ttu-id="32a81-308">新的 Get-DscConfigurationStatus cmdlet 从目标节点中获取有关配置状态的高级信息。</span><span class="sxs-lookup"><span data-stu-id="32a81-308">A new Get-DscConfigurationStatus cmdlet gets high-level information about configuration status from a target node.</span></span> <span data-ttu-id="32a81-309">你可以获取最近的状态或所有配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-309">You can obtain the status of the last, or of all configurations.</span></span>
  - <span data-ttu-id="32a81-310">新的 Compare-DscConfiguration cmdlet 将指定的配置与一个或多个目标节点的实际状态进行比较。</span><span class="sxs-lookup"><span data-stu-id="32a81-310">A new Compare-DscConfiguration cmdlet compares a specified configuration with the actual state of one or more target nodes.</span></span>
  - <span data-ttu-id="32a81-311">新的 Publish-DscConfiguration cmdlet 将配置 MOF 文件复制到目标节点，但不应用该配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-311">A new Publish-DscConfiguration cmdlet copies a configuration MOF file to a target node, but does not apply the configuration.</span></span> <span data-ttu-id="32a81-312">将在下次一致性通过时或运行 Update-DscConfiguration cmdlet 时应用此配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-312">The configuration is applied during the next consistency pass, or when you run the Update-DscConfiguration cmdlet.</span></span>
  - <span data-ttu-id="32a81-313">新的 Test-DscConfiguration cmdlet 使你能够验证生成的配置是否与所需的配置相匹配，如果该配置与所需配置相匹配，则返回 True，或如果实际配置与所需配置不匹配，则返回 False。</span><span class="sxs-lookup"><span data-stu-id="32a81-313">A new Test-DscConfiguration cmdlet lets you verify that a resulting configuration matches the desired configuration, returning either True if the configuration matches the desired configuration, or False if the actual configuration does not match the desired configuration.</span></span>
  - <span data-ttu-id="32a81-314">新的 Update-DscConfiguration cmdlet 强制处理配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-314">A new Update-DscConfiguration cmdlet forces a configuration to be processed.</span></span> <span data-ttu-id="32a81-315">如果本地配置管理器处于请求模式下，该 cmdlet 将先从请求服务器中获取配置，然后再应用它。</span><span class="sxs-lookup"><span data-stu-id="32a81-315">If the Local Configuration Manager is in pull mode, the cmdlet gets the configuration from the pull server before applying it.</span></span>

### <a name="new-features-in-windows-powershell-ise"></a><span data-ttu-id="32a81-316">Windows PowerShell ISE 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-316">New features in Windows PowerShell ISE</span></span>

- <span data-ttu-id="32a81-317">现在可以通过运行 Enter-PSSession 在存储你希望编辑的文件的计算机上启动远程会话，然后运行 PSEdit \<path and file name on the remote computer\> 以在 Windows PowerShell ISE 的本地副本中编辑远程 Windows PowerShell 脚本和文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-317">You can now edit remote Windows PowerShell scripts and files in a local copy of Windows PowerShell ISE, by running Enter-PSSession to start a remote session on the computer that's storing the files you want to edit, and then running **PSEdit \<path and file name on the remote computer\>**.</span></span> <span data-ttu-id="32a81-318">此功能实现轻松编辑存储在 Windows Server 的服务器核心安装选项（Windows PowerShell ISE 无法在其中运行）上的 Windows PowerShell 文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-318">This feature eases editing Windows PowerShell files that are stored on the Server Core installation option of Windows Server, where Windows PowerShell ISE cannot run.</span></span>
- <span data-ttu-id="32a81-319">Windows PowerShell ISE 中现在支持 Start-Transcript cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-319">The Start-Transcript cmdlet is now supported in Windows PowerShell ISE.</span></span>
- <span data-ttu-id="32a81-320">现在可以在 Windows PowerShell ISE 中调试远程脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-320">You can now debug remote scripts in Windows PowerShell ISE.</span></span>
- <span data-ttu-id="32a81-321">新的菜单命令 **Break All** (Ctrl+B) 会强行进入本地和远程运行的脚本的调试器中。</span><span class="sxs-lookup"><span data-stu-id="32a81-321">A new menu command, **Break All** (Ctrl+B), breaks into the debugger for both local and remotely-running scripts.</span></span>

### <a name="new-features-in-windows-powershell-web-services-management-odata-iis-extension"></a><span data-ttu-id="32a81-322">Windows PowerShell Web 服务（Management OData IIS 扩展）中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-322">New features in Windows PowerShell Web Services (Management OData IIS Extension)</span></span>

- <span data-ttu-id="32a81-323">从 Windows PowerShell 5.0 开始，你可以通过运行 Export-ODataEndpointProxy cmdlet（位于新的 [Microsoft.PowerShell.OdataUtils](/powershell/module/microsoft.powershell.odatautils) 模块中），基于由给定 OData 终结点暴露的功能来生成一组 Windows PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-323">Starting in Windows PowerShell 5.0, you can generate a set of Windows PowerShell cmdlets based on the functionality exposed by a given OData endpoint, by running the Export-ODataEndpointProxy cmdlet, found in the new [Microsoft.PowerShell.OdataUtils](/powershell/module/microsoft.powershell.odatautils) module.</span></span>

### <a name="notable-bug-fixes-in-windows-powershell-50"></a><span data-ttu-id="32a81-324">Windows PowerShell 5.0 中值得注意的 Bug 修复</span><span class="sxs-lookup"><span data-stu-id="32a81-324">Notable bug fixes in Windows PowerShell 5.0</span></span>

- <span data-ttu-id="32a81-325">Windows PowerShell 5.0 包含新的 COM 实现，在你使用 COM 对象时它可以提供显著的性能改进。</span><span class="sxs-lookup"><span data-stu-id="32a81-325">Windows PowerShell 5.0 includes a new COM implementation, which offers significant performance improvements when you are working with COM objects.</span></span> <span data-ttu-id="32a81-326">有关效果的视频演示，请参阅 [Com_Perf_Improvements](https://1drv.ms/1qu3UPZ)。</span><span class="sxs-lookup"><span data-stu-id="32a81-326">For a video demonstration of the effect, see [Com_Perf_Improvements](https://1drv.ms/1qu3UPZ).</span></span>
- <span data-ttu-id="32a81-327">对 Windows PowerShell 会话中的第一个 Tab 自动补全进行了显著的性能改进，由此将 Tab 自动补全时间缩短了近 500ms。</span><span class="sxs-lookup"><span data-stu-id="32a81-327">Significant performance improvements have been made to the first tab completion in a Windows PowerShell session, shortening tab completion time by nearly 500 ms.</span></span>

## <a name="new-features-in-windows-powershell-40"></a><span data-ttu-id="32a81-328">Windows PowerShell 4.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-328">New features in Windows PowerShell 4.0</span></span>

<span data-ttu-id="32a81-329">Windows PowerShell 4.0 可向后兼容。</span><span class="sxs-lookup"><span data-stu-id="32a81-329">Windows PowerShell 4.0 is backward-compatible.</span></span> <span data-ttu-id="32a81-330">为 Windows PowerShell 3.0 和 Windows PowerShell 2.0 设计的 Cmdlet、提供程序、模块、管理单元、脚本、函数和配置文件通常适用于 Windows PowerShell 4.0，无需更改。</span><span class="sxs-lookup"><span data-stu-id="32a81-330">Cmdlets, providers, modules, snap-ins, scripts, functions, and profiles that were designed for Windows PowerShell 3.0 and Windows PowerShell 2.0 work in Windows PowerShell 4.0 without changes.</span></span>

<span data-ttu-id="32a81-331">Windows PowerShell 4.0 默认安装在 Windows 8.1 和 Windows Server 2012 R2 上。</span><span class="sxs-lookup"><span data-stu-id="32a81-331">Windows PowerShell 4.0 is installed by default on Windows 8.1 and Windows Server 2012 R2.</span></span> <span data-ttu-id="32a81-332">若要在 Windows 7 SP1 或 Windows Server 2008 R2 上安装 Windows PowerShell 4.0，请下载并安装 [Windows Management Framework 4.0](https://www.microsoft.com/download/details.aspx?id=40855)。</span><span class="sxs-lookup"><span data-stu-id="32a81-332">To install Windows PowerShell 4.0 on Windows 7 with SP1, or Windows Server 2008 R2, download and install [Windows Management Framework 4.0](https://www.microsoft.com/download/details.aspx?id=40855).</span></span> <span data-ttu-id="32a81-333">请务必先阅读下载详细信息并确保满足所有系统要求，然后再安装 Windows Management Framework 4.0。</span><span class="sxs-lookup"><span data-stu-id="32a81-333">Be sure to read the download details, and meet all system requirements, before you install Windows Management Framework 4.0.</span></span>

- [<span data-ttu-id="32a81-334">Windows PowerShell 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-334">New features in Windows PowerShell</span></span>](#new-features-in-windows-powershell-1)
- [<span data-ttu-id="32a81-335">Windows PowerShell 集成脚本环境 (ISE) 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-335">New features in Windows PowerShell Integrated Scripting Environment (ISE)</span></span>](#new-features-in-windows-powershell-integrated-scripting-environment-ise)
- [<span data-ttu-id="32a81-336">Windows PowerShell 工作流中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-336">New features in Windows PowerShell Workflow</span></span>](#new-features-in-windows-powershell-workflow)
- [<span data-ttu-id="32a81-337">Windows PowerShell Web 服务中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-337">New features in Windows PowerShell Web Services</span></span>](#new-features-in-windows-powershell-web-services)
- [<span data-ttu-id="32a81-338">Windows PowerShell Web 访问中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-338">New features in Windows PowerShell Web Access</span></span>](#new-features-in-windows-powershell-web-access)
- [<span data-ttu-id="32a81-339">Windows PowerShell 4.0 中值得注意的 Bug 修复</span><span class="sxs-lookup"><span data-stu-id="32a81-339">Notable bug fixes in Windows PowerShell 4.0</span></span>](#notable-bug-fixes-in-windows-powershell-40)

<span data-ttu-id="32a81-340">Windows PowerShell 4.0 包括以下新增功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-340">Windows PowerShell 4.0 includes the following new features.</span></span>

### <a name="new-features-in-windows-powershell"></a><span data-ttu-id="32a81-341"><a name="new-features-in-windows-powershell-1" />Windows PowerShell 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-341"><a name="new-features-in-windows-powershell-1" />New features in Windows PowerShell</span></span>

- <span data-ttu-id="32a81-342">**Windows PowerShell Desired State Configuration** (DSC) 是 Windows PowerShell 4.0 中的新管理系统，可为软件服务和运行这些服务的环境部署和管理配置数据。</span><span class="sxs-lookup"><span data-stu-id="32a81-342">**Windows PowerShell Desired State Configuration** (DSC) is a new management system in Windows PowerShell 4.0 that enables the deployment and management of configuration data for software services and the environment in which these services run.</span></span> <span data-ttu-id="32a81-343">有关 DSC 的详细信息，请参阅 [Windows PowerShell Desired State Configuration 入门](/powershell/scripting/dsc/getting-started/wingettingstarted)。</span><span class="sxs-lookup"><span data-stu-id="32a81-343">For more information about DSC, see [Get Started with Windows PowerShell Desired State Configuration](/powershell/scripting/dsc/getting-started/wingettingstarted).</span></span>
- <span data-ttu-id="32a81-344">**Save-Help** 使你能够为安装在远程计算机上的模块保存帮助。</span><span class="sxs-lookup"><span data-stu-id="32a81-344">**Save-Help** now lets you save help for modules that are installed on remote computers.</span></span> <span data-ttu-id="32a81-345">可以使用 Save-Help 从连接了 Internet 的客户端（不必在其上安装需要帮助的所有模块）下载模块“帮助”，然后将已保存的“帮助”复制到远程共享文件夹或无法访问 Internet 的远程计算机。</span><span class="sxs-lookup"><span data-stu-id="32a81-345">You can use Save-Help to download module Help from an Internet-connected client (on which not all of the modules for which you want help are necessarily installed), and then copy the saved Help to a remote shared folder or a remote computer that does not have Internet access.</span></span>
- <span data-ttu-id="32a81-346">Windows PowerShell 调试器已经过增强，从而允许对 Windows PowerShell 工作流以及在远程计算机上运行的脚本进行调试。</span><span class="sxs-lookup"><span data-stu-id="32a81-346">The Windows PowerShell debugger has been enhanced to allow debugging of Windows PowerShell workflows, as well as scripts that are running on remote computers.</span></span> <span data-ttu-id="32a81-347">现在，Windows PowerShell 工作流都可以从 Windows PowerShell 命令行或 Windows PowerShell ISE 在脚本级别进行调试。</span><span class="sxs-lookup"><span data-stu-id="32a81-347">Windows PowerShell workflows can now be debugged at the script level from either the Windows PowerShell command line or Windows PowerShell ISE.</span></span> <span data-ttu-id="32a81-348">现在，可通过远程会话来调试 Windows PowerShell 脚本，包括脚本工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-348">Windows PowerShell scripts, including script workflows, can now be debugged over remote sessions.</span></span> <span data-ttu-id="32a81-349">远程调试会话是通过先断开连接再重新连接的 Windows PowerShell 远程会话保留的。</span><span class="sxs-lookup"><span data-stu-id="32a81-349">Remote debugging sessions are preserved over Windows PowerShell remote sessions that are disconnected and then later reconnected.</span></span>
- <span data-ttu-id="32a81-350">**Register-ScheduledJob** 和 **Set-ScheduledJob** 的 **RunNow** 参数无需使用 **Trigger** 参数为作业设置即时启动日期和时间。</span><span class="sxs-lookup"><span data-stu-id="32a81-350">A **RunNow** parameter for **Register-ScheduledJob** and **Set-ScheduledJob** eliminates the need to set an immediate start date and time for jobs by using the **Trigger** parameter.</span></span>
- <span data-ttu-id="32a81-351">**Invoke-RestMethod** 和 **Invoke-WebRequest** 现在使你能够使用 Headers 参数来设置所有标头。</span><span class="sxs-lookup"><span data-stu-id="32a81-351">**Invoke-RestMethod** and **Invoke-WebRequest** now let you set all headers by using the Headers parameter.</span></span> <span data-ttu-id="32a81-352">虽然此参数一直存在，但它也是会导致异常或错误的 Web cmdlet 的几个参数之一。</span><span class="sxs-lookup"><span data-stu-id="32a81-352">Although this parameter has always existed, it was one of several parameters for the web cmdlets that resulted in exceptions or errors.</span></span>
- <span data-ttu-id="32a81-353">**Get-Module** 具有一个新参数 **FullyQualifiedName** ，其类型为 **ModuleSpecification\[]** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-353">**Get-Module** has a new parameter, **FullyQualifiedName** , of the type **ModuleSpecification\[]**.</span></span> <span data-ttu-id="32a81-354">Get-Module 的参数 **FullyQualifiedName** 现在使你能够通过使用模块的名称、版本和 GUID（可选）来指定该模块。</span><span class="sxs-lookup"><span data-stu-id="32a81-354">The **FullyQualifiedName** parameter of Get-Module now lets you specify a module by using the module's name, version, and optionally, its GUID.</span></span>
- <span data-ttu-id="32a81-355">Windows Server 2012 R2 上的默认执行策略设置为 **RemoteSigned** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-355">The default execution policy setting on Windows Server 2012 R2 is **RemoteSigned**.</span></span> <span data-ttu-id="32a81-356">在 Windows 8.1 上，默认设置保持不变。</span><span class="sxs-lookup"><span data-stu-id="32a81-356">On Windows 8.1, there is no change in default setting.</span></span>
- <span data-ttu-id="32a81-357">从 Windows PowerShell 4.0 开始，支持通过使用动态方法名称来调用方法。</span><span class="sxs-lookup"><span data-stu-id="32a81-357">Starting in Windows PowerShell 4.0, method invocation by using dynamic method names is supported.</span></span>
  <span data-ttu-id="32a81-358">你可以使用变量来存储方法名称，然后通过调用该变量动态调用该方法。</span><span class="sxs-lookup"><span data-stu-id="32a81-358">You can use a variable to store a method name, and then dynamically invoke the method by calling the variable.</span></span>
- <span data-ttu-id="32a81-359">超过由 **PSElapsedTimeoutSec** 工作流通用参数指定的超时期限时，不再删除异步工作流作业。</span><span class="sxs-lookup"><span data-stu-id="32a81-359">Asynchronous workflow jobs are no longer deleted when the time-out period that is specified by the **PSElapsedTimeoutSec** workflow common parameter has elapsed.</span></span>
- <span data-ttu-id="32a81-360">已向 **New-JobTrigger** 和 **Set-JobTrigger** cmdlet 添加新参数： **RepeatIndefinitely** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-360">A new parameter, **RepeatIndefinitely** , has been added to the **New-JobTrigger** and **Set-JobTrigger** cmdlets.</span></span> <span data-ttu-id="32a81-361">可在不指定 **RepetitionDuration** 参数的 **TimeSpan.MaxValue** 值的情况下无限期重复运行计划作业。</span><span class="sxs-lookup"><span data-stu-id="32a81-361">This eliminates the necessity of specifying a **TimeSpan.MaxValue** value for the **RepetitionDuration** parameter to run a scheduled job repeatedly for an indefinite period.</span></span>
- <span data-ttu-id="32a81-362">已向 **Enable-JobTrigger** 和 **Disable-JobTrigger** cmdlet 添加新参数： **Passthru** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-362">A **Passthru** parameter has been added to the **Enable-JobTrigger** and **Disable-JobTrigger** cmdlets.</span></span> <span data-ttu-id="32a81-363">Passthru 参数显示通过你的命令创建或修改的所有对象。</span><span class="sxs-lookup"><span data-stu-id="32a81-363">The Passthru parameter displays any objects that are created or modified by your command.</span></span>
- <span data-ttu-id="32a81-364">**Add-Computer** 和 **Remove-Computer** cmdlet 中用于指定工作组的参数名称现在是一致的。</span><span class="sxs-lookup"><span data-stu-id="32a81-364">The parameter names for specifying a workgroup in the **Add-Computer** and **Remove-Computer** cmdlets are now consistent.</span></span> <span data-ttu-id="32a81-365">这两个 cmdlet 现在都使用 **WorkgroupName** 参数。</span><span class="sxs-lookup"><span data-stu-id="32a81-365">Both cmdlets now use the parameter **WorkgroupName**.</span></span>
- <span data-ttu-id="32a81-366">已添加新的通用参数： **PipelineVariable** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-366">A new common parameter, **PipelineVariable** , has been added.</span></span> <span data-ttu-id="32a81-367">PipelineVariable 使你能够将某个通过管道传送的命令的结果（或该命令的一部分）另存为可通过管道的其余部分传递的一个变量。</span><span class="sxs-lookup"><span data-stu-id="32a81-367">PipelineVariable lets you save the results of a piped command (or part of a piped command) as a variable that can be passed through the remainder of the pipeline.</span></span>
- <span data-ttu-id="32a81-368">现在支持使用方法语法筛选集合。</span><span class="sxs-lookup"><span data-stu-id="32a81-368">Collection filtering by using a method syntax is now supported.</span></span> <span data-ttu-id="32a81-369">这意味着，现在可以通过使用简化的语法（类似于 Where() 或 Where-Object 的语法）采用方法调用的格式来筛选对象集合。</span><span class="sxs-lookup"><span data-stu-id="32a81-369">This means that you can now filter a collection of objects by using simplified syntax, similar to that for Where() or Where-Object, formatted as a method call.</span></span> <span data-ttu-id="32a81-370">以下是一个示例：(Get-Process).where({$_.Name -match 'powershell'})</span><span class="sxs-lookup"><span data-stu-id="32a81-370">The following is an example: (Get-Process).where({$_.Name -match 'powershell'})</span></span>
- <span data-ttu-id="32a81-371">**Get-Process** cmdlet 具有一个新的开关参数： **IncludeUserName** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-371">The **Get-Process** cmdlet has a new switch parameter, **IncludeUserName**.</span></span>
- <span data-ttu-id="32a81-372">已添加新 cmdlet **Get-FileHash** ，该 cmdlet 可返回采用几种格式之一的指定文件的文件哈希。</span><span class="sxs-lookup"><span data-stu-id="32a81-372">A new cmdlet, **Get-FileHash** , that returns a file hash in one of several formats for a specified file, has been added.</span></span>
- <span data-ttu-id="32a81-373">在 Windows PowerShell 4.0 中，如果某个模块在其清单中使用了 **DefaultCommandPrefix** 键，或者如果用户导入了一个带有 **Prefix** 参数的模块，则该模块的 **ExportedCommands** 属性将显示该模块中带有前缀的命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-373">In Windows PowerShell 4.0, if a module uses the **DefaultCommandPrefix** key in its manifest, or if the user imports a module with the **Prefix** parameter, the **ExportedCommands** property of the module shows the commands in the module with the prefix.</span></span> <span data-ttu-id="32a81-374">当你使用模块限定语法 ModuleName\\CommandName 来运行这些命令时，命令名称必须包含前缀。</span><span class="sxs-lookup"><span data-stu-id="32a81-374">When you run the commands by using the module-qualified syntax, ModuleName\\CommandName, the command names must include the prefix.</span></span>
- <span data-ttu-id="32a81-375">**$PSVersionTable.PSVersion** 的值已更新为 4.0。</span><span class="sxs-lookup"><span data-stu-id="32a81-375">The value of **$PSVersionTable.PSVersion** has been updated to 4.0.</span></span>
- <span data-ttu-id="32a81-376">**Where()** 运算符行为已更改。</span><span class="sxs-lookup"><span data-stu-id="32a81-376">**Where()** operator behavior has changed.</span></span> <span data-ttu-id="32a81-377">不再支持接受采用 `"Property -CompareOperator Value"` 格式的字符串表达式的 `Collection.Where('property -match name')`。</span><span class="sxs-lookup"><span data-stu-id="32a81-377">`Collection.Where('property -match name')` accepting a string expression in the format `"Property -CompareOperator Value"` is no longer supported.</span></span>
  <span data-ttu-id="32a81-378">但是， **Where()** 运算符可接受采用脚本块格式的字符串表达式；仍支持此行为。</span><span class="sxs-lookup"><span data-stu-id="32a81-378">However, the **Where()** operator accepts string expressions in the format of a scriptblock; this is still supported.</span></span>

### <a name="new-features-in-windows-powershell-integrated-scripting-environment-ise"></a><span data-ttu-id="32a81-379">Windows PowerShell 集成脚本环境 (ISE) 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-379">New features in Windows PowerShell Integrated Scripting Environment (ISE)</span></span>

- <span data-ttu-id="32a81-380">Windows PowerShell ISE 同时支持 Windows PowerShell 工作流调试和远程脚本调试。</span><span class="sxs-lookup"><span data-stu-id="32a81-380">Windows PowerShell ISE supports both Windows PowerShell Workflow debugging and remote script debugging.</span></span>
- <span data-ttu-id="32a81-381">已为 Windows PowerShell Desired State Configuration 提供程序和配置添加 IntelliSense 支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-381">IntelliSense support has been added for Windows PowerShell Desired State Configuration providers and configurations.</span></span>

### <a name="new-features-in-windows-powershell-workflow"></a><span data-ttu-id="32a81-382">Windows PowerShell 工作流中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-382">New features in Windows PowerShell Workflow</span></span>

- <span data-ttu-id="32a81-383">已添加对迭代管道上下文中新的 **PipelineVariable** 通用参数的支持，其中迭代管道是指诸如这些由 System Center Orchestrator 所使用的管道；即相对于通过使用流式处理交错运行，只需从左到右运行命令的管道。</span><span class="sxs-lookup"><span data-stu-id="32a81-383">Support has been added for a new **PipelineVariable** common parameter in the context of iterative pipelines, such as those used by System Center Orchestrator; that is, pipelines that run commands simply left-to-right, as opposed to interspersed running by using streaming.</span></span>
- <span data-ttu-id="32a81-384">参数绑定已得到显著增强，从而在 Tab 自动补全情况以外的其他情况下使用，例如用于当前运行空间中不存在的命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-384">Parameter binding has been significantly enhanced to work outside of tab completion scenarios, such as with commands that do not exist in the current runspace.</span></span>
- <span data-ttu-id="32a81-385">已向 Windows PowerShell 工作流添加对自定义容器活动的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-385">Support for custom container activities has been added to Windows PowerShell Workflow.</span></span> <span data-ttu-id="32a81-386">如果某个活动参数 Activity\[] 属于类型 Activity（或为泛型活动集合），并且用户已提供一个脚本块作为实际参数，则 Windows PowerShell 工作流会将该脚本块转换为 XAML，正如处理普通的 Windows PowerShell 脚本到工作流编译一样   。</span><span class="sxs-lookup"><span data-stu-id="32a81-386">If an activity parameter is of the types **Activity** , **Activity\[]** (or is a generic collection of activities) and the user has supplied a script block as an argument, then Windows PowerShell Workflow converts the script block to XAML, as with normal Windows PowerShell script-to-workflow compilation.</span></span>
- <span data-ttu-id="32a81-387">在发生崩溃之后，Windows PowerShell 工作流会自动重新连接到托管的节点。</span><span class="sxs-lookup"><span data-stu-id="32a81-387">After a crash, Windows PowerShell Workflow automatically reconnects to managed nodes.</span></span>
- <span data-ttu-id="32a81-388">你现在可以通过使用 **ThrottleLimit** 属性来限制 **Foreach -Parallel** 活动语句。</span><span class="sxs-lookup"><span data-stu-id="32a81-388">You can now throttle **Foreach -Parallel** activity statements by using the **ThrottleLimit** property.</span></span>
- <span data-ttu-id="32a81-389">**ErrorAction** 通用参数具有一个专用于工作流的新的有效值： **Suspend** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-389">The **ErrorAction** common parameter has a new valid value, **Suspend** , that is exclusively for workflows.</span></span>
- <span data-ttu-id="32a81-390">现在，如果不存在任何活动会话、进行中的作业和挂起的作业，则工作流终结点会自动关闭。</span><span class="sxs-lookup"><span data-stu-id="32a81-390">A workflow endpoint now automatically closes if there are no active sessions, no in-progress jobs, and no pending jobs.</span></span> <span data-ttu-id="32a81-391">当满足自动关闭条件时，此功能可保存充当工作流服务器的计算机上的资源。</span><span class="sxs-lookup"><span data-stu-id="32a81-391">This feature conserves resources on the computer that is acting as the workflow server, when the automatic closure conditions have been met.</span></span>

### <a name="new-features-in-windows-powershell-web-services"></a><span data-ttu-id="32a81-392">Windows PowerShell Web 服务中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-392">New features in Windows PowerShell Web Services</span></span>

- <span data-ttu-id="32a81-393">当 Windows PowerShell Web 服务（PSWS，也称为“管理 OData IIS 扩展”）中发生错误时，则在 cmdlet 运行的同时，会向调用方返回更详细的错误消息。</span><span class="sxs-lookup"><span data-stu-id="32a81-393">When an error occurs in Windows PowerShell Web Services (PSWS, also called Management OData IIS Extension), while a cmdlet is running, more detailed error messages are returned to the caller.</span></span> <span data-ttu-id="32a81-394">此外，错误代码遵守 [Windows Azure REST API 错误代码指南](/rest/api/storageservices/Common-REST-API-Error-Codes)。</span><span class="sxs-lookup"><span data-stu-id="32a81-394">In addition, error codes follow [Windows Azure REST API error code guidelines](/rest/api/storageservices/Common-REST-API-Error-Codes).</span></span>
- <span data-ttu-id="32a81-395">现在，终结点可以定义 API 版本，也可以强制使用特定的 API 版本。</span><span class="sxs-lookup"><span data-stu-id="32a81-395">An endpoint can now define the API version, as well as enforce the usage of a specific API version.</span></span> <span data-ttu-id="32a81-396">每当客户端和服务器之间发生版本不匹配时，都会向客户端和服务器显示错误。</span><span class="sxs-lookup"><span data-stu-id="32a81-396">Whenever version mismatches occur between client and server, errors are displayed to both the client and the server.</span></span>
- <span data-ttu-id="32a81-397">通过为调度架构中任何缺少的字段自动生成值，简化了该架构的管理操作。</span><span class="sxs-lookup"><span data-stu-id="32a81-397">Management of the dispatch schema has been simplified by automatically generating values for any missing fields in the schema.</span></span> <span data-ttu-id="32a81-398">即使调度架构不存在，生成也会发生，它是一个很有帮助的起点。</span><span class="sxs-lookup"><span data-stu-id="32a81-398">Generation occurs, as a helpful starting point, even if the dispatch schema does not exist.</span></span>
- <span data-ttu-id="32a81-399">通过效仿 Windows PowerShell 中的 **PSTypeConverter** 的行为，PSWS 中的类型处理得到了改进，可支持使用除默认构造函数以外的其他构造函数的类型。</span><span class="sxs-lookup"><span data-stu-id="32a81-399">Type handling in PSWS has been improved to support types that use a different constructor than the default constructor, by behaving similarly to the **PSTypeConverter** in Windows PowerShell.</span></span> <span data-ttu-id="32a81-400">这使你能够通过 PSWS 使用复杂类型。</span><span class="sxs-lookup"><span data-stu-id="32a81-400">This lets you use complex types with PSWS.</span></span>
- <span data-ttu-id="32a81-401">PSWS 现在允许在运行查询的同时扩展关联的实例。</span><span class="sxs-lookup"><span data-stu-id="32a81-401">PSWS now allows expanding an associated instance while running a query.</span></span> <span data-ttu-id="32a81-402">对于较大的二进制内容（如图像、音频或视频），传输成本相当高，最好在未编码的情况下传输二进制数据。</span><span class="sxs-lookup"><span data-stu-id="32a81-402">For larger binary contents (such as images, audio, or video), the transfer cost is significant, and it is better to transfer binary data without encoding.</span></span> <span data-ttu-id="32a81-403">PSWS 将命名的资源流用于传输，无需编码。</span><span class="sxs-lookup"><span data-stu-id="32a81-403">PSWS uses named resource streams for transferring without encoding.</span></span>
  <span data-ttu-id="32a81-404">命名的资源流是 **Edm.Stream** 类型的实体的属性。</span><span class="sxs-lookup"><span data-stu-id="32a81-404">The named resource stream is a property of an entity of the **Edm.Stream** type.</span></span> <span data-ttu-id="32a81-405">每个命名的资源流都具有针对 GET 或 UPDATE 操作的单独 URI。</span><span class="sxs-lookup"><span data-stu-id="32a81-405">Each named resource stream has a separate URI for GET or UPDATE operations.</span></span>
- <span data-ttu-id="32a81-406">OData 操作现在提供一种用于对资源调用非 CRUD（Create、Read、Update 和 Delete）方法的机制。</span><span class="sxs-lookup"><span data-stu-id="32a81-406">OData actions now provide a mechanism for invoking non-CRUD (Create, Read, Update, and Delete) methods on a resource.</span></span> <span data-ttu-id="32a81-407">你可以通过将 HTTP POST 请求发送到为操作定义的 URI 来调用该操作。</span><span class="sxs-lookup"><span data-stu-id="32a81-407">You can invoke an action by sending an HTTP POST request to the URI that is defined for the action.</span></span> <span data-ttu-id="32a81-408">操作参数是在 POST 请求的正文中定义的。</span><span class="sxs-lookup"><span data-stu-id="32a81-408">The parameters for the action are defined in the body of the POST request.</span></span>
- <span data-ttu-id="32a81-409">为了与 Windows Azure 指南保持一致，所有的 URL 都应简化。</span><span class="sxs-lookup"><span data-stu-id="32a81-409">To be consistent with Windows Azure guidelines, all URLs should be simplified.</span></span> <span data-ttu-id="32a81-410">包含在 **Key As Segment** 中的更改允许以分段形式表示单独的键。</span><span class="sxs-lookup"><span data-stu-id="32a81-410">A change included in **Key As Segment** allows single keys to be represented as segments.</span></span> <span data-ttu-id="32a81-411">请注意，使用多个键值的引用仍旧要求值以逗号分隔并用括号括起来。</span><span class="sxs-lookup"><span data-stu-id="32a81-411">Note that references that use multiple key values require comma-separated values in parenthetical notation, as before.</span></span>
- <span data-ttu-id="32a81-412">在此版本的 PSWS 之前，执行 Create、Update 或 Delete 操作的唯一方式是对顶级资源调用 Post、Put 或 Delete。</span><span class="sxs-lookup"><span data-stu-id="32a81-412">Before this release of PSWS, the only way to perform Create, Update, or Delete operations was to invoke Post, Put, or Delete on a top-level resource.</span></span> <span data-ttu-id="32a81-413">此版本的 PSWS 中新增了 Contained Resource 操作，它使用户能够获得相同的结果却不必如此直接地访问相同的资源，如同在这些资源已包含在内的情况下进行访问。</span><span class="sxs-lookup"><span data-stu-id="32a81-413">New in this release of PSWS, Contained Resource operations let users achieve the same results while reaching the same resource less directly, approaching as if these resources were contained.</span></span>

### <a name="new-features-in-windows-powershell-web-access"></a><span data-ttu-id="32a81-414">Windows PowerShell Web 访问中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-414">New features in Windows PowerShell Web Access</span></span>

- <span data-ttu-id="32a81-415">在基于 Web 的 Windows PowerShell Web 访问控制台中，你可以断开现有会话的连接，然后重新连接到这些会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-415">You can disconnect from and reconnect to existing sessions in the web-based Windows PowerShell Web Access console.</span></span> <span data-ttu-id="32a81-416">基于 Web 的控制台中的“ **保存** ”按钮使你可以在不删除会话的情况下断开与它的连接，然后在下次重新连接到该会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-416">A **Save** button in the web-based console lets you disconnect from a session without deleting it and reconnect to the session another time.</span></span>
- <span data-ttu-id="32a81-417">默认参数可以显示在登录页上。</span><span class="sxs-lookup"><span data-stu-id="32a81-417">Default parameters can be displayed on the sign-in page.</span></span> <span data-ttu-id="32a81-418">若要显示默认参数，请在名为 **web.config** 的文件中为显示在登录页的“ **可选的连接设置** ”区域中的所有设置配置值。可以使用 **web.config** 文件来配置所有可选的连接设置（一组辅助或备用凭据除外）。</span><span class="sxs-lookup"><span data-stu-id="32a81-418">To display default parameters, configure values for all of the settings displayed in the **Optional Connection Settings** area of the sign-in page in a file named **web.config**. You can use the **web.config** file to configure all optional connection settings except for a second or alternate set of credentials.</span></span>
- <span data-ttu-id="32a81-419">在 Windows Server 2012 R2 中，可以远程管理 Windows PowerShell Web 访问的授权规则。</span><span class="sxs-lookup"><span data-stu-id="32a81-419">In Windows Server 2012 R2, you can remotely manage authorization rules for Windows PowerShell Web Access.</span></span> <span data-ttu-id="32a81-420">**Add-PswaAuthorizationRule** 和 **Test-PswaAuthorizationRule** cmdlet 现在包含一个 Credential 参数，该参数使管理员能够从远程计算机或在 Windows PowerShell Web 访问会话中管理授权规则。</span><span class="sxs-lookup"><span data-stu-id="32a81-420">The **Add-PswaAuthorizationRule** and **Test-PswaAuthorizationRule** cmdlets now include a Credential parameter that enables administrators to manage authorization rules from a remote computer or in a Windows PowerShell Web Access session.</span></span>
- <span data-ttu-id="32a81-421">现在，你可以通过将新的浏览器选项卡用于每个会话，在单个浏览器会话中实现多个 Windows PowerShell Web 访问会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-421">You can now have multiple Windows PowerShell Web Access sessions in a single browser session by using a new browser tab for each session.</span></span> <span data-ttu-id="32a81-422">你不再需要打开新的浏览器会话，即可连接到基于 Web 的 Windows PowerShell 控制台中的新会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-422">You no longer need to open a new browser session to connect to a new session in the web-based Windows PowerShell console.</span></span>

### <a name="notable-bug-fixes-in-windows-powershell-40"></a><span data-ttu-id="32a81-423">Windows PowerShell 4.0 中值得注意的 Bug 修复</span><span class="sxs-lookup"><span data-stu-id="32a81-423">Notable bug fixes in Windows PowerShell 4.0</span></span>

- <span data-ttu-id="32a81-424">**Get-Counter** 现在可以返回法语版 Windows 中包含一个撇号字符的计数器。</span><span class="sxs-lookup"><span data-stu-id="32a81-424">**Get-Counter** can now return counters that contain an apostrophe character in French editions of Windows.</span></span>
- <span data-ttu-id="32a81-425">你现在可以查看反序列化对象上的 **GetType** 方法。</span><span class="sxs-lookup"><span data-stu-id="32a81-425">You can now view the **GetType** method on deserialized objects.</span></span>
- <span data-ttu-id="32a81-426">**#Requires** 语句现在允许用户获得管理员访问权限（如果需要）。</span><span class="sxs-lookup"><span data-stu-id="32a81-426">**#Requires** statements now let users require Administrator access rights, if needed.</span></span>
- <span data-ttu-id="32a81-427">**Import-Csv** cmdlet 现在忽略空白行。</span><span class="sxs-lookup"><span data-stu-id="32a81-427">The **Import-Csv** cmdlet now ignores blank lines.</span></span>
- <span data-ttu-id="32a81-428">已修复运行 **Invoke-WebRequest** 命令时 Windows PowerShell ISE 占用太多内存的问题。</span><span class="sxs-lookup"><span data-stu-id="32a81-428">A problem where Windows PowerShell ISE uses too much memory when you are running an **Invoke-WebRequest** command has been fixed.</span></span>
- <span data-ttu-id="32a81-429">**Get-Module** 现在可在 **Version** 列中显示模块版本。</span><span class="sxs-lookup"><span data-stu-id="32a81-429">**Get-Module** now displays module versions in a **Version** column.</span></span>
- <span data-ttu-id="32a81-430">不出所料，现在 Remove-Item -Recurse 会删除子文件夹中的项。</span><span class="sxs-lookup"><span data-stu-id="32a81-430">Remove-Item -Recurse now removes items from subfolders as expected.</span></span>
- <span data-ttu-id="32a81-431">已向 **Get-Process** 输出对象添加 **UserName** 属性。</span><span class="sxs-lookup"><span data-stu-id="32a81-431">A **UserName** property has been added to **Get-Process** output objects.</span></span>
- <span data-ttu-id="32a81-432">**Invoke-RestMethod** cmdlet 现在可返回所有可用结果。</span><span class="sxs-lookup"><span data-stu-id="32a81-432">The **Invoke-RestMethod** cmdlet now returns all available results.</span></span>
- <span data-ttu-id="32a81-433">**Add-Member** 现在将对哈希表生效，即使尚未访问这些哈希表。</span><span class="sxs-lookup"><span data-stu-id="32a81-433">**Add-Member** now takes effect on hashtables, even if the hashtables have not yet been accessed.</span></span>
- <span data-ttu-id="32a81-434">**Select-Object -Expand** 在属性值为 null 或空时不再失败或生成异常。</span><span class="sxs-lookup"><span data-stu-id="32a81-434">**Select-Object -Expand** no longer fails or generates an exception if the value of the property is null or empty.</span></span>
- <span data-ttu-id="32a81-435">**Get-Process** 现在可与用于从对象中获取 **ComputerName** 属性的其他命令一起在管道中使用。</span><span class="sxs-lookup"><span data-stu-id="32a81-435">**Get-Process** can now be used in a pipeline with other commands that get the **ComputerName** property from objects.</span></span>
- <span data-ttu-id="32a81-436">**ConvertTo-Json** 和 **ConvertFrom-Json** 现在可以接受用双引号引起来的术语，并且其错误消息现在可以进行本地化。</span><span class="sxs-lookup"><span data-stu-id="32a81-436">**ConvertTo-Json** and **ConvertFrom-Json** can now accept terms within double quotes, and its error messages are now localizable.</span></span>
- <span data-ttu-id="32a81-437">**Get-Job** 现在返回所任何已完成的计划作业，甚至是新会话中的计划作业。</span><span class="sxs-lookup"><span data-stu-id="32a81-437">**Get-Job** now returns any completed scheduled jobs, even in new sessions.</span></span>
- <span data-ttu-id="32a81-438">已修复在 Windows PowerShell 4.0 中使用 **FileSystem** 提供程序装载和卸载 VHD 的问题。</span><span class="sxs-lookup"><span data-stu-id="32a81-438">Issues with mounting and unmounting VHDs by using the **FileSystem** provider in Windows PowerShell 4.0 have been fixed.</span></span> <span data-ttu-id="32a81-439">现在，当新的驱动器装载在相同的会话中时，Windows PowerShell 能够检测到这些驱动器。</span><span class="sxs-lookup"><span data-stu-id="32a81-439">Windows PowerShell is now able to detect new drives when they are mounted in the same session.</span></span>
- <span data-ttu-id="32a81-440">不再需要显式地加载 **ScheduledJob** 或 **Workflow** 模块即可使用其作业类型。</span><span class="sxs-lookup"><span data-stu-id="32a81-440">You no longer need to explicitly load **ScheduledJob** or **Workflow** modules to work with their job types.</span></span>
- <span data-ttu-id="32a81-441">已对以下过程进行了性能改进：导入用于定义嵌套工作流的工作流；此过程现在速度更快。</span><span class="sxs-lookup"><span data-stu-id="32a81-441">Performance improvements have been made to the process of importing workflows that define nested workflows; this process is now faster.</span></span>

## <a name="new-features-in-windows-powershell-30"></a><span data-ttu-id="32a81-442">Windows PowerShell 3.0 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="32a81-442">New features in Windows PowerShell 3.0</span></span>

<span data-ttu-id="32a81-443">Windows PowerShell 3.0 包括以下新增功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-443">Windows PowerShell 3.0 includes the following new features.</span></span>

- [<span data-ttu-id="32a81-444">Windows PowerShell 工作流</span><span class="sxs-lookup"><span data-stu-id="32a81-444">Windows PowerShell Workflow</span></span>](#windows-powershell-workflow)
- [<span data-ttu-id="32a81-445">Windows PowerShell Web 访问</span><span class="sxs-lookup"><span data-stu-id="32a81-445">Windows PowerShell Web Access</span></span>](#windows-powershell-web-access)
- [<span data-ttu-id="32a81-446">新的 Windows PowerShell ISE 功能</span><span class="sxs-lookup"><span data-stu-id="32a81-446">New Windows PowerShell ISE Features</span></span>](#new-windows-powershell-ise-features)
- [<span data-ttu-id="32a81-447">对 Microsoft .NET Framework 4.0 的支持</span><span class="sxs-lookup"><span data-stu-id="32a81-447">Support for Microsoft .NET Framework 4.0</span></span>](#support-for-microsoft-net-framework-4)
- [<span data-ttu-id="32a81-448">对 Windows 预安装环境的支持</span><span class="sxs-lookup"><span data-stu-id="32a81-448">Support for Windows Preinstallation Environment</span></span>](#support-for-windows-preinstallation-environment)
- [<span data-ttu-id="32a81-449">断开连接的会话</span><span class="sxs-lookup"><span data-stu-id="32a81-449">Disconnected Sessions</span></span>](#disconnected-sessions)
- [<span data-ttu-id="32a81-450">稳定的会话连接</span><span class="sxs-lookup"><span data-stu-id="32a81-450">Robust Session Connectivity</span></span>](#robust-session-connectivity)
- [<span data-ttu-id="32a81-451">可更新的帮助系统</span><span class="sxs-lookup"><span data-stu-id="32a81-451">Updatable Help System</span></span>](#updatable-help-system)
- [<span data-ttu-id="32a81-452">增强的联机帮助</span><span class="sxs-lookup"><span data-stu-id="32a81-452">Enhanced Online Help</span></span>](#enhanced-online-help)
- [<span data-ttu-id="32a81-453">CIM 集成</span><span class="sxs-lookup"><span data-stu-id="32a81-453">CIM integration</span></span>](#cim-integration)
- [<span data-ttu-id="32a81-454">会话配置文件</span><span class="sxs-lookup"><span data-stu-id="32a81-454">Session Configuration Files</span></span>](#session-configuration-files)
- [<span data-ttu-id="32a81-455">计划作业和任务计划程序集成</span><span class="sxs-lookup"><span data-stu-id="32a81-455">Scheduled Jobs and Task Scheduler Integration</span></span>](#scheduled-jobs-and-task-scheduler-integration)
- [<span data-ttu-id="32a81-456">Windows PowerShell 语言增强功能</span><span class="sxs-lookup"><span data-stu-id="32a81-456">Windows PowerShell Language Enhancements</span></span>](#windows-powershell-language-enhancements)
- [<span data-ttu-id="32a81-457">新的核心 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="32a81-457">New Core Cmdlets</span></span>](#new-core-cmdlets)
- [<span data-ttu-id="32a81-458">对现有核心 Cmdlet 和提供程序的改进</span><span class="sxs-lookup"><span data-stu-id="32a81-458">Improvements to Existing Core Cmdlets and Providers</span></span>](#improvements-to-existing-core-cmdlets-and-providers)
- [<span data-ttu-id="32a81-459">远程模块导入和发现</span><span class="sxs-lookup"><span data-stu-id="32a81-459">Remote module import and discovery</span></span>](#remote-module-import-and-discovery)
- [<span data-ttu-id="32a81-460">增强的 Tab 自动补全</span><span class="sxs-lookup"><span data-stu-id="32a81-460">Enhanced Tab Completion</span></span>](#enhanced-tab-completion)
- [<span data-ttu-id="32a81-461">模块自动加载</span><span class="sxs-lookup"><span data-stu-id="32a81-461">Module Auto-Loading</span></span>](#module-auto-loading)
- [<span data-ttu-id="32a81-462">模块体验改进</span><span class="sxs-lookup"><span data-stu-id="32a81-462">Module Experience Improvements</span></span>](#module-experience-improvements)
- [<span data-ttu-id="32a81-463">简化的命令发现</span><span class="sxs-lookup"><span data-stu-id="32a81-463">Simplified Command Discovery</span></span>](#simplified-command-discovery)
- [<span data-ttu-id="32a81-464">改进的日志记录、诊断和组策略支持</span><span class="sxs-lookup"><span data-stu-id="32a81-464">Improved Logging, Diagnostics, and Group Policy Support</span></span>](#improved-logging-diagnostics-and-group-policy-support)
- [<span data-ttu-id="32a81-465">格式设置和输出改进</span><span class="sxs-lookup"><span data-stu-id="32a81-465">Formatting and Output Improvements</span></span>](#formatting-and-output-improvements)
- [<span data-ttu-id="32a81-466">增强的控制台主机体验</span><span class="sxs-lookup"><span data-stu-id="32a81-466">Enhanced Console Host Experience</span></span>](#enhanced-console-host-experience)
- [<span data-ttu-id="32a81-467">新的 Cmdlet 和宿主 API</span><span class="sxs-lookup"><span data-stu-id="32a81-467">New Cmdlet and Hosting APIs</span></span>](#new-cmdlet-and-hosting-apis)
- [<span data-ttu-id="32a81-468">性能改进</span><span class="sxs-lookup"><span data-stu-id="32a81-468">Performance Improvements</span></span>](#performance-improvements)
- [<span data-ttu-id="32a81-469">运行身份和共享主机支持</span><span class="sxs-lookup"><span data-stu-id="32a81-469">RunAs and Shared Host Support</span></span>](#runas-and-shared-host-support)
- [<span data-ttu-id="32a81-470">特殊字符处理改进</span><span class="sxs-lookup"><span data-stu-id="32a81-470">Special Character Handling Improvements</span></span>](#special-character-handling-improvements)

### <a name="windows-powershell-workflow"></a><span data-ttu-id="32a81-471">Windows PowerShell 工作流程</span><span class="sxs-lookup"><span data-stu-id="32a81-471">Windows PowerShell Workflow</span></span>

<span data-ttu-id="32a81-472">Windows PowerShell 工作流将 Windows Workflow Foundation 的强大功能引入到 Windows PowerShell 中。</span><span class="sxs-lookup"><span data-stu-id="32a81-472">Windows PowerShell Workflow brings the power of Windows Workflow Foundation to Windows PowerShell.</span></span>
<span data-ttu-id="32a81-473">你可以采用 XAML 或 Windows PowerShell 语言编写工作流，然后像运行 cmdlet 一样运行它们。</span><span class="sxs-lookup"><span data-stu-id="32a81-473">You can write workflows in XAML or in the Windows PowerShell language and run them just as you would run a cmdlet.</span></span> <span data-ttu-id="32a81-474">`Get-Command` cmdlet 获取工作流命令，而 `Get-Help` cmdlet 则获取工作流帮助。</span><span class="sxs-lookup"><span data-stu-id="32a81-474">The `Get-Command` cmdlet gets workflow commands and the `Get-Help` cmdlet gets help for workflows.</span></span>

<span data-ttu-id="32a81-475">工作流是多计算机管理活动序列，其特点是长期运行、可重复、频繁、可并行化、可中断、可挂起并且可重启。</span><span class="sxs-lookup"><span data-stu-id="32a81-475">Workflows are sequences of multicomputer management activities that are long-running, repeatable, frequent, parallelizable, interruptible, suspendable, and restartable.</span></span> <span data-ttu-id="32a81-476">工作流可以从有意或意外中断（例如网络中断、Windows 重新启动或电源故障）中恢复。</span><span class="sxs-lookup"><span data-stu-id="32a81-476">Workflows can be resumed from an intentional or accidental interruption, such as a network outage, a Windows restart, or a power failure.</span></span>

<span data-ttu-id="32a81-477">工作流也是便携式的；它们可作为 XAML 文件导出或从 XAML 文件中导入。</span><span class="sxs-lookup"><span data-stu-id="32a81-477">Workflows are also portable; they can be exported as or imported from XAML files.</span></span> <span data-ttu-id="32a81-478">你可以编写自定义会话配置，这些配置允许工作流或工作流中的活动由获委派的或下级用户操作。</span><span class="sxs-lookup"><span data-stu-id="32a81-478">You can write custom session configurations that allow workflow or activities in a workflow to be run by delegated or subordinate users.</span></span>

<span data-ttu-id="32a81-479">以下是 Windows PowerShell 工作流的优势</span><span class="sxs-lookup"><span data-stu-id="32a81-479">The following are the benefits of Windows PowerShell Workflow</span></span>

- <span data-ttu-id="32a81-480">自动运行有序的、长期运行的任务。</span><span class="sxs-lookup"><span data-stu-id="32a81-480">Automation of sequenced, long-running tasks.</span></span>
- <span data-ttu-id="32a81-481">**远程监控长期运行的任务** 。</span><span class="sxs-lookup"><span data-stu-id="32a81-481">**Remote monitoring of long-running tasks**.</span></span> <span data-ttu-id="32a81-482">活动的状态和进度随时可见。</span><span class="sxs-lookup"><span data-stu-id="32a81-482">Status and progress of activities are visible at any time.</span></span>
- <span data-ttu-id="32a81-483">**多计算机管理。**</span><span class="sxs-lookup"><span data-stu-id="32a81-483">**Multicomputer management.**</span></span> <span data-ttu-id="32a81-484">同时在数百个托管节点上将任务作为工作流运行。</span><span class="sxs-lookup"><span data-stu-id="32a81-484">Simultaneously run tasks as workflows on hundreds of managed nodes.</span></span>
  <span data-ttu-id="32a81-485">Windows PowerShell 工作流包含了一个内置的常用管理参数（例如 **PSComputerName** ）库，实现了多计算机管理方案。</span><span class="sxs-lookup"><span data-stu-id="32a81-485">Windows PowerShell Workflow includes a built-in library of common management parameters, such as **PSComputerName** , which enable multi-computer management scenarios.</span></span>
- <span data-ttu-id="32a81-486">**复杂进程的单个任务执行。**</span><span class="sxs-lookup"><span data-stu-id="32a81-486">**Single task execution of complex processes.**</span></span> <span data-ttu-id="32a81-487">你可将实施整个端到端方案的相关脚本集成到单个工作流中。</span><span class="sxs-lookup"><span data-stu-id="32a81-487">You can combine related scripts that implement an entire end-to-end scenario into a single workflow.</span></span>
- <span data-ttu-id="32a81-488">**暂留。** ：工作流保存在由其作者定义的特定点上（或在这些点上对工作流执行检查点），以便你可以从最后暂留的任务（或检查点）恢复该工作流，而不是从开头重启该工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-488">**Persistence.** : a workflow is saved (or check-pointed) at specific points defined by its author so you can resume the workflow from the last persisted task (or checkpoint), instead of restarting the workflow from the beginning.</span></span>
- <span data-ttu-id="32a81-489">**稳定性。**</span><span class="sxs-lookup"><span data-stu-id="32a81-489">**Robustness.**</span></span> <span data-ttu-id="32a81-490">自动的故障恢复。</span><span class="sxs-lookup"><span data-stu-id="32a81-490">Automated failure recovery.</span></span> <span data-ttu-id="32a81-491">工作流支持计划和非计划的重新启动。</span><span class="sxs-lookup"><span data-stu-id="32a81-491">Workflows survive planned and unplanned restarts.</span></span> <span data-ttu-id="32a81-492">你可以挂起工作流执行，然后从最后一个暂留点恢复该工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-492">You can suspend workflow execution and then resume the workflow from the last persistence point.</span></span>
  <span data-ttu-id="32a81-493">工作流作者可以指定当在一个或多个托管节点上出现故障时，要重新运行的特定活动。</span><span class="sxs-lookup"><span data-stu-id="32a81-493">Workflow authors can designate specific activities to be re-run in case of failure on one or more managed nodes.</span></span>
- <span data-ttu-id="32a81-494">**断开连接、重新连接以及在已断开连接的会话中运行的能力。**</span><span class="sxs-lookup"><span data-stu-id="32a81-494">**Ability to disconnect, reconnect, and run in disconnected sessions.**</span></span> <span data-ttu-id="32a81-495">用户可以连接和断开工作流服务器，但工作流依旧继续运行。</span><span class="sxs-lookup"><span data-stu-id="32a81-495">Users can connect and disconnect from the workflow server, but the workflow runs continuously.</span></span> <span data-ttu-id="32a81-496">你可以注销客户端计算机或重新启动客户端计算机，并通过其他计算机监视工作流执行，而不中断工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-496">You can log off of the client computer or restart the client computer and monitor the workflow execution from another computer without interrupting the workflow.</span></span>
- <span data-ttu-id="32a81-497">**计划。**</span><span class="sxs-lookup"><span data-stu-id="32a81-497">**Scheduling.**</span></span> <span data-ttu-id="32a81-498">可以像计划任何 Windows PowerShell cmdlet 或脚本那样计划工作流任务。</span><span class="sxs-lookup"><span data-stu-id="32a81-498">Workflow tasks can be scheduled like any Windows PowerShell cmdlet or script.</span></span>
- <span data-ttu-id="32a81-499">**工作流和连接限制。**</span><span class="sxs-lookup"><span data-stu-id="32a81-499">**Workflow and Connection Throttling.**</span></span> <span data-ttu-id="32a81-500">可以限制工作流执行和到节点的连接，从而实现可扩展性且高可用性的方案。</span><span class="sxs-lookup"><span data-stu-id="32a81-500">Workflow execution and connections to nodes can be throttled, thus enabling scalability and high-availability scenarios.</span></span>

### <a name="windows-powershell-web-access"></a><span data-ttu-id="32a81-501">Windows PowerShell Web 访问</span><span class="sxs-lookup"><span data-stu-id="32a81-501">Windows PowerShell Web Access</span></span>

<span data-ttu-id="32a81-502">Windows PowerShell Web 访问是一项 Windows Server 2012 功能，它允许用户在基于 Web 的控制台中运行 Windows PowerShell 命令和脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-502">Windows PowerShell Web Access is a Windows Server 2012 feature that lets users run Windows PowerShell commands and scripts in a web-based console.</span></span> <span data-ttu-id="32a81-503">使用基于 Web 的控制台的设备不需要安装 Windows PowerShell、远程管理软件或浏览器插件。</span><span class="sxs-lookup"><span data-stu-id="32a81-503">Devices that use the web-based console do not require Windows PowerShell, remote management software, or browser plug-in installations.</span></span> <span data-ttu-id="32a81-504">只需要正确配置的 Windows PowerShell Web 访问网关以及支持 JavaScript 和接受 Cookie 的客户端设备浏览器。</span><span class="sxs-lookup"><span data-stu-id="32a81-504">All that is required is a properly-configured Windows PowerShell Web Access gateway and a client device browser that supports JavaScript and accepts cookies.</span></span>

<span data-ttu-id="32a81-505">有关详细信息，请参阅[部署 Windows PowerShell Web 访问](/previous-versions/powershell/scripting/components/web-access/install-and-use-windows-powershell-web-access)。</span><span class="sxs-lookup"><span data-stu-id="32a81-505">For more information, see [Deploy Windows PowerShell Web Access](/previous-versions/powershell/scripting/components/web-access/install-and-use-windows-powershell-web-access).</span></span>

### <a name="new-windows-powershell-ise-features"></a><span data-ttu-id="32a81-506">新的 Windows PowerShell ISE 功能</span><span class="sxs-lookup"><span data-stu-id="32a81-506">New Windows PowerShell ISE Features</span></span>

<span data-ttu-id="32a81-507">对于 Windows PowerShell 3.0 来说，Windows PowerShell 集成脚本环境 (ISE) 具有许多新增功能，包括 IntelliSense、显示命令窗口、统一的控制台窗格、代码段、大括号匹配、展开/折叠部分、自动保存、最近使用的项列表、批量复制、块复制，以及对编写 Windows PowerShell 脚本工作流的完全支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-507">For Windows PowerShell 3.0, Windows PowerShell Integrated Scripting Environment (ISE) has many new features, including IntelliSense, Show-Command window, a unified Console Pane, snippets, brace-matching, expand-collapse sections, auto-save, recent items list, rich copy, block copy, and full support for writing Windows PowerShell script workflows.</span></span> <span data-ttu-id="32a81-508">有关详细信息，请参阅 [about_Windows_PowerShell_ISE](/powershell/module/microsoft.powershell.core/about/about_windows_powershell_ise)。</span><span class="sxs-lookup"><span data-stu-id="32a81-508">For more information, see [about_Windows_PowerShell_ISE](/powershell/module/microsoft.powershell.core/about/about_windows_powershell_ise).</span></span>

### <a name="support-for-microsoft-net-framework-4"></a><span data-ttu-id="32a81-509">对 Microsoft .NET Framework 4 的支持</span><span class="sxs-lookup"><span data-stu-id="32a81-509">Support for Microsoft .NET Framework 4</span></span>

<span data-ttu-id="32a81-510">Windows PowerShell 是针对公共语言运行时 4.0 而构建的。</span><span class="sxs-lookup"><span data-stu-id="32a81-510">Windows PowerShell is built against the Common Language Runtime 4.0.</span></span> <span data-ttu-id="32a81-511">Cmdlet、脚本和工作流作者可以在 Windows PowerShell 中使用新的 Microsoft .NET Framework 4 类，其功能包括应用程序兼容性和部署、Managed Extensibility Framework、并行计算、网络、Windows Communication Foundation 和 Windows Workflow Foundation。</span><span class="sxs-lookup"><span data-stu-id="32a81-511">Cmdlet, script, and workflow authors can use the new Microsoft .NET Framework 4 classes in Windows PowerShell, with features that include Application Compatibility and Deployment, Managed Extensibility Framework, Parallel Computing, Networking, Windows Communication Foundation and Windows Workflow Foundation.</span></span>

### <a name="support-for-windows-preinstallation-environment"></a><span data-ttu-id="32a81-512">对 Windows 预安装环境的支持</span><span class="sxs-lookup"><span data-stu-id="32a81-512">Support for Windows Preinstallation Environment</span></span>

<span data-ttu-id="32a81-513">Windows PowerShell 3.0 是 Windows 8 的 Windows 预安装环境 (Windows PE) 4.0 中的可选组件。</span><span class="sxs-lookup"><span data-stu-id="32a81-513">Windows PowerShell 3.0 is an optional component of Windows Preinstallation Environment (Windows PE) 4.0 for Windows 8.</span></span> <span data-ttu-id="32a81-514">Windows PE 是用于启动没有操作系统的计算机并使其为 Windows 安装做好准备的最小操作系统。</span><span class="sxs-lookup"><span data-stu-id="32a81-514">Windows PE is a minimal operating system that starts a computer that has no operating system and prepares it for Windows installation.</span></span> <span data-ttu-id="32a81-515">Windows PE 可用于对硬盘驱动器进行分区和格式设置、将磁盘映像复制到计算机，以及从网络共享启动 Windows 安装程序。</span><span class="sxs-lookup"><span data-stu-id="32a81-515">Windows PE can be used to partition and format hard drives, copy disk images to a computer, and initiate Windows Setup from a network share.</span></span>
<span data-ttu-id="32a81-516">可以在 Windows PE 上使用 Windows PowerShell 3.0 来管理部署、诊断和恢复方案。</span><span class="sxs-lookup"><span data-stu-id="32a81-516">Windows PowerShell 3.0 can be used on Windows PE to manage deployment, diagnostics, and recovery scenarios.</span></span>

### <a name="disconnected-sessions"></a><span data-ttu-id="32a81-517">断开连接的会话</span><span class="sxs-lookup"><span data-stu-id="32a81-517">Disconnected Sessions</span></span>

<span data-ttu-id="32a81-518">从 Windows PowerShell 3.0 开始，你使用 New-PSSession cmdlet 创建的用户托管的永久会话（“Pssession”）将保存在远程计算机上。</span><span class="sxs-lookup"><span data-stu-id="32a81-518">Beginning in Windows PowerShell 3.0, persistent user-managed sessions ("PSSessions") that you create by using the New-PSSession cmdlet are saved on the remote computer.</span></span> <span data-ttu-id="32a81-519">它们将不再依赖于创建它们的会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-519">They are no longer dependent on the session in which they were created.</span></span>

<span data-ttu-id="32a81-520">你现在可以在不中断在会话中运行的命令的情况下断开与该会话的连接。</span><span class="sxs-lookup"><span data-stu-id="32a81-520">You can now disconnect from a session without disrupting the commands that are running in the session.</span></span> <span data-ttu-id="32a81-521">你可以关闭该会话并关闭计算机。</span><span class="sxs-lookup"><span data-stu-id="32a81-521">You can close the session and shut down your computer.</span></span> <span data-ttu-id="32a81-522">稍后，你可以从相同或不同计算机上的另一个会话重新连接到该会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-522">Later, you can reconnect to the session from a different session on the same or on a different computer.</span></span>

<span data-ttu-id="32a81-523">`Get-PSSession` cmdlet 的 ComputerName  参数现在获取用户所有连接到计算机的会话，即使会话是在其他计算机上的不同会话中启动的，也不例外。</span><span class="sxs-lookup"><span data-stu-id="32a81-523">The **ComputerName** parameter of the `Get-PSSession` cmdlet now gets all of the user's sessions that connect to the computer, even if they were started in a different session on a different computer.</span></span> <span data-ttu-id="32a81-524">你可以连接到这些会话、获取命令结果、启动新的命令，然后断开与该会话的连接。</span><span class="sxs-lookup"><span data-stu-id="32a81-524">You can connect to the sessions, get the results of commands, start new commands, and then disconnect from the session.</span></span>

<span data-ttu-id="32a81-525">新增了 cmdlet（包括 `Disconnect-PSSession`、`Connect-PSSession` 和 `Receive-PSSession`），以支持“已断开连接的会话”功能；同时还向管理 PSSession 的 cmdlet 添加了新参数，如 `Invoke-Command` cmdlet 的 InDisconnectedSession  参数。</span><span class="sxs-lookup"><span data-stu-id="32a81-525">New cmdlets have been added to support the Disconnected Sessions feature, including `Disconnect-PSSession`, `Connect-PSSession`, and `Receive-PSSession`, and new parameters have been added to cmdlets that manage PSSessions, such as the **InDisconnectedSession** parameter of the `Invoke-Command` cmdlet.</span></span>

<span data-ttu-id="32a81-526">仅当连接的源端（“客户端”）和终端（“服务器”）上的计算机都运行的是 Windows PowerShell 3.0 时，才支持“断开连接的会话”功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-526">The Disconnected Sessions feature is supported only when the computers at both the originating ("client") and terminating ("server") ends of the connection are running Windows PowerShell 3.0.</span></span>

### <a name="robust-session-connectivity"></a><span data-ttu-id="32a81-527">稳定的会话连接</span><span class="sxs-lookup"><span data-stu-id="32a81-527">Robust Session Connectivity</span></span>

<span data-ttu-id="32a81-528">Windows PowerShell 3.0 可检测到客户端和服务器之间的意外连接损失，然后自动尝试重新建立连接并恢复执行。</span><span class="sxs-lookup"><span data-stu-id="32a81-528">Windows PowerShell 3.0 detects unexpected losses of connectivity between the client and server and attempts to reestablish connectivity and resume execution automatically.</span></span> <span data-ttu-id="32a81-529">如果无法在分配的时间内重新建立客户端到服务器的连接，则会通知用户并且断开与会话的连接。</span><span class="sxs-lookup"><span data-stu-id="32a81-529">If the client-server connection cannot be reestablished in the allotted time, the user is notified and the session is disconnected.</span></span> <span data-ttu-id="32a81-530">在尝试重新连接期间，Windows PowerShell 将向用户持续提供反馈。</span><span class="sxs-lookup"><span data-stu-id="32a81-530">During the attempt to reconnect, Windows PowerShell provides continuous feedback to the user.</span></span>

<span data-ttu-id="32a81-531">如果已断开连接的会话是通过使用 InvokeCommand 启动的，则 Windows PowerShell 将为已断开连接的会话创建作业，以更加轻松地重新连接并恢复执行。</span><span class="sxs-lookup"><span data-stu-id="32a81-531">If the disconnected session was started by using the InvokeCommand, Windows PowerShell creates a job for the disconnected session to make it easier to reconnect and resume execution.</span></span>

<span data-ttu-id="32a81-532">这些功能提供了更加可靠且更易恢复的远程体验，并允许用户执行需要稳定会话的长期运行的任务，例如工作流。</span><span class="sxs-lookup"><span data-stu-id="32a81-532">These features provide a more reliable and recoverable remoting experience and allow users to perform long-running tasks that require robust sessions, such as workflows.</span></span>

### <a name="updatable-help-system"></a><span data-ttu-id="32a81-533">可更新的帮助系统</span><span class="sxs-lookup"><span data-stu-id="32a81-533">Updatable Help System</span></span>

<span data-ttu-id="32a81-534">现在，你可以为模块中的 cmdlet 下载更新的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-534">You can now download updated help files for the cmdlets in your modules.</span></span> <span data-ttu-id="32a81-535">`Update-Help` cmdlet 发现最新的帮助文件，从 Internet 下载这些文件，解压缩并验证它们，然后将它们安装在模块的特定语言正确目录中。</span><span class="sxs-lookup"><span data-stu-id="32a81-535">The `Update-Help` cmdlet identifies the newest help files, downloads them from the Internet, unpacks them, validates them, and installs them in the correct language-specific directory for the module.</span></span>

<span data-ttu-id="32a81-536">若要使用更新的帮助文件，只需键入 `Get-Help`。</span><span class="sxs-lookup"><span data-stu-id="32a81-536">To use the updated help files, just type `Get-Help`.</span></span> <span data-ttu-id="32a81-537">你无需重启 Windows 或 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="32a81-537">You do not need to restart Windows or Windows PowerShell.</span></span> <span data-ttu-id="32a81-538">若要为 $pshome 目录中的模块更新帮助，请使用“以管理员身份运行”选项启动 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="32a81-538">To update help for modules in the $pshome directory, start Windows PowerShell with the "Run as administrator" option.</span></span>

<span data-ttu-id="32a81-539">为了支持没有连接到 Internet 的用户和防火墙后的用户，新 `Save-Help` cmdlet 将帮助文件下载到文件系统目录（如文件共享）中。</span><span class="sxs-lookup"><span data-stu-id="32a81-539">To support users who don't have Internet access and users behind firewalls, the new `Save-Help` cmdlet downloads help files to a file system directory, such as a file share.</span></span> <span data-ttu-id="32a81-540">然后，用户可以使用 `Update-Help` cmdlet 从文件共享中获取更新后的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-540">Users can then use the `Update-Help` cmdlet to get updated help files from the file share.</span></span>

<span data-ttu-id="32a81-541">使用 `Update-Help` cmdlet，可以更新所有受支持 UI 区域性中全部或特定模块的帮助文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-541">You can use the `Update-Help` cmdlet to update help files for all or particular modules in all supported UI cultures.</span></span> <span data-ttu-id="32a81-542">甚至可以将 `Update-Help` 命令置于 Windows PowerShell 配置文件中。</span><span class="sxs-lookup"><span data-stu-id="32a81-542">You can even put an `Update-Help` command in your Windows PowerShell profile.</span></span>
<span data-ttu-id="32a81-543">默认情况下，Windows PowerShell 每天下载模块帮助文件的次数不超过一次。</span><span class="sxs-lookup"><span data-stu-id="32a81-543">By default, Windows PowerShell downloads the help files for a module no more than once each day.</span></span>

<span data-ttu-id="32a81-544">Windows 8 和 Windows Server 2012 模块不包含帮助文件。</span><span class="sxs-lookup"><span data-stu-id="32a81-544">Windows 8 and Windows Server 2012 modules do not include help files.</span></span> <span data-ttu-id="32a81-545">若要下载最新的帮助文件，请键入 `Update-Help`。</span><span class="sxs-lookup"><span data-stu-id="32a81-545">To download the latest help files, type `Update-Help`.</span></span> <span data-ttu-id="32a81-546">有关详细信息，请键入 `Get-Help`（不带参数）或请参阅 [about_Updatable_Help](/powershell/module/microsoft.powershell.core/about/about_Updatable_Help)。</span><span class="sxs-lookup"><span data-stu-id="32a81-546">For more information, type `Get-Help` (without parameters) or see [about_Updatable_Help](/powershell/module/microsoft.powershell.core/about/about_Updatable_Help).</span></span>

<span data-ttu-id="32a81-547">如果计算机上未安装 cmdlet 的帮助文件，`Get-Help` cmdlet 现在会显示自动生成的帮助。</span><span class="sxs-lookup"><span data-stu-id="32a81-547">When the help files for a cmdlet are not installed on the computer, the `Get-Help` cmdlet now displays auto-generated help.</span></span> <span data-ttu-id="32a81-548">自动生成的帮助中包含命令语法，以及关于如何使用 `Update-Help` cmdlet 下载帮助文件的说明。</span><span class="sxs-lookup"><span data-stu-id="32a81-548">The auto-generated help includes the command syntax and instructions for using the `Update-Help` cmdlet to download help files.</span></span>

<span data-ttu-id="32a81-549">任何模块作者都可为其模块提供“可更新的帮助”。</span><span class="sxs-lookup"><span data-stu-id="32a81-549">Any module author can support Updatable Help for their module.</span></span> <span data-ttu-id="32a81-550">你可以将帮助文件包含在模块中并使用“可更新的帮助”来更新它们，或忽略帮助文件并使用“可更新的帮助”来安装它们。</span><span class="sxs-lookup"><span data-stu-id="32a81-550">You can include help files in the module and use Updatable Help to update them or omit the help files and use Updatable Help to install them.</span></span> <span data-ttu-id="32a81-551">若要详细了解如何支持“可更新的帮助”，请参阅[支持“可更新的帮助”](/powershell/scripting/developer/module/supporting-updatable-help)。</span><span class="sxs-lookup"><span data-stu-id="32a81-551">For more information about supporting Updatable Help, see [Supporting Updatable Help](/powershell/scripting/developer/module/supporting-updatable-help).</span></span>

### <a name="enhanced-online-help"></a><span data-ttu-id="32a81-552">增强的联机帮助</span><span class="sxs-lookup"><span data-stu-id="32a81-552">Enhanced Online Help</span></span>

<span data-ttu-id="32a81-553">Windows PowerShell 联机帮助是面向所有用户的宝贵资源，但对于没有或无法安装更新的帮助文件的用户尤为重要。</span><span class="sxs-lookup"><span data-stu-id="32a81-553">Windows PowerShell online help is a valuable resource for all users, but it is especially important to users who do not or cannot install updated help files.</span></span>

<span data-ttu-id="32a81-554">若要获取任何 Windows PowerShell cmdlet 的联机帮助，请键入：</span><span class="sxs-lookup"><span data-stu-id="32a81-554">To get online help for any Windows PowerShell cmdlet, type:</span></span>

```
Get-Help <cmdlet-name> -Online
```

<span data-ttu-id="32a81-555">Windows PowerShell 在默认 Internet 浏览器中打开帮助主题的联机版本。</span><span class="sxs-lookup"><span data-stu-id="32a81-555">Windows PowerShell opens the online version of the help topic in your default Internet browser.</span></span>

<span data-ttu-id="32a81-556">Windows PowerShell 3.0 中的 **Get-Help -Online** 功能现在更加强大了，因为即使未在计算机上安装 cmdlet 的帮助文件，它也起作用。</span><span class="sxs-lookup"><span data-stu-id="32a81-556">The **Get-Help -Online** feature in Windows PowerShell 3.0 is now even more powerful because it works even when help files for the cmdlet are not installed on the computer.</span></span> <span data-ttu-id="32a81-557">**Get-Help -Online** 功能从 cmdlet 和高级函数的 HelpUri 属性中获取联机帮助主题的 URI。</span><span class="sxs-lookup"><span data-stu-id="32a81-557">The **Get-Help -Online** feature gets the URI for online help topic from the HelpUri property of cmdlets and advanced functions.</span></span>

```
PS C:\>(Get-Command Get-ScheduledJob).HelpUri
https://go.microsoft.com/fwlink/?LinkID=223923
```

<span data-ttu-id="32a81-558">从 Windows PowerShell 3.0 开始，C# cmdlet 的作者可以通过在 cmdlet 类上创建 **HelpUri** 特性来填充 **HelpUri** 属性。</span><span class="sxs-lookup"><span data-stu-id="32a81-558">Beginning in Windows PowerShell 3.0, authors of C# cmdlets can populate the **HelpUri** property by creating a **HelpUri** attribute on the cmdlet class.</span></span> <span data-ttu-id="32a81-559">高级函数的作者可以在 **CmdletBinding** 特性上定义 **HelpUri** 属性。</span><span class="sxs-lookup"><span data-stu-id="32a81-559">Authors of advanced functions can define a **HelpUri** property on the **CmdletBinding** attribute.</span></span> <span data-ttu-id="32a81-560">**HelpUri** 属性的值必须以“http”或“https”开头。</span><span class="sxs-lookup"><span data-stu-id="32a81-560">The value of the **HelpUri** property must begin with "http" or "https".</span></span>

<span data-ttu-id="32a81-561">你也可以将 **HelpUri** 值包含在基于 XML 的 cmdlet 帮助文件的第一个相关链接中，或包含在函数中基于注释的帮助的 .Link 指令中。</span><span class="sxs-lookup"><span data-stu-id="32a81-561">You can also include a **HelpUri** value in the first related link of an XML-based cmdlet help file or the .Link directive of comment-based help in a function.</span></span>

<span data-ttu-id="32a81-562">有关支持联机帮助的详细信息，请参阅 Microsoft Docs 中的[支持联机帮助](/powershell/scripting/developer/module/supporting-online-help)。</span><span class="sxs-lookup"><span data-stu-id="32a81-562">For more information about supporting online help, see [Supporting Online Help](/powershell/scripting/developer/module/supporting-online-help) in the Microsoft Docs.</span></span>

### <a name="cim-integration"></a><span data-ttu-id="32a81-563">CIM 集成</span><span class="sxs-lookup"><span data-stu-id="32a81-563">CIM integration</span></span>

<span data-ttu-id="32a81-564">Windows PowerShell 3.0 中包括对通用信息模型 (CIM) 的支持，CIM 为系统、网络、应用程序和服务提供了管理信息的通用定义，从而允许它们在异类系统之间交换管理信息。</span><span class="sxs-lookup"><span data-stu-id="32a81-564">Windows PowerShell 3.0 includes support for the Common Information Model (CIM), which provides common definitions of management information for systems, networks, applications, and services, allowing them the exchange of management information between heterogeneous systems.</span></span> <span data-ttu-id="32a81-565">Windows PowerShell 3.0 中对 CIM 的支持，包括基于新的或现有的 CIM 类编写 Windows PowerShell cmdlet 的能力、基于 cmdlet 定义 XML 文件编写命令的能力、对 CIM .NET Framework 的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-565">Support for CIM in Windows PowerShell 3.0, including the ability to author Windows PowerShell cmdlets based on new or existing CIM classes, commands based on cmdlet definition XML files, support for CIM .NET Framework.</span></span> <span data-ttu-id="32a81-566">API、CIM 管理 cmdlet 和 WMI 2.0 提供程序。</span><span class="sxs-lookup"><span data-stu-id="32a81-566">API, CIM management cmdlets and WMI 2.0 providers.</span></span>

### <a name="session-configuration-files"></a><span data-ttu-id="32a81-567">会话配置文件</span><span class="sxs-lookup"><span data-stu-id="32a81-567">Session Configuration Files</span></span>

<span data-ttu-id="32a81-568">从 Windows PowerShell 3.0 开始，你可以通过使用文件来设计自定义会话配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-568">Beginning in Windows PowerShell 3.0, you can design a custom session configuration by using a file.</span></span>
<span data-ttu-id="32a81-569">新的会话配置文件使你能够确定使用会话配置的会话环境，包括向会话中加载哪些模块、脚本和格式文件、用户可以使用哪些 cmdlet 和语言元素、可以运行哪些模块和脚本以及可以看到哪些变量。</span><span class="sxs-lookup"><span data-stu-id="32a81-569">The new session configuration file lets you determine the environment of sessions that use the session configuration, including which modules, scripts, and format files are loaded into sessions, which cmdlets and language elements users can use, which modules and scripts they can run, and which variables they can see.</span></span>

<span data-ttu-id="32a81-570">你可以设计用户只能在其中运行来自一个特定模块的 cmdlet 的会话，或用户在其中具有完整的语言、对所有模块的访问权限，以及对可执行高级任务的脚本的访问权限的会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-570">You can design a session in which users can only run the cmdlets from one particular module, or a session in which users have full language, access to all modules, and access to scripts that perform advanced tasks.</span></span>

<span data-ttu-id="32a81-571">在以前版本的 Windows PowerShell 中，仅为那些可以编写 C# 程序或复杂启动脚本的用户提供此级别的控制。</span><span class="sxs-lookup"><span data-stu-id="32a81-571">In previous versions of Windows PowerShell, control at this level was available only to those who could write a C# program or a complex start-up script.</span></span> <span data-ttu-id="32a81-572">现在，计算机上“管理员”组中的任何成员都可以通过使用配置文件来自定义会话配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-572">Now, any member of the Administrators group on the computer can customize a session configuration by using a configuration file.</span></span>

<span data-ttu-id="32a81-573">若要创建会话配置文件，请使用 `New-PSSessionConfigurationFile` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-573">To create a session configuration file, use the `New-PSSessionConfigurationFile` cmdlet.</span></span> <span data-ttu-id="32a81-574">若要将会话配置文件应用于会话配置，请使用 `Register-PSSessionConfiguration` 或 Set-PSSessionConfiguration cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-574">To apply the session configuration file to a session configuration, use the `Register-PSSessionConfiguration` or \`Set-PSSessionConfiguration cmdlets.</span></span>

<span data-ttu-id="32a81-575">有关详细信息，请参阅 [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files) 和 `New-PSSessionConfigurationFile`。</span><span class="sxs-lookup"><span data-stu-id="32a81-575">For more information, see [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configuration_files) and `New-PSSessionConfigurationFile`.</span></span>

### <a name="scheduled-jobs-and-task-scheduler-integration"></a><span data-ttu-id="32a81-576">计划作业和任务计划程序集成</span><span class="sxs-lookup"><span data-stu-id="32a81-576">Scheduled Jobs and Task Scheduler Integration</span></span>

<span data-ttu-id="32a81-577">现在可以计划 Windows PowerShell 后台作业，并在 Windows PowerShell 和任务计划程序中对其进行管理。</span><span class="sxs-lookup"><span data-stu-id="32a81-577">You can now schedule Windows PowerShell background jobs and manage them in Windows PowerShell and in Task Scheduler.</span></span>

<span data-ttu-id="32a81-578">Windows PowerShell 计划作业是 Windows PowerShell 后台作业和“任务计划程序”任务的有用结合。</span><span class="sxs-lookup"><span data-stu-id="32a81-578">Windows PowerShell scheduled jobs are a useful hybrid of Windows PowerShell background jobs and Task Scheduler tasks.</span></span>

<span data-ttu-id="32a81-579">与 Windows PowerShell 后台作业一样，计划作业以异步方式在后台运行。</span><span class="sxs-lookup"><span data-stu-id="32a81-579">Like Windows PowerShell background jobs, scheduled jobs run asynchronously in the background.</span></span>
<span data-ttu-id="32a81-580">可以使用作业 cmdlet（如 `Start-Job` 和 `Get-Job`），管理已完成的计划作业实例。</span><span class="sxs-lookup"><span data-stu-id="32a81-580">Instances of scheduled jobs that have completed can be managed by using the job cmdlets, such as `Start-Job` and `Get-Job`.</span></span>

<span data-ttu-id="32a81-581">与“任务计划程序”任务一样，你可以按一次性或重复计划运行计划作业，或者根据操作或事件运行它们。</span><span class="sxs-lookup"><span data-stu-id="32a81-581">Like Task Scheduler tasks, you can run scheduled jobs on a one-time or recurrent schedule, or in response to an action or event.</span></span> <span data-ttu-id="32a81-582">你可以在“任务计划程序”中查看和管理计划作业、按需启用和禁用它们、将其作为模板运行或使用，并设置启动作业的条件。</span><span class="sxs-lookup"><span data-stu-id="32a81-582">You can view and manage scheduled jobs in Task Scheduler, enable and disable them as needed, run them or use them as templates, and set conditions under which the jobs start.</span></span>

<span data-ttu-id="32a81-583">此外，计划作业还附带用于管理它们的一组自定义 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-583">In addition, scheduled jobs come with a customized set of cmdlets for managing them.</span></span> <span data-ttu-id="32a81-584">这些 cmdlet 使你能够创建、编辑、管理、禁用和重新启用计划作业，创建计划作业触发器并设置计划作业选项。</span><span class="sxs-lookup"><span data-stu-id="32a81-584">The cmdlets let you create, edit, manage, disable, and re-enable scheduled jobs, create scheduled job triggers and set scheduled job options.</span></span>

<span data-ttu-id="32a81-585">有关计划作业的详细信息，请参阅 [about_Scheduled_Jobs](/powershell/module/psscheduledjob/about/about_scheduled_jobs)。</span><span class="sxs-lookup"><span data-stu-id="32a81-585">For more information about scheduled jobs, see [about_Scheduled_Jobs](/powershell/module/psscheduledjob/about/about_scheduled_jobs).</span></span>

### <a name="windows-powershell-language-enhancements"></a><span data-ttu-id="32a81-586">Windows PowerShell 语言增强功能</span><span class="sxs-lookup"><span data-stu-id="32a81-586">Windows PowerShell Language Enhancements</span></span>

<span data-ttu-id="32a81-587">Windows PowerShell 3.0 包括许多功能，旨在使其语言更简单、更易于使用并避免常见错误。</span><span class="sxs-lookup"><span data-stu-id="32a81-587">Windows PowerShell 3.0 includes many features that are designed to make its language simpler, easier to use, and to avoid common errors.</span></span> <span data-ttu-id="32a81-588">改进包括属性枚举、标量对象上的计数和长度属性、新的重定向运算符、$Using 作用域修饰符、PSItem 自动变量、灵活的脚本格式设置、变量特性、简化的特性参数、数字命令名称、停止分析运算符、改进的数组展开、新的位运算符、有序词典、PSCustomObject 强制转换和改进的基于注释的帮助。</span><span class="sxs-lookup"><span data-stu-id="32a81-588">The improvements include property enumeration, count and length properties on scalar objects, new redirection operators, the $Using scope modifier, PSItem automatic variable, flexible script formatting, attributes of variables, simplified attribute arguments, numeric command names, the Stop-Parsing operator, improved array splatting, new bit operators, ordered dictionaries, PSCustomObject casting, and improved comment-based help.</span></span>

### <a name="new-core-cmdlets"></a><span data-ttu-id="32a81-589">新的核心 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="32a81-589">New Core Cmdlets</span></span>

<span data-ttu-id="32a81-590">已向 Windows PowerShell 核心安装添加新的 cmdlet，包括用于管理计划作业、已断开连接的会话、CIM 集成和“可更新的帮助系统”的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-590">New cmdlets were added to the Windows PowerShell Core installation, including cmdlets to manage scheduled jobs, disconnected sessions, CIM integration and the Updatable Help System.</span></span>

- <span data-ttu-id="32a81-591">CimCmdlet</span><span class="sxs-lookup"><span data-stu-id="32a81-591">CimCmdlets</span></span>
  - <span data-ttu-id="32a81-592">Get-CimAssociatedInstance</span><span class="sxs-lookup"><span data-stu-id="32a81-592">Get-CimAssociatedInstance</span></span>
  - <span data-ttu-id="32a81-593">Get-CimClass</span><span class="sxs-lookup"><span data-stu-id="32a81-593">Get-CimClass</span></span>
  - <span data-ttu-id="32a81-594">Get-CimInstance</span><span class="sxs-lookup"><span data-stu-id="32a81-594">Get-CimInstance</span></span>
  - <span data-ttu-id="32a81-595">Get-CimSession</span><span class="sxs-lookup"><span data-stu-id="32a81-595">Get-CimSession</span></span>
  - <span data-ttu-id="32a81-596">Invoke-CimMethod</span><span class="sxs-lookup"><span data-stu-id="32a81-596">Invoke-CimMethod</span></span>
  - <span data-ttu-id="32a81-597">New-CimInstance</span><span class="sxs-lookup"><span data-stu-id="32a81-597">New-CimInstance</span></span>
  - <span data-ttu-id="32a81-598">New-CimSession</span><span class="sxs-lookup"><span data-stu-id="32a81-598">New-CimSession</span></span>
  - <span data-ttu-id="32a81-599">New-CimSessionOption</span><span class="sxs-lookup"><span data-stu-id="32a81-599">New-CimSessionOption</span></span>
  - <span data-ttu-id="32a81-600">Register-CimIndicationEvent</span><span class="sxs-lookup"><span data-stu-id="32a81-600">Register-CimIndicationEvent</span></span>
  - <span data-ttu-id="32a81-601">Remove-CimInstance</span><span class="sxs-lookup"><span data-stu-id="32a81-601">Remove-CimInstance</span></span>
  - <span data-ttu-id="32a81-602">Remove-CimSession</span><span class="sxs-lookup"><span data-stu-id="32a81-602">Remove-CimSession</span></span>
  - <span data-ttu-id="32a81-603">Set-CimInstance</span><span class="sxs-lookup"><span data-stu-id="32a81-603">Set-CimInstance</span></span>
- <span data-ttu-id="32a81-604">Microsoft.PowerShell.Core</span><span class="sxs-lookup"><span data-stu-id="32a81-604">Microsoft.PowerShell.Core</span></span>
  - <span data-ttu-id="32a81-605">Connect-PSSession</span><span class="sxs-lookup"><span data-stu-id="32a81-605">Connect-PSSession</span></span>
  - <span data-ttu-id="32a81-606">Disconnect-PSSession</span><span class="sxs-lookup"><span data-stu-id="32a81-606">Disconnect-PSSession</span></span>
  - <span data-ttu-id="32a81-607">New-PSSessionConfigurationFile</span><span class="sxs-lookup"><span data-stu-id="32a81-607">New-PSSessionConfigurationFile</span></span>
  - <span data-ttu-id="32a81-608">New-PSTransportOption</span><span class="sxs-lookup"><span data-stu-id="32a81-608">New-PSTransportOption</span></span>
  - <span data-ttu-id="32a81-609">Receive-PSSession</span><span class="sxs-lookup"><span data-stu-id="32a81-609">Receive-PSSession</span></span>
  - <span data-ttu-id="32a81-610">Resume-Job</span><span class="sxs-lookup"><span data-stu-id="32a81-610">Resume-Job</span></span>
  - <span data-ttu-id="32a81-611">Save-Help</span><span class="sxs-lookup"><span data-stu-id="32a81-611">Save-Help</span></span>
  - <span data-ttu-id="32a81-612">Suspend-Job</span><span class="sxs-lookup"><span data-stu-id="32a81-612">Suspend-Job</span></span>
  - <span data-ttu-id="32a81-613">Test-PSSessionConfigurationFile</span><span class="sxs-lookup"><span data-stu-id="32a81-613">Test-PSSessionConfigurationFile</span></span>
  - <span data-ttu-id="32a81-614">Update-Help</span><span class="sxs-lookup"><span data-stu-id="32a81-614">Update-Help</span></span>
- <span data-ttu-id="32a81-615">Microsoft.PowerShell.Diagnostics</span><span class="sxs-lookup"><span data-stu-id="32a81-615">Microsoft.PowerShell.Diagnostics</span></span>
  - <span data-ttu-id="32a81-616">New-WinEvent</span><span class="sxs-lookup"><span data-stu-id="32a81-616">New-WinEvent</span></span>
- <span data-ttu-id="32a81-617">Microsoft.PowerShell.Management</span><span class="sxs-lookup"><span data-stu-id="32a81-617">Microsoft.PowerShell.Management</span></span>
  - <span data-ttu-id="32a81-618">Get-ControlPanelItem</span><span class="sxs-lookup"><span data-stu-id="32a81-618">Get-ControlPanelItem</span></span>
  - <span data-ttu-id="32a81-619">Rename-Computer</span><span class="sxs-lookup"><span data-stu-id="32a81-619">Rename-Computer</span></span>
  - <span data-ttu-id="32a81-620">Show-ControlPanelItem</span><span class="sxs-lookup"><span data-stu-id="32a81-620">Show-ControlPanelItem</span></span>
- <span data-ttu-id="32a81-621">Microsoft.PowerShell.Utility</span><span class="sxs-lookup"><span data-stu-id="32a81-621">Microsoft.PowerShell.Utility</span></span>
  - <span data-ttu-id="32a81-622">ConvertFrom-Json</span><span class="sxs-lookup"><span data-stu-id="32a81-622">ConvertFrom-Json</span></span>
  - <span data-ttu-id="32a81-623">ConvertTo-Json</span><span class="sxs-lookup"><span data-stu-id="32a81-623">ConvertTo-Json</span></span>
  - <span data-ttu-id="32a81-624">Get-TypeData</span><span class="sxs-lookup"><span data-stu-id="32a81-624">Get-TypeData</span></span>
  - <span data-ttu-id="32a81-625">Invoke-RestMethod</span><span class="sxs-lookup"><span data-stu-id="32a81-625">Invoke-RestMethod</span></span>
  - <span data-ttu-id="32a81-626">Invoke-WebRequest</span><span class="sxs-lookup"><span data-stu-id="32a81-626">Invoke-WebRequest</span></span>
  - <span data-ttu-id="32a81-627">Remove-TypeData</span><span class="sxs-lookup"><span data-stu-id="32a81-627">Remove-TypeData</span></span>
  - <span data-ttu-id="32a81-628">Show-Command</span><span class="sxs-lookup"><span data-stu-id="32a81-628">Show-Command</span></span>
  - <span data-ttu-id="32a81-629">Unblock-File</span><span class="sxs-lookup"><span data-stu-id="32a81-629">Unblock-File</span></span>
- <span data-ttu-id="32a81-630">PSScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-630">PSScheduledJob</span></span>
  - <span data-ttu-id="32a81-631">Add-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-631">Add-JobTrigger</span></span>
  - <span data-ttu-id="32a81-632">Disable-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-632">Disable-JobTrigger</span></span>
  - <span data-ttu-id="32a81-633">Disable-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-633">Disable-ScheduledJob</span></span>
  - <span data-ttu-id="32a81-634">Enable-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-634">Enable-JobTrigger</span></span>
  - <span data-ttu-id="32a81-635">Enable-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-635">Enable-ScheduledJob</span></span>
  - <span data-ttu-id="32a81-636">Get-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-636">Get-JobTrigger</span></span>
  - <span data-ttu-id="32a81-637">Get-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-637">Get-ScheduledJob</span></span>
  - <span data-ttu-id="32a81-638">Get-ScheduledJobOption</span><span class="sxs-lookup"><span data-stu-id="32a81-638">Get-ScheduledJobOption</span></span>
  - <span data-ttu-id="32a81-639">New-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-639">New-JobTrigger</span></span>
  - <span data-ttu-id="32a81-640">New-ScheduledJobOption</span><span class="sxs-lookup"><span data-stu-id="32a81-640">New-ScheduledJobOption</span></span>
  - <span data-ttu-id="32a81-641">Register-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-641">Register-ScheduledJob</span></span>
  - <span data-ttu-id="32a81-642">Set-JobTrigger</span><span class="sxs-lookup"><span data-stu-id="32a81-642">Set-JobTrigger</span></span>
  - <span data-ttu-id="32a81-643">Set-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-643">Set-ScheduledJob</span></span>
  - <span data-ttu-id="32a81-644">Set-ScheduledJobOption</span><span class="sxs-lookup"><span data-stu-id="32a81-644">Set-ScheduledJobOption</span></span>
  - <span data-ttu-id="32a81-645">Unregister-ScheduledJob</span><span class="sxs-lookup"><span data-stu-id="32a81-645">Unregister-ScheduledJob</span></span>
- <span data-ttu-id="32a81-646">PSWorkflow</span><span class="sxs-lookup"><span data-stu-id="32a81-646">PSWorkflow</span></span>
  - <span data-ttu-id="32a81-647">New-PSWorkflowExecutionOption</span><span class="sxs-lookup"><span data-stu-id="32a81-647">New-PSWorkflowExecutionOption</span></span>
  - <span data-ttu-id="32a81-648">New-PSWorkflowSession</span><span class="sxs-lookup"><span data-stu-id="32a81-648">New-PSWorkflowSession</span></span>
- <span data-ttu-id="32a81-649">PSWorkflowUtility</span><span class="sxs-lookup"><span data-stu-id="32a81-649">PSWorkflowUtility</span></span>
  - <span data-ttu-id="32a81-650">Invoke-AsWorkflow</span><span class="sxs-lookup"><span data-stu-id="32a81-650">Invoke-AsWorkflow</span></span>
- <span data-ttu-id="32a81-651">ISE</span><span class="sxs-lookup"><span data-stu-id="32a81-651">ISE</span></span>
  - <span data-ttu-id="32a81-652">Get-IseSnippet</span><span class="sxs-lookup"><span data-stu-id="32a81-652">Get-IseSnippet</span></span>
  - <span data-ttu-id="32a81-653">Import-IseSnippet</span><span class="sxs-lookup"><span data-stu-id="32a81-653">Import-IseSnippet</span></span>
  - <span data-ttu-id="32a81-654">New-IseSnippet</span><span class="sxs-lookup"><span data-stu-id="32a81-654">New-IseSnippet</span></span>

### <a name="improvements-to-existing-core-cmdlets-and-providers"></a><span data-ttu-id="32a81-655">对现有核心 Cmdlet 和提供程序的改进</span><span class="sxs-lookup"><span data-stu-id="32a81-655">Improvements to Existing Core Cmdlets and Providers</span></span>

<span data-ttu-id="32a81-656">Windows PowerShell 3.0 中包括已有 cmdlet（包括简化的语法）的新增功能以及以下 cmdlet 的新参数：Computer cmdlet、CSV cmdlet、Get-ChildItem、Get-Command、Get-Content、Get-History、Measure-Object、Security cmdlet、Select-Object、Select-String、Split-Path、Start-Process、Tee-Object、Test-Connection、Add-Member 和 WMI cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-656">Windows PowerShell 3.0 includes new features for existing cmdlets including the simplified syntax, and new parameters for the following cmdlets: Computer cmdlets, CSV cmdlets, Get-ChildItem, Get-Command, Get-Content, Get-History, Measure-Object, Security cmdlets, Select-Object, Select-String, Split-Path, Start-Process, Tee-Object, Test-Connection, Add-Member, and WMI cmdlets.</span></span>

<span data-ttu-id="32a81-657">Windows PowerShell 提供程序也已得到明显改进，包括 Certificate 提供程序对管理用于 Web 托管的安全套接字层 (SSL) 证书的支持，对凭据、永久性网络驱动器以及文件系统驱动器中的备用数据流的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-657">The Windows PowerShell providers were also improved significantly, including Certificate provider support for managing Secure Socket Layer (SSL) certificates for web hosting, support for credential, persistent network drives, and alternate data streams in file system drives.</span></span>

### <a name="remote-module-import-and-discovery"></a><span data-ttu-id="32a81-658">远程模块导入和发现</span><span class="sxs-lookup"><span data-stu-id="32a81-658">Remote module import and discovery</span></span>

<span data-ttu-id="32a81-659">Windows PowerShell 3.0 扩展了远程计算机上的模块发现、导入和隐式远程功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-659">Windows PowerShell 3.0 extends module discovery, importing, and implicit remoting capabilities on remote computers.</span></span> <span data-ttu-id="32a81-660">Module cmdlet 可通过使用 Windows PowerShell 远程处理获取远程计算机上的模块，并将其导入到远程或本地计算机中。</span><span class="sxs-lookup"><span data-stu-id="32a81-660">The Module cmdlets get modules on remote computers and import the modules to the remote or local computer by using Windows PowerShell remoting.</span></span> <span data-ttu-id="32a81-661">通过将在远程计算机上隐式运行的命令导入到本地计算机中，新的 CIM 会话支持使你能够使用 CIM 和 WMI 来管理非 Windows 计算机。</span><span class="sxs-lookup"><span data-stu-id="32a81-661">New CIM session support allows you to use CIM and WMI to manage non-Windows computers by importing commands to the local computer that run implicitly on the remote computer.</span></span>

<span data-ttu-id="32a81-662">有关详细信息，请参阅 `Get-Module` 和 `Import-Module` cmdlet 的帮助主题。</span><span class="sxs-lookup"><span data-stu-id="32a81-662">For more information, see the help topics for the `Get-Module` and `Import-Module` cmdlets.</span></span>

### <a name="enhanced-tab-completion"></a><span data-ttu-id="32a81-663">增强的 Tab 自动补全</span><span class="sxs-lookup"><span data-stu-id="32a81-663">Enhanced Tab Completion</span></span>

<span data-ttu-id="32a81-664">Windows PowerShell 控制台中的 Tab 自动补全现在可以自动补全 cmdlet 的名称、参数、参数值、枚举、.NET Frameworks 类型、COM 对象、隐藏的目录等等。</span><span class="sxs-lookup"><span data-stu-id="32a81-664">Tab completion in the Windows PowerShell console now completes the names of cmdlets, parameters, parameter values, enumerations, .NET Frameworks types, COM objects, hidden directories, and more.</span></span>
<span data-ttu-id="32a81-665">Tab 自动补全功能是基于新的分析程序和抽象语法树彻底重写的，旨在支持更多方案，包括内存中的分析树和中间部分 Tab 自动补全。</span><span class="sxs-lookup"><span data-stu-id="32a81-665">The tab completion feature is completely rewritten based on a new parser and abstract syntax tree to support more scenarios, including in-memory parsing trees and midline tab completion.</span></span>

### <a name="module-auto-loading"></a><span data-ttu-id="32a81-666">模块自动加载</span><span class="sxs-lookup"><span data-stu-id="32a81-666">Module Auto-Loading</span></span>

<span data-ttu-id="32a81-667">`Get-Command` cmdlet 现在从计算机上安装的所有模块中获取全部 cmdlet 和函数，即使模块未导入到当前会话中，也不例外。</span><span class="sxs-lookup"><span data-stu-id="32a81-667">The `Get-Command` cmdlet now gets all cmdlets and functions from all modules that are installed on the computer, even if the module is not imported into the current session.</span></span>

<span data-ttu-id="32a81-668">当你获得所需的 cmdlet 时，可以在不导入任何模块的情况下立即使用它。</span><span class="sxs-lookup"><span data-stu-id="32a81-668">When you get the cmdlet that you need, you can use it immediately without importing any modules.</span></span>
<span data-ttu-id="32a81-669">现在，当你使用模块中的任何 cmdlet 时，Windows PowerShell 模块都会自动导入。</span><span class="sxs-lookup"><span data-stu-id="32a81-669">Windows PowerShell modules are now imported automatically when you use any cmdlet in the module.</span></span> <span data-ttu-id="32a81-670">不再需要搜索模块并将其导入即可使用其 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-670">You no longer need to search for the module and import it to use its cmdlets.</span></span>

<span data-ttu-id="32a81-671">自动导入模块是通过在命令中使用 cmdlet 触发的，即对没有通配符的 cmdlet 运行 `Get-Command` 或 `Get-Help`。</span><span class="sxs-lookup"><span data-stu-id="32a81-671">Automatic importing of modules is triggered by using the cmdlet in a command, running `Get-Command` for a cmdlet without wildcards, or running `Get-Help` for a cmdlet without wildcards.</span></span>

<span data-ttu-id="32a81-672">可以通过使用 **$PSModuleAutoLoadingPreference** 首选项变量来启用、禁用和配置模块的自动导入。</span><span class="sxs-lookup"><span data-stu-id="32a81-672">You can enable, disable, and configure automatic importing of modules by using the **$PSModuleAutoLoadingPreference** preference variable.</span></span>

<span data-ttu-id="32a81-673">有关详细信息，请参阅 [about_Modules](/powershell/module/microsoft.powershell.core/about/about_modules)、[about_Preference_Variables](/powershell/module/microsoft.powershell.core/about/about_Preference_Variables)，以及 `Get-Command` 和 `Import-Module` cmdlet 的帮助主题。</span><span class="sxs-lookup"><span data-stu-id="32a81-673">For more information, see [about_Modules](/powershell/module/microsoft.powershell.core/about/about_modules), [about_Preference_Variables](/powershell/module/microsoft.powershell.core/about/about_Preference_Variables), and the help topics for the `Get-Command` and `Import-Module` cmdlets.</span></span>

### <a name="module-experience-improvements"></a><span data-ttu-id="32a81-674">模块体验改进</span><span class="sxs-lookup"><span data-stu-id="32a81-674">Module Experience Improvements</span></span>

<span data-ttu-id="32a81-675">Windows PowerShell 3.0 将高级功能支持引入了模块，包括以下新增功能。</span><span class="sxs-lookup"><span data-stu-id="32a81-675">Windows PowerShell 3.0 brings advanced feature support to modules, including the following new features.</span></span>

1. <span data-ttu-id="32a81-676">各个模块的模块日志记录 (LogPipelineExecutionDetails) 和新的“打开模块日志记录”组策略设置</span><span class="sxs-lookup"><span data-stu-id="32a81-676">Module logging for individual modules (LogPipelineExecutionDetails) and the new "Turn on Module Logging" Group Policy setting</span></span>
2. <span data-ttu-id="32a81-677">扩展了可公开模块清单中的值的模块对象</span><span class="sxs-lookup"><span data-stu-id="32a81-677">Extended module objects that expose the values from the module manifest</span></span>
3. <span data-ttu-id="32a81-678">新增了模块（包括嵌套模块）的 **ExportedCommands** 属性，该属性合并了所有类型的命令</span><span class="sxs-lookup"><span data-stu-id="32a81-678">New **ExportedCommands** property of modules, including nested modules, that combines commands of all types</span></span>
4. <span data-ttu-id="32a81-679">改进了可用（未导入）模块的发现，包括允许 **Path** 和 **ListAvailable** 参数位于同一命令中</span><span class="sxs-lookup"><span data-stu-id="32a81-679">Improved discovery of available (un-imported) modules, including allowing the **Path** and **ListAvailable** parameters in the same command</span></span>
5. <span data-ttu-id="32a81-680">在模块清单中新增了 **DefaultCommandPrefix** 项，可在不更改模块代码的情况下避免名称冲突。</span><span class="sxs-lookup"><span data-stu-id="32a81-680">New **DefaultCommandPrefix** key in module manifests that avoids name conflicts without changing module code.</span></span>
6. <span data-ttu-id="32a81-681">改进了模块要求，包括附带版本和 GUID 的完全限定的所需模块和所需模块的自动导入</span><span class="sxs-lookup"><span data-stu-id="32a81-681">Improved module requirements, including fully-qualified required modules with version and GUID and automatic importing of required modules</span></span>
7. <span data-ttu-id="32a81-682">更安静、更流畅地操作 `New-ModuleManifest` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-682">Quieter, streamlined operation of the `New-ModuleManifest` cmdlet.</span></span>
8. <span data-ttu-id="32a81-683">为 #Requires 新增了 **Module** 参数</span><span class="sxs-lookup"><span data-stu-id="32a81-683">New **Module** parameter for #Requires</span></span>
9. <span data-ttu-id="32a81-684">改进了包含 MinimumVersion  和 RequiredVersion  参数的 `Import-Module` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-684">Improved `Import-Module` cmdlet with both **MinimumVersion** and **RequiredVersion** parameters.</span></span>

### <a name="simplified-command-discovery"></a><span data-ttu-id="32a81-685">简化的命令发现</span><span class="sxs-lookup"><span data-stu-id="32a81-685">Simplified Command Discovery</span></span>

<span data-ttu-id="32a81-686">你不再需要导入所有模块即可发现可用于会话的命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-686">You no longer need to import all modules to discover the commands available to your session.</span></span> <span data-ttu-id="32a81-687">在 Windows PowerShell 3.0 中，`Get-Command` cmdlet 从所有已安装的模块中获取全部命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-687">In Windows PowerShell 3.0, the `Get-Command` cmdlet gets all commands from all installed modules.</span></span> <span data-ttu-id="32a81-688">而且，如果你使用了某个命令，则导出该命令的模块会自动导入到你的会话中。</span><span class="sxs-lookup"><span data-stu-id="32a81-688">And, if you use a command, the module that exports the command is automatically imported into your session.</span></span>

<span data-ttu-id="32a81-689">新 `Show-Command` cmdlet 是专门为新手设计的。</span><span class="sxs-lookup"><span data-stu-id="32a81-689">The new `Show-Command` cmdlet is designed especially for beginners.</span></span> <span data-ttu-id="32a81-690">你可以在窗口中搜索命令。</span><span class="sxs-lookup"><span data-stu-id="32a81-690">You can search for commands in a window.</span></span> <span data-ttu-id="32a81-691">你可以查看所有命令或按模块筛选、通过单击按钮导入模块、使用文本框和下拉列表来构造一个有效命令，然后复制或运行该命令，而无需离开窗口。</span><span class="sxs-lookup"><span data-stu-id="32a81-691">You can view all commands or filter by module, import a module by clicking a button, use text boxes and drop-down lists to construct a valid command, and then copy or run the command without ever leaving the window.</span></span>

### <a name="improved-logging-diagnostics-and-group-policy-support"></a><span data-ttu-id="32a81-692">改进的日志记录、诊断和组策略支持</span><span class="sxs-lookup"><span data-stu-id="32a81-692">Improved Logging, Diagnostics, and Group Policy Support</span></span>

<span data-ttu-id="32a81-693">借助对 Windows 事件跟踪 (ETW) 日志、模块中可编辑的 **LogPipelineExecutionDetails** 属性和“打开模块日志记录”组策略设置的支持，Windows PowerShell 3.0 改进了对命令和模块的日志记录和跟踪支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-693">Windows PowerShell 3.0 improves the logging and tracing support for commands and modules with support for Event Tracing in Windows (ETW) logs, an editable **LogPipelineExecutionDetails** property of modules, and the "Turn on Module Logging" Group Policy setting.</span></span> <span data-ttu-id="32a81-694">你现在可以通过显示日志属性从日志详细信息中获取参数值。</span><span class="sxs-lookup"><span data-stu-id="32a81-694">You can now get parameter values from log details by displaying the log properties.</span></span>

### <a name="formatting-and-output-improvements"></a><span data-ttu-id="32a81-695">格式设置和输出改进</span><span class="sxs-lookup"><span data-stu-id="32a81-695">Formatting and Output Improvements</span></span>

<span data-ttu-id="32a81-696">新的格式设置和输出改进提高了所有 Windows PowerShell 用户的效率。</span><span class="sxs-lookup"><span data-stu-id="32a81-696">New formatting and output improvements improve the efficiency of all Windows PowerShell users.</span></span> <span data-ttu-id="32a81-697">这些改进包括所有流的输出重定向、增强的 Update-Type cmdlet（可动态地添加类型而无需使用 Format.ps1xml 文件）、在输出中自动换行、自定义对象的默认格式设置属性、 **PSCustomObject** 类型、WMI 对象和异类对象的改进的格式设置，以及对发现方法重载的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-697">The improvements include output redirection for all streams, an enhanced Update-Type cmdlet that adds types dynamically without Format.ps1xml files, word wrap in output, default formatting properties of custom objects, the **PSCustomObject** type, improved formatting for WMI objects and heterogeneous objects, and support for discovering method overloads.</span></span>

### <a name="enhanced-console-host-experience"></a><span data-ttu-id="32a81-698">增强的控制台主机体验</span><span class="sxs-lookup"><span data-stu-id="32a81-698">Enhanced Console Host Experience</span></span>

<span data-ttu-id="32a81-699">在 Windows PowerShell 3.0 中，Windows PowerShell 控制台主机程序具有一些新增功能，其中默认包括单线程单元。</span><span class="sxs-lookup"><span data-stu-id="32a81-699">The Windows PowerShell console host program has new features in Windows PowerShell 3.0 including single threaded apartment by default.</span></span> <span data-ttu-id="32a81-700">通过“文件资源管理器”中的新“使用 PowerShell 运行”选项，你只需通过右键单击即可在不受限制的会话中运行脚本。</span><span class="sxs-lookup"><span data-stu-id="32a81-700">The new "Run with PowerShell" option in File Explorer lets you run scripts in a unrestricted session just by right-clicking.</span></span> <span data-ttu-id="32a81-701">新的控制台主机启动逻辑可更快地启动 Windows PowerShell，而且你可以使用新的字体个性化旧的控制台窗口体验。</span><span class="sxs-lookup"><span data-stu-id="32a81-701">New console host launch logic starts Windows PowerShell faster and new fonts allow you to personalize the familiar console window experience.</span></span>

### <a name="new-cmdlet-and-hosting-apis"></a><span data-ttu-id="32a81-702">新的 Cmdlet 和宿主 API</span><span class="sxs-lookup"><span data-stu-id="32a81-702">New Cmdlet and Hosting APIs</span></span>

<span data-ttu-id="32a81-703">新的 Cmdlet API 和宿主 API 包括公用高级语法树 (AST) API、管道分页 API、嵌套管道、运行空间池 Tab 自动补全、Windows RT、cmdlet 特性 Obsolete 以及 FunctionInfo 对象的 Verb 和 Noun 属性。</span><span class="sxs-lookup"><span data-stu-id="32a81-703">The new Cmdlet API and Hosting API include public advanced syntax tree (AST) APIs, and APIs for pipeline paging, nested pipelines, runspace pools tab completion, Windows RT, the Obsolete cmdlet attribute, and Verb and Noun properties of the FunctionInfo object.</span></span>

### <a name="performance-improvements"></a><span data-ttu-id="32a81-704">性能改进</span><span class="sxs-lookup"><span data-stu-id="32a81-704">Performance Improvements</span></span>

<span data-ttu-id="32a81-705">Windows PowerShell 中的显著性能改进来自于新的语言分析程序（它是在 .NET Framework 4 中的动态语言运行时 (DLR) 基础之上构建而成），以及运行时脚本编译、引擎可靠性提升和 `Get-ChildItem` 算法更改（提升了自身性能，尤其是在搜索网络共享时）。</span><span class="sxs-lookup"><span data-stu-id="32a81-705">Significant performance improvements in Windows PowerShell come from the new language parser, which is built on Dynamic Runtime Language (DLR) in .NET Framework 4., along with runtime script compilation, engine reliability improvements, and changes to the algorithm of the `Get-ChildItem` that improve its performance, especially when searching network shares.</span></span>

### <a name="runas-and-shared-host-support"></a><span data-ttu-id="32a81-706">运行身份和共享主机支持</span><span class="sxs-lookup"><span data-stu-id="32a81-706">RunAs and Shared Host Support</span></span>

<span data-ttu-id="32a81-707">Windows PowerShell 3.0 包括对运行身份和共享主机功能的支持。</span><span class="sxs-lookup"><span data-stu-id="32a81-707">Windows PowerShell 3.0 includes support for RunAs and Shared Host features.</span></span>

<span data-ttu-id="32a81-708">*运行身份* 功能专用于 Windows PowerShell 工作流，使会话配置用户可以创建使用共享用户帐户的权限运行的会话。</span><span class="sxs-lookup"><span data-stu-id="32a81-708">The *RunAs* feature, designed for Windows PowerShell Workflow, lets users of a session configuration create sessions that run with the permission of a shared user account.</span></span> <span data-ttu-id="32a81-709">这使权限较低的用户能够使用管理员权限来运行特定命令和脚本，而无需将太多较为低级的用户添加到“管理员”组。</span><span class="sxs-lookup"><span data-stu-id="32a81-709">This enables less privileged users to run particular commands and scripts with administrator permissions, and reduces the need for adding less senior users to the Administrators group.</span></span>

<span data-ttu-id="32a81-710">**SharedHost** 功能允许多台计算机上的多个用户同时连接到工作流会话并监视工作流进度。</span><span class="sxs-lookup"><span data-stu-id="32a81-710">The **SharedHost** feature allows multiple users on multiple computers to connect to a workflow session concurrently and monitor the progress of a workflow.</span></span> <span data-ttu-id="32a81-711">用户可以在一台计算机上启动工作流，然后连接到另一台计算机上的工作流会话，而无需断开会话与原始计算机的连接。</span><span class="sxs-lookup"><span data-stu-id="32a81-711">Users can start a workflow on one computer and then connect to the workflow session on another computer without disconnecting the session from the original computer.</span></span> <span data-ttu-id="32a81-712">用户必须具有相同的权限，并且必须使用相同的会话配置。</span><span class="sxs-lookup"><span data-stu-id="32a81-712">Users must have the same permissions and be using the same session configuration.</span></span> <span data-ttu-id="32a81-713">有关详细信息，请参阅 Windows PowerShell 工作流入门中的“运行 Windows PowerShell 工作流”。</span><span class="sxs-lookup"><span data-stu-id="32a81-713">For more information, see "Running a Windows PowerShell Workflow" in Getting Started with Windows PowerShell Workflow.</span></span>

### <a name="special-character-handling-improvements"></a><span data-ttu-id="32a81-714">特殊字符处理改进</span><span class="sxs-lookup"><span data-stu-id="32a81-714">Special Character Handling Improvements</span></span>

<span data-ttu-id="32a81-715">为了提高 Windows PowerShell 3.0 解释和正确处理特殊字符的能力，用于处理路径中特殊字符的 LiteralPath  参数几乎对包含 Path  参数的所有 cmdlet 都有效，包括新增的 `Update-Help` 和 `Save-Help` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="32a81-715">To improve the ability of Windows PowerShell 3.0 to interpret and correctly handle special characters, the **LiteralPath** parameter, which handles special characters in paths, is valid on almost all cmdlets that have a **Path** parameter, including the new `Update-Help` and `Save-Help` cmdlets.</span></span> <span data-ttu-id="32a81-716">分析程序中还包括了特殊逻辑，用于改进对文件名和路径中的反撇号字符 (\`) 和方括号的处理。</span><span class="sxs-lookup"><span data-stu-id="32a81-716">The parser also includes special logic to improve handling of the backtick character (\`) and square brackets in file names and paths.</span></span>

## <a name="see-also"></a><span data-ttu-id="32a81-717">另请参阅</span><span class="sxs-lookup"><span data-stu-id="32a81-717">See Also</span></span>

- [<span data-ttu-id="32a81-718">about_Windows_PowerShell_5.0</span><span class="sxs-lookup"><span data-stu-id="32a81-718">about_Windows_PowerShell_5.0</span></span>](/previous-versions/powershell/module/microsoft.powershell.core/about/about_windows_powershell_5.0)
- [<span data-ttu-id="32a81-719">Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="32a81-719">Windows PowerShell</span></span>](/powershell/)
