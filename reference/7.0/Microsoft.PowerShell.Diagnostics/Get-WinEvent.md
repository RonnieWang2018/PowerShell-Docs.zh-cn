---
external help file: Microsoft.PowerShell.Commands.Diagnostics.dll-Help.xml
keywords: powershell,cmdlet
Locale: en-US
Module Name: Microsoft.PowerShell.Diagnostics
ms.date: 11/20/2019
online version: https://docs.microsoft.com/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7&WT.mc_id=ps-gethelp
schema: 2.0.0
title: Get-WinEvent
ms.openlocfilehash: a35fe7d46773f8d20ed0ca40ea856a0e9619a2b5
ms.sourcegitcommit: de63e9481cf8024883060aae61fb02c59c2de662
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/03/2020
ms.locfileid: "93196886"
---
# <span data-ttu-id="aa86e-103">Get-WinEvent</span><span class="sxs-lookup"><span data-stu-id="aa86e-103">Get-WinEvent</span></span>

## <span data-ttu-id="aa86e-104">摘要</span><span class="sxs-lookup"><span data-stu-id="aa86e-104">SYNOPSIS</span></span>
<span data-ttu-id="aa86e-105">获取本地和远程计算机上的事件日志和事件跟踪日志文件中的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-105">Gets events from event logs and event tracing log files on local and remote computers.</span></span>

## <span data-ttu-id="aa86e-106">SYNTAX</span><span class="sxs-lookup"><span data-stu-id="aa86e-106">SYNTAX</span></span>

### <span data-ttu-id="aa86e-107">GetLogSet（默认值）</span><span class="sxs-lookup"><span data-stu-id="aa86e-107">GetLogSet (Default)</span></span>

```
Get-WinEvent [[-LogName] <String[]>] [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="aa86e-108">ListLogSet</span><span class="sxs-lookup"><span data-stu-id="aa86e-108">ListLogSet</span></span>

```
Get-WinEvent [-ListLog] <String[]> [-ComputerName <String>] [-Credential <PSCredential>] [-Force]
 [<CommonParameters>]
```

### <span data-ttu-id="aa86e-109">ListProviderSet</span><span class="sxs-lookup"><span data-stu-id="aa86e-109">ListProviderSet</span></span>

```
Get-WinEvent [-ListProvider] <String[]> [-ComputerName <String>] [-Credential <PSCredential>]
 [<CommonParameters>]
```

### <span data-ttu-id="aa86e-110">GetProviderSet</span><span class="sxs-lookup"><span data-stu-id="aa86e-110">GetProviderSet</span></span>

```
Get-WinEvent [-ProviderName] <String[]> [-MaxEvents <Int64>] [-ComputerName <String>]
 [-Credential <PSCredential>] [-FilterXPath <String>] [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="aa86e-111">FileSet</span><span class="sxs-lookup"><span data-stu-id="aa86e-111">FileSet</span></span>

```
Get-WinEvent [-Path] <String[]> [-MaxEvents <Int64>] [-Credential <PSCredential>]
 [-FilterXPath <String>] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="aa86e-112">HashQuerySet</span><span class="sxs-lookup"><span data-stu-id="aa86e-112">HashQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterHashtable] <Hashtable[]> [-Force] [-Oldest] [<CommonParameters>]
```

### <span data-ttu-id="aa86e-113">XmlQuerySet</span><span class="sxs-lookup"><span data-stu-id="aa86e-113">XmlQuerySet</span></span>

```
Get-WinEvent [-MaxEvents <Int64>] [-ComputerName <String>] [-Credential <PSCredential>]
 [-FilterXml] <XmlDocument> [-Oldest] [<CommonParameters>]
```

## <span data-ttu-id="aa86e-114">DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="aa86e-114">DESCRIPTION</span></span>

<span data-ttu-id="aa86e-115">该 `Get-WinEvent` cmdlet 将从事件日志中获取事件，包括经典日志，例如 **系统** 和 **应用程序** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-115">The `Get-WinEvent` cmdlet gets events from event logs, including classic logs, such as the **System** and **Application** logs.</span></span> <span data-ttu-id="aa86e-116">该 cmdlet 将从 Windows Vista 中引入的 Windows 事件日志技术生成的事件日志中获取数据。</span><span class="sxs-lookup"><span data-stu-id="aa86e-116">The cmdlet gets data from event logs that are generated by the Windows Event Log technology introduced in Windows Vista.</span></span> <span data-ttu-id="aa86e-117">日志文件中的事件和 **Windows (ETW) 的事件跟踪** 生成的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-117">And, events in log files generated by **Event Tracing for Windows (ETW)** .</span></span> <span data-ttu-id="aa86e-118">默认情况下，按 `Get-WinEvent` 从最新到最旧的顺序返回事件信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-118">By default, `Get-WinEvent` returns event information in the order of newest to oldest.</span></span>

<span data-ttu-id="aa86e-119">`Get-WinEvent` 列出事件日志和事件日志提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-119">`Get-WinEvent` lists event logs and event log providers.</span></span> <span data-ttu-id="aa86e-120">若要中断该命令，请按<kbd>CTRL</kbd> + <kbd>C</kbd>。</span><span class="sxs-lookup"><span data-stu-id="aa86e-120">To interrupt the command, press <kbd>CTRL</kbd>+<kbd>C</kbd>.</span></span> <span data-ttu-id="aa86e-121">可以从所选的日志或从所选的事件提供程序生成的日志中获取事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-121">You can get events from selected logs or from logs generated by selected event providers.</span></span> <span data-ttu-id="aa86e-122">还可以将来自多个源的事件组合到单个命令中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-122">And, you can combine events from multiple sources in a single command.</span></span>
<span data-ttu-id="aa86e-123">`Get-WinEvent` 允许使用 XPath 查询、结构化 XML 查询和哈希表查询来筛选事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-123">`Get-WinEvent` allows you to filter events using XPath queries, structured XML queries, and hash table queries.</span></span>

<span data-ttu-id="aa86e-124">如果你未以管理员身份运行 PowerShell，你可能会看到错误消息，指出无法检索有关日志的信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-124">If you're not running PowerShell as an Administrator, you might see error messages that you cannot retrieve information about a log.</span></span>

## <span data-ttu-id="aa86e-125">示例</span><span class="sxs-lookup"><span data-stu-id="aa86e-125">EXAMPLES</span></span>

### <span data-ttu-id="aa86e-126">示例1：从本地计算机获取所有日志</span><span class="sxs-lookup"><span data-stu-id="aa86e-126">Example 1: Get all the logs from a local computer</span></span>

<span data-ttu-id="aa86e-127">此命令获取本地计算机上的所有事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-127">This command gets all the event logs on the local computer.</span></span> <span data-ttu-id="aa86e-128">日志按获取顺序列出 `Get-WinEvent` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-128">Logs are listed in the order that `Get-WinEvent` gets them.</span></span> <span data-ttu-id="aa86e-129">先检索传统日志，然后再检索新的 Windows 事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-129">Classic logs are retrieved first, followed by the new Windows Event logs.</span></span>
<span data-ttu-id="aa86e-130">日志的 **RecordCount** 可以为空，也可以为零。</span><span class="sxs-lookup"><span data-stu-id="aa86e-130">It's possible for a log's **RecordCount** to be null, which is blank, or zero.</span></span>

```powershell
Get-WinEvent -ListLog *
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14500 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        3015 CxAudioSvcLog
Circular            20971520             ForwardedEvents
Circular            20971520           0 HardwareEvents
```

<span data-ttu-id="aa86e-131">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-131">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-132">**ListLog** 参数使用) 通配符 (星号 `*` 来显示有关每个日志的信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-132">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span>

### <span data-ttu-id="aa86e-133">示例2：获取经典安装日志</span><span class="sxs-lookup"><span data-stu-id="aa86e-133">Example 2: Get the classic Setup log</span></span>

<span data-ttu-id="aa86e-134">此命令将获取一个 **system.diagnostics.eventing.reader.eventlogconfiguration** 对象，该对象表示经典 **安装** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-134">This command gets an **EventLogConfiguration** object that represents the classic **Setup** log.</span></span> <span data-ttu-id="aa86e-135">对象包含有关日志的信息，如文件大小、提供程序、文件路径以及是否已启用日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-135">The object includes information about the log, such as file size, provider, file path, and whether the log is enabled.</span></span>

```powershell
Get-WinEvent -ListLog Setup | Format-List -Property *
```

```Output
FileSize                       : 69632
IsLogFull                      : False
LastAccessTime                 : 3/13/2019 09:41:46
LastWriteTime                  : 3/13/2019 09:41:46
OldestRecordNumber             : 1
RecordCount                    : 23
LogName                        : Setup
LogType                        : Operational
LogIsolation                   : Application
IsEnabled                      : True
IsClassicLog                   : False
SecurityDescriptor             : O:BAG:SYD: ...
LogFilePath                    : %SystemRoot%\System32\Winevt\Logs\Setup.evtx
MaximumSizeInBytes             : 1052672
LogMode                        : Circular
OwningProviderName             : Microsoft-Windows-Eventlog
ProviderNames                  : {Microsoft-Windows-WUSA, Microsoft-Windows-ActionQueue...
ProviderLevel                  :
ProviderKeywords               :
ProviderBufferSize             : 64
ProviderMinimumNumberOfBuffers : 0
ProviderMaximumNumberOfBuffers : 64
ProviderLatency                : 1000
ProviderControlGuid            :
```

<span data-ttu-id="aa86e-136">`Get-WinEvent`Cmdlet 使用 **ListLog** 参数来指定 **安装** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-136">The `Get-WinEvent` cmdlet uses the **ListLog** parameter to specify the **Setup** log.</span></span> <span data-ttu-id="aa86e-137">对象通过管道向下发送到 `Format-List` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-137">The object is sent down the pipeline to the `Format-List` cmdlet.</span></span> <span data-ttu-id="aa86e-138">`Format-List` 使用带有星号 () 通配符的 **property** 参数 `*` 来显示每个属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-138">`Format-List` uses the **Property** parameter with the asterisk (`*`) wildcard to display each property.</span></span>

### <span data-ttu-id="aa86e-139">示例3：从服务器获取事件日志</span><span class="sxs-lookup"><span data-stu-id="aa86e-139">Example 3: Get event logs from a server</span></span>

<span data-ttu-id="aa86e-140">此命令仅获取包含事件的本地计算机上的事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-140">This command only gets event logs on the local computer that contain events.</span></span> <span data-ttu-id="aa86e-141">日志的 **RecordCount** 可以为 null 或零。</span><span class="sxs-lookup"><span data-stu-id="aa86e-141">It's possible for a log's **RecordCount** to be null or zero.</span></span> <span data-ttu-id="aa86e-142">该示例使用 `$_` 变量。</span><span class="sxs-lookup"><span data-stu-id="aa86e-142">The example uses the `$_` variable.</span></span> <span data-ttu-id="aa86e-143">有关详细信息，请参阅 [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)。</span><span class="sxs-lookup"><span data-stu-id="aa86e-143">For more information, see [about_Automatic_Variables](../Microsoft.PowerShell.Core/about/about_automatic_variables.md).</span></span>

```powershell
Get-WinEvent -ListLog * -ComputerName localhost | Where-Object { $_.RecordCount }
```

```Output
LogMode   MaximumSizeInBytes RecordCount LogName
-------   ------------------ ----------- -------
Circular            15532032       14546 Application
Circular             1052672         117 Azure Information Protection
Circular             1052672        2990 CxAudioSvcLog
Circular             1052672           9 MSFTVPN Setup
Circular             1052672         282 OAlerts
```

<span data-ttu-id="aa86e-144">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-144">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-145">**ListLog** 参数使用) 通配符 (星号 `*` 来显示有关每个日志的信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-145">The **ListLog** parameter uses the asterisk (`*`) wildcard to display information about each log.</span></span> <span data-ttu-id="aa86e-146">**ComputerName** 参数指定从本地计算机 **localhost** 获取日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-146">The **ComputerName** parameter specifies to get the logs from the local computer, **localhost** .</span></span> <span data-ttu-id="aa86e-147">对象通过管道向下发送到 `Where-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-147">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-148">`Where-Object` 使用 `$_.RecordCount` 只返回包含数据的日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-148">`Where-Object` uses `$_.RecordCount` to return only logs that contain data.</span></span> <span data-ttu-id="aa86e-149">`$_` 一个变量，表示管道中的当前对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-149">`$_` is a variable that represents the current object in the pipeline.</span></span> <span data-ttu-id="aa86e-150">**RecordCount** 是具有非 null 值的对象的属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-150">**RecordCount** is a property of the object with a non-null value.</span></span>

### <span data-ttu-id="aa86e-151">示例4：从多个服务器获取事件日志</span><span class="sxs-lookup"><span data-stu-id="aa86e-151">Example 4: Get event logs from multiple servers</span></span>

<span data-ttu-id="aa86e-152">此示例将获取表示三台计算机上的 **应用程序** 事件日志的对象： Server01、Server02 和 Server03。</span><span class="sxs-lookup"><span data-stu-id="aa86e-152">This example gets objects that represent the **Application** event logs on three computers: Server01, Server02, and Server03.</span></span> <span data-ttu-id="aa86e-153">使用 **ForEach** 关键字的原因是 **ComputerName** 参数只接受一个值。</span><span class="sxs-lookup"><span data-stu-id="aa86e-153">The **ForEach** keyword is used because the **ComputerName** parameter accepts only one value.</span></span> <span data-ttu-id="aa86e-154">有关详细信息，请参阅 [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md)。</span><span class="sxs-lookup"><span data-stu-id="aa86e-154">For more information, see [about_Foreach](../Microsoft.PowerShell.Core/about/about_Foreach.md).</span></span>

```powershell
$S = 'Server01', 'Server02', 'Server03'
ForEach ($Server in $S) {
  Get-WinEvent -ListLog Application -ComputerName $Server |
    Select-Object LogMode, MaximumSizeInBytes, RecordCount, LogName,
      @{name='ComputerName'; expression={$Server}} |
    Format-Table -AutoSize
}
```

```Output
 LogMode MaximumSizeInBytes RecordCount LogName     ComputerName
 ------- ------------------ ----------- -------     ------------
Circular           15532032       14577 Application Server01
Circular           15532032        9689 Application Server02
Circular           15532032        5309 Application Server03
```

<span data-ttu-id="aa86e-155">变量 `$S` 存储名称三台服务器： **Server01** 、 **Server02** 和 **Server03** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-155">The variable `$S` stores the names three servers: **Server01** , **Server02** , and **Server03** .</span></span> <span data-ttu-id="aa86e-156">**ForEach** 语句使用循环来处理每个服务器 `($Server in $S)` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-156">The **ForEach** statement uses a loop to process each server, `($Server in $S)`.</span></span> <span data-ttu-id="aa86e-157">大括号中的脚本块 (`{ }`) 运行 `Get-WinEvent` 命令。</span><span class="sxs-lookup"><span data-stu-id="aa86e-157">The script block in the curly braces (`{ }`) runs the `Get-WinEvent` command.</span></span> <span data-ttu-id="aa86e-158">**ListLog** 参数指定 **应用程序** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-158">The **ListLog** parameter specifies the **Application** log.</span></span> <span data-ttu-id="aa86e-159">**ComputerName** 参数使用变量 `$Server` 来获取每个服务器的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-159">The **ComputerName** parameter uses the variable `$Server` to get log information from each server.</span></span>

<span data-ttu-id="aa86e-160">对象通过管道向下发送到 `Select-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-160">The objects are sent down the pipeline to the `Select-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-161">`Select-Object` 获取属性 **LogMode** 、 **MaximumSizeInBytes** 、 **RecordCount** 、 **LogName** ，并使用计算表达式显示使用该变量的 **ComputerName** `$Server` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-161">`Select-Object` gets the properties **LogMode** , **MaximumSizeInBytes** , **RecordCount** , **LogName** , and uses a calculated expression to display the **ComputerName** using the `$Server` variable.</span></span> <span data-ttu-id="aa86e-162">对象通过管道向下发送到 `Format-Table` cmdlet，以在 PowerShell 控制台中显示输出。</span><span class="sxs-lookup"><span data-stu-id="aa86e-162">The objects are sent down the pipeline to the `Format-Table` cmdlet to display the output in the PowerShell console.</span></span> <span data-ttu-id="aa86e-163">**AutoSize** 参数设置输出的格式以适合屏幕大小。</span><span class="sxs-lookup"><span data-stu-id="aa86e-163">The **AutoSize** parameter formats the output to fit the screen.</span></span>

### <span data-ttu-id="aa86e-164">示例5：获取事件日志提供程序和日志名称</span><span class="sxs-lookup"><span data-stu-id="aa86e-164">Example 5: Get event log providers and log names</span></span>

<span data-ttu-id="aa86e-165">此命令获取事件日志提供程序及其写入的日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-165">This command gets the event log providers and the logs to which they write.</span></span>

```powershell
Get-WinEvent -ListProvider *
```

```Output
Name     : .NET Runtime
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : .NET Runtime Optimization Service
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="aa86e-166">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-166">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-167">**ListProvider** 参数使用) 通配符 (星号 `*` 来显示每个提供程序的相关信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-167">The **ListProvider** parameter uses the asterisk (`*`) wildcard to display information about each provider.</span></span> <span data-ttu-id="aa86e-168">在输出中，该 **名称** 是提供程序，而 **LogLinks** 是提供程序写入的日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-168">In the output, the **Name** is the provider and **LogLinks** is the log that the provider writes to.</span></span>

### <span data-ttu-id="aa86e-169">示例6：获取写入特定日志的所有事件日志提供程序</span><span class="sxs-lookup"><span data-stu-id="aa86e-169">Example 6: Get all event log providers that write to a specific log</span></span>

<span data-ttu-id="aa86e-170">此命令将获取所有写入 **应用程序** 日志的提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-170">This command gets all of the providers that write to the **Application** log.</span></span>

```powershell
(Get-WinEvent -ListLog Application).ProviderNames
```

```Output
.NET Runtime
.NET Runtime Optimization Service
Application
Application Error
Application Hang
Application Management
```

<span data-ttu-id="aa86e-171">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-171">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-172">**ListLog** 参数使用 **应用程序** 获取该日志的对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-172">The **ListLog** parameter uses **Application** to get objects for that log.</span></span> <span data-ttu-id="aa86e-173">**ProviderNames** 是对象的一个属性，它显示写入 **应用程序** 日志的提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-173">**ProviderNames** is a property of the object and displays the providers that write to the **Application** log.</span></span>

### <span data-ttu-id="aa86e-174">示例7：获取包含特定字符串的事件日志提供程序名称</span><span class="sxs-lookup"><span data-stu-id="aa86e-174">Example 7: Get event log provider names that contain a specific string</span></span>

<span data-ttu-id="aa86e-175">此命令将获取名称中包含提供程序名称中特定字符串的事件日志提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-175">This command gets the event log providers with names that include a specific string in the provider's name.</span></span>

```powershell
Get-WinEvent -ListProvider *Policy*
```

```Output
Name     : Group Policy Applications
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Client
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}

Name     : Group Policy Data Sources
LogLinks : {Application}
Opcodes  : {}
Tasks    : {}
```

<span data-ttu-id="aa86e-176">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-176">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-177">**ListProvider** 参数使用) 通配符 (星号 `*` 来查找提供程序名称中任意位置的 **策略** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-177">The **ListProvider** parameter uses the asterisk (`*`) wildcard to find **Policy** anywhere within the provider's name.</span></span>

### <span data-ttu-id="aa86e-178">示例8：获取事件提供程序生成的事件 Id</span><span class="sxs-lookup"><span data-stu-id="aa86e-178">Example 8: Get Event Ids that the event provider generates</span></span>

<span data-ttu-id="aa86e-179">此命令列出 **Microsoft microsoft-windows-grouppolicy** 事件提供程序生成的事件 id 以及事件说明。</span><span class="sxs-lookup"><span data-stu-id="aa86e-179">This command lists the Event Ids that the **Microsoft-Windows-GroupPolicy** event provider generates along with the event description.</span></span>

```powershell
(Get-WinEvent -ListProvider Microsoft-Windows-GroupPolicy).Events | Format-Table Id, Description
```

```Output
  Id  Description
  --  -----------
1500  The Group Policy settings for the computer were processed successfully...
1501  The Group Policy settings for the user were processed successfully...
4115  Group Policy Service started.
4116  Started the Group Policy service initialization phase.
4117  Group Policy Session started.
```

<span data-ttu-id="aa86e-180">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-180">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-181">**ListProvider** 参数指定提供程序 **microsoft-windows-grouppolicy** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-181">The **ListProvider** parameter specifies the provider, **Microsoft-Windows-GroupPolicy** .</span></span> <span data-ttu-id="aa86e-182">表达式括在括号中，并使用 **Events** 属性来获取对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-182">The expression is wrapped in parentheses and uses the **Events** property to get objects.</span></span> <span data-ttu-id="aa86e-183">对象通过管道向下发送到 `Format-Table` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-183">The objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="aa86e-184">`Format-Table` 显示事件对象的 **Id** 和 **说明** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-184">`Format-Table` displays the **Id** and **Description** of the event objects.</span></span>

### <span data-ttu-id="aa86e-185">示例9：从事件对象属性中获取日志信息</span><span class="sxs-lookup"><span data-stu-id="aa86e-185">Example 9: Get log information from event object properties</span></span>

<span data-ttu-id="aa86e-186">此示例演示如何使用事件对象属性获取有关日志内容的信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-186">This example shows how to get information about a log's contents using event object properties.</span></span>
<span data-ttu-id="aa86e-187">事件对象存储在变量中，然后按 **事件 Id** 和 **级别** 进行分组和计数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-187">Event objects are stored in a variable and then grouped and counted by **Event Id** and **Level** .</span></span>

```powershell
$Event = Get-WinEvent -LogName 'Windows PowerShell'
$Event.Count
$Event | Group-Object -Property Id -NoElement | Sort-Object -Property Count -Descending
$Event | Group-Object -Property LevelDisplayName -NoElement
```

```Output
195

Count  Name
-----  ----
  147  600
   22  400
   21  601
    3  403
    2  103

Count  Name
-----  ----
    2  Warning
  193  Information
```

<span data-ttu-id="aa86e-188">`Get-WinEvent`Cmdlet 使用 **LogName** 参数指定 **Windows PowerShell** 事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-188">The `Get-WinEvent` cmdlet uses the **LogName** parameter to specify the **Windows PowerShell** event log.</span></span> <span data-ttu-id="aa86e-189">事件对象存储在 `$Event` 变量中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-189">The event objects are stored in the `$Event` variable.</span></span> <span data-ttu-id="aa86e-190">的 " **计数** " 属性 `$Event` 显示已记录事件的总数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-190">The **Count** property of `$Event`shows the total number of logged events.</span></span>

<span data-ttu-id="aa86e-191">该 `$Event` 变量将通过管道向下发送到 `Group-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-191">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-192">`Group-Object` 使用 **Property** 参数来指定 **Id** 属性，并按事件 Id 值对对象进行计数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-192">`Group-Object` uses the **Property** parameter to specify the **Id** property and counts the objects by the event Id value.</span></span> <span data-ttu-id="aa86e-193">**NoElement** 参数从对象输出中删除其他属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-193">The **NoElement** parameter removes other properties from the objects output.</span></span> <span data-ttu-id="aa86e-194">分组对象会按管道向下发送到 `Sort-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-194">The grouped objects are sent down the pipeline to the `Sort-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-195">`Sort-Object` 使用 **属性** 参数按 **计数** 对对象进行排序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-195">`Sort-Object` uses the **Property** parameter to sort the objects by **Count** .</span></span> <span data-ttu-id="aa86e-196">**降序** 参数按计数显示输出，从最高到最低。</span><span class="sxs-lookup"><span data-stu-id="aa86e-196">The **Descending** parameter displays the output by count, from highest to lowest.</span></span> <span data-ttu-id="aa86e-197">在输出中， **Count** 列包含每个事件的总数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-197">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="aa86e-198">" **名称** " 列包含分组事件 Id 号。</span><span class="sxs-lookup"><span data-stu-id="aa86e-198">The **Name** column contains the grouped event Id numbers.</span></span>

<span data-ttu-id="aa86e-199">该 `$Event` 变量将通过管道向下发送到 `Group-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-199">The `$Event` variable is sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-200">`Group-Object` 使用 **Property** 参数指定 **LevelDisplayName** 属性，并按 **LevelDisplayName** 对对象计数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-200">`Group-Object` uses the **Property** parameter to specify the **LevelDisplayName** property and counts the objects by **LevelDisplayName** .</span></span> <span data-ttu-id="aa86e-201">对象按级别（如 **警告** 和 **信息** ）分组。</span><span class="sxs-lookup"><span data-stu-id="aa86e-201">The objects are grouped by the levels such as **Warning** and **Information** .</span></span>
<span data-ttu-id="aa86e-202">**NoElement** 参数从输出中删除其他属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-202">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="aa86e-203">在输出中， **Count** 列包含每个事件的总数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-203">In the output, the **Count** column contains the total number of each event.</span></span> <span data-ttu-id="aa86e-204">" **名称** " 列包含分组的 **LevelDisplayName** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-204">The **Name** column contains the grouped **LevelDisplayName** .</span></span>

### <span data-ttu-id="aa86e-205">示例10：获取名称中包含指定字符串的错误事件</span><span class="sxs-lookup"><span data-stu-id="aa86e-205">Example 10: Get error events that have a specified string in their name</span></span>

<span data-ttu-id="aa86e-206">此示例使用以逗号分隔的日志名称字符串。</span><span class="sxs-lookup"><span data-stu-id="aa86e-206">This example uses a comma-separated string of log names.</span></span> <span data-ttu-id="aa86e-207">输出按级别进行分组，如 "错误" 或 "警告" 和 "日志名称"。</span><span class="sxs-lookup"><span data-stu-id="aa86e-207">The output is grouped by the level such as error or warning and the log name.</span></span>

```powershell
Get-WinEvent -LogName *PowerShell*, Microsoft-Windows-Kernel-WHEA* |
  Group-Object -Property LevelDisplayName, LogName -NoElement |
    Format-Table -AutoSize
```

```Output
Count  Name
-----  ----
    1  Error, PowerShellCore/Operational
   26  Information, Microsoft-Windows-Kernel-WHEA/Operational
  488  Information, Microsoft-Windows-PowerShell/Operational
   77  Information, PowerShellCore/Operational
 9835  Information, Windows PowerShell
   19  Verbose, PowerShellCore/Operational
  444  Warning, Microsoft-Windows-PowerShell/Operational
  512  Warning, PowerShellCore/Operational
```

<span data-ttu-id="aa86e-208">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-208">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-209">**LogName** 参数使用逗号分隔的字符串，其中星号 (`*`) 通配符指定日志名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-209">The **LogName** parameter uses a comma-separated string with the asterisk (`*`) wildcard to specify the log names.</span></span> <span data-ttu-id="aa86e-210">对象通过管道向下发送到 `Group-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-210">The objects are sent down the pipeline to the `Group-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-211">`Group-Object` 使用 **Property** 参数按 **LevelDisplayName** 和 **LogName** 对对象进行分组。</span><span class="sxs-lookup"><span data-stu-id="aa86e-211">`Group-Object` uses the **Property** parameter to group the objects by **LevelDisplayName** and **LogName** .</span></span> <span data-ttu-id="aa86e-212">**NoElement** 参数从输出中删除其他属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-212">The **NoElement** parameter removes other properties from the output.</span></span> <span data-ttu-id="aa86e-213">分组对象会按管道向下发送到 `Format-Table` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-213">The grouped objects are sent down the pipeline to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="aa86e-214">`Format-Table` 使用 **AutoSize** 参数设置列的格式。</span><span class="sxs-lookup"><span data-stu-id="aa86e-214">`Format-Table` uses the **AutoSize** parameter to format the columns.</span></span> <span data-ttu-id="aa86e-215">" **计数** " 列包含每个事件的总数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-215">The **Count** column contains the total number of each event.</span></span> <span data-ttu-id="aa86e-216">" **名称** " 列包含分组的 **LevelDisplayName** 和 **LogName** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-216">The **Name** column contains the grouped **LevelDisplayName** and **LogName** .</span></span>

### <span data-ttu-id="aa86e-217">示例11：从存档的事件日志中获取事件</span><span class="sxs-lookup"><span data-stu-id="aa86e-217">Example 11: Get events from an archived event log</span></span>

<span data-ttu-id="aa86e-218">`Get-WinEvent` 可以从已保存的日志文件中获取事件信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-218">`Get-WinEvent` can get event information from saved log files.</span></span> <span data-ttu-id="aa86e-219">此示例使用存储在本地计算机上的存档 PowerShell 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-219">This sample uses an archived PowerShell log that is stored on the local computer.</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\Windows PowerShell.evtx'
```

```Output
   ProviderName: PowerShell

TimeCreated              Id LevelDisplayName  Message
-----------              -- ----------------  -------
3/15/2019 13:54:13      403 Information       Engine state is changed from Available to Stopped...
3/15/2019 13:54:13      400 Information       Engine state is changed from None to Available...
3/15/2019 13:54:13      600 Information       Provider "Variable" is Started...
3/15/2019 13:54:13      600 Information       Provider "Function" is Started...
3/15/2019 13:54:13      600 Information       Provider "FileSystem" is Started...
```

<span data-ttu-id="aa86e-220">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-220">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-221">**Path** 参数指定目录和文件名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-221">The **Path** parameter specifies the directory and file name.</span></span>

### <span data-ttu-id="aa86e-222">示例12：从存档的事件日志获取特定数量的事件</span><span class="sxs-lookup"><span data-stu-id="aa86e-222">Example 12: Get a specific number of events from an archived event log</span></span>

<span data-ttu-id="aa86e-223">这些命令从已存档的事件日志中获取特定数量的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-223">These commands get a specific number of events from an archived event log.</span></span> <span data-ttu-id="aa86e-224">`Get-WinEvent` 具有可获取最大事件数或最早事件数的参数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-224">`Get-WinEvent` has parameters that can get a maximum number of events or the oldest events.</span></span> <span data-ttu-id="aa86e-225">此示例使用存储在 **C:\Test\PowerShellCore 操作** 中的存档 PowerShell 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-225">This sample uses an archived PowerShell log that is stored in **C:\Test\PowerShellCore Operational.evtx** .</span></span>

```powershell
Get-WinEvent -Path 'C:\Test\PowerShellCore Operational.evtx' -MaxEvents 100
```

```Output
   ProviderName: PowerShellCore

TimeCreated                 Id   LevelDisplayName  Message
-----------                 --   ----------------  -------
3/15/2019 09:54:54        4104   Warning           Creating Scriptblock text (1 of 1):...
3/15/2019 09:37:13       40962   Information       PowerShell console is ready for user input
3/15/2019 07:56:24        4104   Warning           Creating Scriptblock text (1 of 1):...
...
3/7/2019 10:53:22        40961   Information       PowerShell console is starting up
3/7/2019 10:53:22         8197   Verbose           Runspace state changed to Opening
3/7/2019 10:53:22         8195   Verbose           Opening RunspacePool
```

<span data-ttu-id="aa86e-226">该 `Get-WinEvent` cmdlet 将获取计算机中的日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-226">The `Get-WinEvent` cmdlet gets log information from the computer.</span></span> <span data-ttu-id="aa86e-227">**Path** 参数指定目录和文件名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-227">The **Path** parameter specifies the directory and filename.</span></span> <span data-ttu-id="aa86e-228">**MaxEvents** 参数指定将显示从最新到最旧的100记录。</span><span class="sxs-lookup"><span data-stu-id="aa86e-228">The **MaxEvents** parameter specifies that 100 records are displayed, from newest to oldest.</span></span>

### <span data-ttu-id="aa86e-229">示例13： Windows 事件跟踪</span><span class="sxs-lookup"><span data-stu-id="aa86e-229">Example 13: Event Tracing for Windows</span></span>

<span data-ttu-id="aa86e-230">Windows (ETW 事件跟踪) 事件发生时将事件写入日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-230">Event Tracing for Windows (ETW) writes events to the log as events occur.</span></span> <span data-ttu-id="aa86e-231">事件按从旧到新的顺序存储。</span><span class="sxs-lookup"><span data-stu-id="aa86e-231">The events are stored in the order of oldest to newest.</span></span> <span data-ttu-id="aa86e-232">存档的 ETW 文件保存为 `.etl` **TraceLog** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-232">An archived ETW file is saved as an `.etl` such as **TraceLog.etl** .</span></span>
<span data-ttu-id="aa86e-233">事件按其写入日志的顺序列出，因此 *最早* 的参数是必需的。</span><span class="sxs-lookup"><span data-stu-id="aa86e-233">The events are listed in the order in which they are written to the log, so the *Oldest* parameter is required.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl' -Oldest |
  Sort-Object -Property TimeCreated -Descending |
    Select-Object -First 100
```

<span data-ttu-id="aa86e-234">该 `Get-WinEvent` cmdlet 将从存档的文件中获取日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-234">The `Get-WinEvent` cmdlet gets log information from the archived file.</span></span> <span data-ttu-id="aa86e-235">**Path** 参数指定目录和文件名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-235">The **Path** parameter specifies the directory and file name.</span></span> <span data-ttu-id="aa86e-236">**最早** 的参数用于按写入事件的顺序（最旧到最新）输出事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-236">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="aa86e-237">对象沿着管道向下发送到 cmdlet， `Sort-Object` `Sort-Object` 按 **TimeCreated** 属性的值以降序对对象进行排序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-237">The objects are sent down the pipeline to the `Sort-Object` cmdlet `Sort-Object` sorts the objects in descending order by the value of the **TimeCreated** property.</span></span> <span data-ttu-id="aa86e-238">将对象向下发送到 `Select-Object` 显示100最新事件的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-238">The objects are sent down the pipeline to the `Select-Object` cmdlet that displays the 100 newest events.</span></span>

### <span data-ttu-id="aa86e-239">示例14：从事件跟踪日志获取事件</span><span class="sxs-lookup"><span data-stu-id="aa86e-239">Example 14: Get events from an event trace log</span></span>

<span data-ttu-id="aa86e-240">此示例演示如何从事件跟踪日志文件 (`.etl`) 和存档的 Windows PowerShell 日志文件 () 获取事件 `.evtx` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-240">This example shows how to get the events from an event trace log file (`.etl`) and an archived Windows PowerShell log file (`.evtx`).</span></span> <span data-ttu-id="aa86e-241">可以将多个文件类型组合到单个命令中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-241">You can combine multiple file types in a single command.</span></span>
<span data-ttu-id="aa86e-242">由于这些文件包含相同类型的 **.NET Framework** 对象 **system.diagnostics.eventing.reader.eventlogrecord** ，因此可以用相同的属性对其进行筛选。</span><span class="sxs-lookup"><span data-stu-id="aa86e-242">Because the files contain the same type of **.NET Framework** object, **EventLogRecord** , you can filter them with the same properties.</span></span> <span data-ttu-id="aa86e-243">命令需要 **最早** 的参数，因为它是从文件中读取 `.etl` ，但 **最早** 的参数适用于每个文件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-243">The command requires the **Oldest** parameter because it is reading from an `.etl` file, but the **Oldest** parameter applies to each file.</span></span>

```powershell
Get-WinEvent -Path 'C:\Tracing\TraceLog.etl', 'C:\Test\Windows PowerShell.evtx' -Oldest |
  Where-Object { $_.Id -eq '403' }
```

<span data-ttu-id="aa86e-244">该 `Get-WinEvent` cmdlet 将从存档的文件中获取日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-244">The `Get-WinEvent` cmdlet gets log information from the archived files.</span></span> <span data-ttu-id="aa86e-245">**Path** 参数使用以逗号分隔的列表来指定每个文件的目录和文件名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-245">The **Path** parameter uses a comma-separated list to specify each files directory and file name.</span></span> <span data-ttu-id="aa86e-246">**最早** 的参数用于按写入事件的顺序（最旧到最新）输出事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-246">The **Oldest** parameter is used to output events in the order they are written, oldest to newest.</span></span> <span data-ttu-id="aa86e-247">对象通过管道向下发送到 `Where-Object` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-247">The objects are sent down the pipeline to the `Where-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-248">`Where-Object` 使用脚本块查找 **Id** 为 **403** 的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-248">`Where-Object` uses a script block to find events with and **Id** of **403** .</span></span> <span data-ttu-id="aa86e-249">`$_`变量表示管道中的当前对象， **Id** 是事件 id 属性。</span><span class="sxs-lookup"><span data-stu-id="aa86e-249">The `$_` variable represents the current object in the pipeline and **Id** is the Event Id property.</span></span>

### <span data-ttu-id="aa86e-250">示例15：筛选事件日志结果</span><span class="sxs-lookup"><span data-stu-id="aa86e-250">Example 15: Filter event log results</span></span>

<span data-ttu-id="aa86e-251">此示例演示了用于筛选和选择事件日志中的事件的多种方法。</span><span class="sxs-lookup"><span data-stu-id="aa86e-251">This example shows a variety of methods to filter and select events from an event log.</span></span> <span data-ttu-id="aa86e-252">所有这些命令都从 **Windows PowerShell** 事件日志中获取过去24小时内发生的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-252">All of these commands get events that occurred in the last 24-hours from the **Windows PowerShell** event log.</span></span>
<span data-ttu-id="aa86e-253">筛选器方法比使用 cmdlet 更为有效 `Where-Object` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-253">The filter methods are more efficient than using the `Where-Object` cmdlet.</span></span> <span data-ttu-id="aa86e-254">在检索对象时应用筛选器。</span><span class="sxs-lookup"><span data-stu-id="aa86e-254">Filters are applied as the objects are retrieved.</span></span> <span data-ttu-id="aa86e-255">`Where-Object` 检索所有对象，然后将筛选器应用于所有对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-255">`Where-Object` retrieves all of the objects, then applies filters to all of the objects.</span></span>

```powershell
# Using the Where-Object cmdlet:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -LogName 'Windows PowerShell' | Where-Object { $_.TimeCreated -ge $Yesterday }

# Using the FilterHashtable parameter:
$Yesterday = (Get-Date) - (New-TimeSpan -Day 1)
Get-WinEvent -FilterHashtable @{ LogName='Windows PowerShell'; Level=3; StartTime=$Yesterday }

# Using the FilterXML parameter:
$xmlQuery = @'
<QueryList>
  <Query Id="0" Path="Windows PowerShell">
    <Select Path="System">*[System[(Level=3) and
        TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]</Select>
  </Query>
</QueryList>
'@
Get-WinEvent -FilterXML $xmlQuery

# Using the FilterXPath parameter:
$XPath = '*[System[Level=3 and TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]'
Get-WinEvent -LogName 'Windows PowerShell' -FilterXPath $XPath
```

### <span data-ttu-id="aa86e-256">示例16：使用 FilterHashtable 从应用程序日志获取事件</span><span class="sxs-lookup"><span data-stu-id="aa86e-256">Example 16: Use FilterHashtable to get events from the Application log</span></span>

<span data-ttu-id="aa86e-257">此示例使用 **FilterHashtable** 参数从 **应用程序** 日志获取事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-257">This example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="aa86e-258">哈希表使用 **键/值** 对。</span><span class="sxs-lookup"><span data-stu-id="aa86e-258">The hash table uses **key/value** pairs.</span></span> <span data-ttu-id="aa86e-259">有关 **FilterHashtable** 参数的详细信息，请参阅 [通过 FilterHashtable 创建 Get-WinEvent 查询](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)。</span><span class="sxs-lookup"><span data-stu-id="aa86e-259">For more information about the **FilterHashtable** parameter, see [Creating Get-WinEvent queries with FilterHashtable](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable).</span></span>
<span data-ttu-id="aa86e-260">有关哈希表的详细信息，请参阅 [about_Hash_Tables](../Microsoft.PowerShell.Core/about/about_hash_tables.md)。</span><span class="sxs-lookup"><span data-stu-id="aa86e-260">For more information about hash tables, see [about_Hash_Tables](../Microsoft.PowerShell.Core/about/about_hash_tables.md).</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
Get-WinEvent -FilterHashtable @{ LogName='Application'; StartTime=$Date; Id='1003' }
```

<span data-ttu-id="aa86e-261">该 `Get-Date` cmdlet 使用 **AddDays** 方法获取当前日期的两天前的日期。</span><span class="sxs-lookup"><span data-stu-id="aa86e-261">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is two days before the current date.</span></span> <span data-ttu-id="aa86e-262">Date 对象存储在 `$Date` 变量中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-262">The date object is stored in the `$Date` variable.</span></span>

<span data-ttu-id="aa86e-263">`Get-WinEvent`Cmdlet 将获取日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-263">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="aa86e-264">**FilterHashtable** 参数用于筛选输出。</span><span class="sxs-lookup"><span data-stu-id="aa86e-264">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="aa86e-265">**LogName** 项将值指定为 **应用程序** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-265">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="aa86e-266">**StartTime** 键使用变量中存储的值 `$Date` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-266">The **StartTime** key uses the value stored in the `$Date` variable.</span></span> <span data-ttu-id="aa86e-267">**Id** 键使用事件 Id 值 **1003** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-267">The **Id** key uses an Event Id value, **1003** .</span></span>

### <span data-ttu-id="aa86e-268">示例17：使用 FilterHashtable 获取应用程序错误</span><span class="sxs-lookup"><span data-stu-id="aa86e-268">Example 17: Use FilterHashtable to get application errors</span></span>

<span data-ttu-id="aa86e-269">此示例使用 **FilterHashtable** 参数查找在过去一周内发生的 Internet Explorer 应用程序错误。</span><span class="sxs-lookup"><span data-stu-id="aa86e-269">This example uses the **FilterHashtable** parameter to find Internet Explorer application errors that occurred within the last week.</span></span>

```powershell
$StartTime = (Get-Date).AddDays(-7)
Get-WinEvent -FilterHashtable @{
  Logname='Application'
  ProviderName='Application Error'
  Data='iexplore.exe'
  StartTime=$StartTime
}
```

<span data-ttu-id="aa86e-270">该 `Get-Date` cmdlet 使用 **AddDays** 方法获取当前日期的七天前的日期。</span><span class="sxs-lookup"><span data-stu-id="aa86e-270">The `Get-Date` cmdlet uses the **AddDays** method to get a date that is seven days before the current date.</span></span> <span data-ttu-id="aa86e-271">Date 对象存储在 `$StartTime` 变量中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-271">The date object is stored in the `$StartTime` variable.</span></span>

<span data-ttu-id="aa86e-272">`Get-WinEvent`Cmdlet 将获取日志信息。</span><span class="sxs-lookup"><span data-stu-id="aa86e-272">The `Get-WinEvent` cmdlet gets log information.</span></span> <span data-ttu-id="aa86e-273">**FilterHashtable** 参数用于筛选输出。</span><span class="sxs-lookup"><span data-stu-id="aa86e-273">The **FilterHashtable** parameter is used to filter the output.</span></span> <span data-ttu-id="aa86e-274">**LogName** 项将值指定为 **应用程序** 日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-274">The **LogName** key specifies the value as the **Application** log.</span></span> <span data-ttu-id="aa86e-275">**ProviderName** 密钥使用值 " **应用程序错误** "，这是事件的 **源** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-275">The **ProviderName** key uses the value, **Application Error** , which is the event's **Source** .</span></span> <span data-ttu-id="aa86e-276">**数据** 键使用值 **iexplore.exe** **StartTime** 键使用变量中存储的值 `$StartTime` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-276">The **Data** key uses the value **iexplore.exe** The **StartTime** key uses the value stored in `$StartTime` variable.</span></span>

### <span data-ttu-id="aa86e-277">示例18：使用 SuppressHashFilter 筛选应用程序错误</span><span class="sxs-lookup"><span data-stu-id="aa86e-277">Example 18: Use SuppressHashFilter to filter application errors</span></span>

<span data-ttu-id="aa86e-278">与上面的示例16一样，此示例使用 **FilterHashtable** 参数从 **应用程序** 日志获取事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-278">Like Example 16 above, this example uses the **FilterHashtable** parameter to get events from the **Application** log.</span></span> <span data-ttu-id="aa86e-279">但是，我们添加了 **SuppressHashFilter** 项来筛选出 **信息** 级别事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-279">However, we add the **SuppressHashFilter** key to filter out **Information** level events.</span></span>

```powershell
$Date = (Get-Date).AddDays(-2)
$filter = @{
  LogName='Application'
  StartTime=$Date
  SuppressHashFilter=@{Level=4}
}
Get-WinEvent -FilterHashtable $filter
```

<span data-ttu-id="aa86e-280">在此示例中， `Get-WinEvent` 将从 **应用程序** 日志中获取过去两天的所有事件，但 **级别** 为 4 (信息) 的事件除外。</span><span class="sxs-lookup"><span data-stu-id="aa86e-280">In this example, `Get-WinEvent` gets all events from the **Application** log for the last two days except those that have a **Level** of 4 (Information).</span></span>

## <span data-ttu-id="aa86e-281">PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="aa86e-281">PARAMETERS</span></span>

### <span data-ttu-id="aa86e-282">-ComputerName</span><span class="sxs-lookup"><span data-stu-id="aa86e-282">-ComputerName</span></span>

<span data-ttu-id="aa86e-283">指定此 cmdlet 从事件日志获取事件的计算机的名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-283">Specifies the name of the computer that this cmdlet gets events from the event logs.</span></span> <span data-ttu-id="aa86e-284">键入计算机 (FQDN) 的 NetBIOS 名称、IP 地址或完全限定的域名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-284">Type the NetBIOS name, an IP address, or the fully qualified domain name (FQDN) of the computer.</span></span> <span data-ttu-id="aa86e-285">默认值为本地计算机 **localhost** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-285">The default value is the local computer, **localhost** .</span></span> <span data-ttu-id="aa86e-286">此参数一次只能接受一个计算机名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-286">This parameter accepts only one computer name at a time.</span></span>

<span data-ttu-id="aa86e-287">若要从远程计算机获取事件日志，请将事件日志服务的防火墙端口配置为允许远程访问。</span><span class="sxs-lookup"><span data-stu-id="aa86e-287">To get event logs from remote computers, configure the firewall port for the event log service to allow remote access.</span></span>

<span data-ttu-id="aa86e-288">此 cmdlet 不依赖于 PowerShell 远程处理。</span><span class="sxs-lookup"><span data-stu-id="aa86e-288">This cmdlet does not rely on PowerShell remoting.</span></span> <span data-ttu-id="aa86e-289">即使你的计算机未配置为运行远程命令，你也可以使用 **ComputerName** 参数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-289">You can use the **ComputerName** parameter even if your computer is not configured to run remote commands.</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, ListLogSet, ListProviderSet, GetProviderSet, HashQuerySet, XmlQuerySet
Aliases: Cn

Required: False
Position: Named
Default value: Local computer
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-290">-Credential</span><span class="sxs-lookup"><span data-stu-id="aa86e-290">-Credential</span></span>

<span data-ttu-id="aa86e-291">指定有权执行此操作的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="aa86e-291">Specifies a user account that has permission to perform this action.</span></span> <span data-ttu-id="aa86e-292">默认值为当前用户。</span><span class="sxs-lookup"><span data-stu-id="aa86e-292">The default value is the current user.</span></span>

<span data-ttu-id="aa86e-293">键入用户名，如 **User01** 或 **Domain01\User01** 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-293">Type a user name, such as **User01** or **Domain01\User01** .</span></span> <span data-ttu-id="aa86e-294">或者输入 **PSCredential** 对象，例如由 cmdlet 生成的对象 `Get-Credential` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-294">Or, enter a **PSCredential** object, such as one generated by the `Get-Credential` cmdlet.</span></span> <span data-ttu-id="aa86e-295">如果键入用户名，则将提示你输入密码。</span><span class="sxs-lookup"><span data-stu-id="aa86e-295">If you type a user name, you are prompted for a password.</span></span> <span data-ttu-id="aa86e-296">如果只键入参数名称，系统会提示输入用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="aa86e-296">If you type only the parameter name, you are prompted for both a username and a password.</span></span>

```yaml
Type: System.Management.Automation.PSCredential
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: Current user
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-297">-FilterHashtable</span><span class="sxs-lookup"><span data-stu-id="aa86e-297">-FilterHashtable</span></span>

<span data-ttu-id="aa86e-298">以哈希表格式指定查询，以从一个或多个事件日志中选择事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-298">Specifies a query in hash table format to select events from one or more event logs.</span></span> <span data-ttu-id="aa86e-299">该查询包含具有一个或多个 **键/值** 对的哈希表。</span><span class="sxs-lookup"><span data-stu-id="aa86e-299">The query contains a hash table with one or more **key/value** pairs.</span></span>

<span data-ttu-id="aa86e-300">哈希表查询具有以下规则：</span><span class="sxs-lookup"><span data-stu-id="aa86e-300">Hash table queries have the following rules:</span></span>

- <span data-ttu-id="aa86e-301">键和值不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="aa86e-301">Keys and values are case-insensitive.</span></span>
- <span data-ttu-id="aa86e-302">通配符仅在与 **LogName** 和 **ProviderName** 键关联的值中有效。</span><span class="sxs-lookup"><span data-stu-id="aa86e-302">Wildcard characters are valid only in the values associated with the **LogName** and **ProviderName** keys.</span></span>
- <span data-ttu-id="aa86e-303">每个密钥只能在每个哈希表中列出一次。</span><span class="sxs-lookup"><span data-stu-id="aa86e-303">Each key can be listed only once in each hash table.</span></span>
- <span data-ttu-id="aa86e-304">**路径** 值采用 `.etl` 、 `.evt` 和日志文件的路径 `.evtx` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-304">The **Path** value takes paths to `.etl`, `.evt`, and `.evtx` log files.</span></span>
- <span data-ttu-id="aa86e-305">可以在同一个查询中使用 **LogName** 、 **Path** 和 **ProviderName** 键。</span><span class="sxs-lookup"><span data-stu-id="aa86e-305">The **LogName** , **Path** , and **ProviderName** keys can be used in the same query.</span></span>
- <span data-ttu-id="aa86e-306">**UserID** 键可以采用有效的安全标识符 (SID) 或可用于构造有效的 **NTAccount 对象** 的域帐户名。</span><span class="sxs-lookup"><span data-stu-id="aa86e-306">The **UserID** key can take a valid security identifier (SID) or a domain account name that can be used to construct a valid **System.Security.Principal.NTAccount object** .</span></span>
- <span data-ttu-id="aa86e-307">**数据** 值采用未命名字段中的事件数据。</span><span class="sxs-lookup"><span data-stu-id="aa86e-307">The **Data** value takes event data in an unnamed field.</span></span> <span data-ttu-id="aa86e-308">例如，经典事件日志中的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-308">For example, events in classic event logs.</span></span>
- <span data-ttu-id="aa86e-309">`<named-data>` key 表示命名事件数据字段。</span><span class="sxs-lookup"><span data-stu-id="aa86e-309">`<named-data>` key represents a named event data field.</span></span>

<span data-ttu-id="aa86e-310">当 `Get-WinEvent` 无法解释 **键/值** 对时，它会将密钥解释为事件中事件数据的区分大小写的名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-310">When `Get-WinEvent` cannot interpret a **key/value** pair, it interprets the key as a case-sensitive name for the event data in the event.</span></span>

<span data-ttu-id="aa86e-311">有效的 `Get-WinEvent` **键/值** 对如下所示：</span><span class="sxs-lookup"><span data-stu-id="aa86e-311">The valid `Get-WinEvent` **key/value** pairs are as follows:</span></span>

- <span data-ttu-id="aa86e-312">**LogName**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-312">**LogName**=`<String[]>`</span></span>
- <span data-ttu-id="aa86e-313">**ProviderName**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-313">**ProviderName**=`<String[]>`</span></span>
- <span data-ttu-id="aa86e-314">**通道**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-314">**Path**=`<String[]>`</span></span>
- <span data-ttu-id="aa86e-315">**字**=`<Long[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-315">**Keywords**=`<Long[]>`</span></span>
- <span data-ttu-id="aa86e-316">**识别**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-316">**ID**=`<Int32[]>`</span></span>
- <span data-ttu-id="aa86e-317">**调配**=`<Int32[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-317">**Level**=`<Int32[]>`</span></span>
- <span data-ttu-id="aa86e-318">**时间**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-318">**StartTime**=`<DateTime>`</span></span>
- <span data-ttu-id="aa86e-319">**结束**=`<DateTime>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-319">**EndTime**=`<DateTime>`</span></span>
- <span data-ttu-id="aa86e-320">**Id**=`<SID>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-320">**UserID**=`<SID>`</span></span>
- <span data-ttu-id="aa86e-321">**数据**=`<String[]>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-321">**Data**=`<String[]>`</span></span>
- `<named-data>`=`<String[]>`
- <span data-ttu-id="aa86e-322">**SuppressHashFilter**=`<Hashtable>`</span><span class="sxs-lookup"><span data-stu-id="aa86e-322">**SuppressHashFilter**=`<Hashtable>`</span></span>

```yaml
Type: System.Collections.Hashtable[]
Parameter Sets: HashQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-323">-FilterXml</span><span class="sxs-lookup"><span data-stu-id="aa86e-323">-FilterXml</span></span>

<span data-ttu-id="aa86e-324">指定一个结构化 XML 查询，此 cmdlet 从一个或多个事件日志中选择事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-324">Specifies a structured XML query that this cmdlet selects events from one or more event logs.</span></span>

<span data-ttu-id="aa86e-325">若要生成有效的 XML 查询，请使用 Windows 事件查看器中的 " **创建自定义视图** " 和 " **筛选当前日志** " 功能。</span><span class="sxs-lookup"><span data-stu-id="aa86e-325">To generate a valid XML query, use the **Create Custom View** and **Filter Current Log** features in Windows Event Viewer.</span></span> <span data-ttu-id="aa86e-326">使用对话框中的项创建查询，然后单击 XML 选项卡以查看 XML 格式的查询。</span><span class="sxs-lookup"><span data-stu-id="aa86e-326">Use the items in the dialog box to create a query, and then click the XML tab to view the query in XML format.</span></span> <span data-ttu-id="aa86e-327">可以将该 XML 从 XML 选项卡复制到 **FilterXml** 参数的值中。</span><span class="sxs-lookup"><span data-stu-id="aa86e-327">You can copy the XML from the XML tab into the value of the **FilterXml** parameter.</span></span> <span data-ttu-id="aa86e-328">有关事件查看器功能的详细信息，请参阅“事件查看器帮助”。</span><span class="sxs-lookup"><span data-stu-id="aa86e-328">For more information about the Event Viewer features, see Event Viewer Help.</span></span>

<span data-ttu-id="aa86e-329">使用 XML 查询来创建包含多个 XPath 语句的复杂查询。</span><span class="sxs-lookup"><span data-stu-id="aa86e-329">Use an XML query to create a complex query that contains several XPath statements.</span></span> <span data-ttu-id="aa86e-330">XML 格式还允许使用 **禁止显示** 查询中的事件的 xml 元素。</span><span class="sxs-lookup"><span data-stu-id="aa86e-330">The XML format also allows you to use a **Suppress XML** element that excludes events from the query.</span></span> <span data-ttu-id="aa86e-331">有关事件日志查询的 XML 架构的详细信息，请参阅 " [查询架构](/windows/win32/wes/queryschema-schema) " 和 " [事件选择](/previous-versions/aa385231(v=vs.85))" 中的 "xml 事件查询" 部分。</span><span class="sxs-lookup"><span data-stu-id="aa86e-331">For more information about the XML schema for event log queries, see [Query Schema](/windows/win32/wes/queryschema-schema) and the XML Event Queries section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

<span data-ttu-id="aa86e-332">你还可以使用 **FilterHashtable** 参数创建一个 **抑制** 元素。</span><span class="sxs-lookup"><span data-stu-id="aa86e-332">You may also create a **Suppress** element using the **FilterHashtable** parameter.</span></span>

```yaml
Type: System.Xml.XmlDocument
Parameter Sets: XmlQuerySet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-333">-FilterXPath</span><span class="sxs-lookup"><span data-stu-id="aa86e-333">-FilterXPath</span></span>

<span data-ttu-id="aa86e-334">指定 XPath 查询，此 cmdlet 从一个或多个日志中选择事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-334">Specifies an XPath query that this cmdlet select events from one or more logs.</span></span>

<span data-ttu-id="aa86e-335">有关 XPath 语言的详细信息，请参阅 " [Xpath 参考](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100)) " 和 " [事件选择](/previous-versions/aa385231(v=vs.85))" 的 "选择筛选器" 部分。</span><span class="sxs-lookup"><span data-stu-id="aa86e-335">For more information about the XPath language, see [XPath Reference](/previous-versions/dotnet/netframework-4.0/ms256115(v=vs.100)) and the Selection Filters section of [Event Selection](/previous-versions/aa385231(v=vs.85)).</span></span>

```yaml
Type: System.String
Parameter Sets: GetLogSet, GetProviderSet, FileSet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-336">-Force</span><span class="sxs-lookup"><span data-stu-id="aa86e-336">-Force</span></span>

<span data-ttu-id="aa86e-337">获取调试和分析日志以及其他事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-337">Gets debug and analytic logs, in addition to other event logs.</span></span> <span data-ttu-id="aa86e-338">当名称参数的值包含通配符时，需要使用 **Force** 参数才能获取调试或分析日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-338">The **Force** parameter is required to get a debug or analytic log when the value of the name parameter includes wildcard characters.</span></span>

<span data-ttu-id="aa86e-339">默认情况下， `Get-WinEvent` 除非您指定了调试或分析日志的全名，否则 cmdlet 会排除这些日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-339">By default, the `Get-WinEvent` cmdlet excludes these logs unless you specify the full name of a debug or analytic log.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, ListLogSet, GetProviderSet, HashQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-340">-ListLog</span><span class="sxs-lookup"><span data-stu-id="aa86e-340">-ListLog</span></span>

<span data-ttu-id="aa86e-341">指定事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-341">Specifies the event logs.</span></span> <span data-ttu-id="aa86e-342">在以逗号分隔的列表中输入事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-342">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="aa86e-343">允许使用通配符。</span><span class="sxs-lookup"><span data-stu-id="aa86e-343">Wildcards are permitted.</span></span> <span data-ttu-id="aa86e-344">若要获取所有日志，请使用星号 (`*`) 通配符。</span><span class="sxs-lookup"><span data-stu-id="aa86e-344">To get all the logs, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListLogSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="aa86e-345">-ListProvider</span><span class="sxs-lookup"><span data-stu-id="aa86e-345">-ListProvider</span></span>

<span data-ttu-id="aa86e-346">指定此 cmdlet 获取的事件日志提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-346">Specifies the event log providers that this cmdlet gets.</span></span> <span data-ttu-id="aa86e-347">事件日志提供程序是可将事件写入事件日志的一种程序或服务。</span><span class="sxs-lookup"><span data-stu-id="aa86e-347">An event log provider is a program or service that writes events to the event log.</span></span>

<span data-ttu-id="aa86e-348">在以逗号分隔的列表中输入提供程序名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-348">Enter the provider names in a comma-separated list.</span></span> <span data-ttu-id="aa86e-349">允许使用通配符。</span><span class="sxs-lookup"><span data-stu-id="aa86e-349">Wildcards are permitted.</span></span> <span data-ttu-id="aa86e-350">若要获取计算机上所有事件日志的提供程序，请使用星号 (`*`) 通配符。</span><span class="sxs-lookup"><span data-stu-id="aa86e-350">To get the providers of all the event logs on the computer, use the asterisk (`*`) wildcard.</span></span>

```yaml
Type: System.String[]
Parameter Sets: ListProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: False
Accept wildcard characters: True
```

### <span data-ttu-id="aa86e-351">-LogName</span><span class="sxs-lookup"><span data-stu-id="aa86e-351">-LogName</span></span>

<span data-ttu-id="aa86e-352">指定此 cmdlet 从中获取事件的事件日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-352">Specifies the event logs that this cmdlet get events from.</span></span> <span data-ttu-id="aa86e-353">在以逗号分隔的列表中输入事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="aa86e-353">Enter the event log names in a comma-separated list.</span></span> <span data-ttu-id="aa86e-354">允许使用通配符。</span><span class="sxs-lookup"><span data-stu-id="aa86e-354">Wildcards are permitted.</span></span> <span data-ttu-id="aa86e-355">你还可以将日志名称通过管道传递给 `Get-WinEvent` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-355">You can also pipe log names to the `Get-WinEvent` cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="aa86e-356">PowerShell 不会限制你可以请求的日志量。</span><span class="sxs-lookup"><span data-stu-id="aa86e-356">PowerShell does not limit the amount of logs you can request.</span></span> <span data-ttu-id="aa86e-357">但是，该 `Get-WinEvent` cmdlet 将查询限制为256的 WINDOWS API。</span><span class="sxs-lookup"><span data-stu-id="aa86e-357">However, the `Get-WinEvent` cmdlet queries the Windows API which has a limit of 256.</span></span> <span data-ttu-id="aa86e-358">这可能会导致很难一次筛选所有日志。</span><span class="sxs-lookup"><span data-stu-id="aa86e-358">This can make it difficult to filter through all of your logs at one time.</span></span> <span data-ttu-id="aa86e-359">可以通过使用 `foreach` 循环遍历每个日志来解决此操作，如下所示： `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span><span class="sxs-lookup"><span data-stu-id="aa86e-359">You can work around this by using a `foreach` loop to iterate through each log like this: `Get-WinEvent -ListLog * | ForEach-Object{ Get-WinEvent -LogName $_.Logname }`</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetLogSet
Aliases:

Required: False
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName, ByValue)
Accept wildcard characters: True
```

### <span data-ttu-id="aa86e-360">-MaxEvents</span><span class="sxs-lookup"><span data-stu-id="aa86e-360">-MaxEvents</span></span>

<span data-ttu-id="aa86e-361">指定返回的最大事件数。</span><span class="sxs-lookup"><span data-stu-id="aa86e-361">Specifies the maximum number of events that are returned.</span></span> <span data-ttu-id="aa86e-362">输入一个整数，例如100。</span><span class="sxs-lookup"><span data-stu-id="aa86e-362">Enter an integer such as 100.</span></span> <span data-ttu-id="aa86e-363">默认设置为返回日志或文件中的所有事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-363">The default is to return all the events in the logs or files.</span></span>

```yaml
Type: System.Int64
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-364">-Oldest</span><span class="sxs-lookup"><span data-stu-id="aa86e-364">-Oldest</span></span>

<span data-ttu-id="aa86e-365">指示此 cmdlet 按最早顺序获取事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-365">Indicate that this cmdlet gets the events in oldest-first order.</span></span> <span data-ttu-id="aa86e-366">默认情况下，事件按从新到旧的顺序返回。</span><span class="sxs-lookup"><span data-stu-id="aa86e-366">By default, events are returned in newest-first order.</span></span>

<span data-ttu-id="aa86e-367">若要从 `.etl` 和 `.evt` 文件以及从调试和分析日志中获取事件，此参数是必需的。</span><span class="sxs-lookup"><span data-stu-id="aa86e-367">This parameter is required to get events from `.etl` and `.evt` files and from debug and analytic logs.</span></span> <span data-ttu-id="aa86e-368">在这些文件中，事件按从旧到新的顺序记录，并且只能按从旧到新的顺序返回。</span><span class="sxs-lookup"><span data-stu-id="aa86e-368">In these files, events are recorded in oldest-first order, and the events can be returned only in oldest-first order.</span></span>

```yaml
Type: System.Management.Automation.SwitchParameter
Parameter Sets: GetLogSet, GetProviderSet, FileSet, HashQuerySet, XmlQuerySet
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### <span data-ttu-id="aa86e-369">-Path</span><span class="sxs-lookup"><span data-stu-id="aa86e-369">-Path</span></span>

<span data-ttu-id="aa86e-370">指定此 cmdlet 从中获取事件的事件日志文件的路径。</span><span class="sxs-lookup"><span data-stu-id="aa86e-370">Specifies the path to the event log files that this cmdlet get events from.</span></span> <span data-ttu-id="aa86e-371">在以逗号分隔的列表中输入日志文件的路径，或使用通配符来创建文件路径模式。</span><span class="sxs-lookup"><span data-stu-id="aa86e-371">Enter the paths to the log files in a comma-separated list, or use wildcard characters to create file path patterns.</span></span>

<span data-ttu-id="aa86e-372">`Get-WinEvent` 支持具有 `.evt` 、 `.evtx` 和 `.etl` 文件扩展名的文件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-372">`Get-WinEvent` supports files with the `.evt`, `.evtx`, and `.etl` file name extensions.</span></span> <span data-ttu-id="aa86e-373">可以在同一命令中包括来自不同文件和文件类型的事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-373">You can include events from different files and file types in the same command.</span></span>

```yaml
Type: System.String[]
Parameter Sets: FileSet
Aliases: PSPath

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="aa86e-374">-ProviderName</span><span class="sxs-lookup"><span data-stu-id="aa86e-374">-ProviderName</span></span>

<span data-ttu-id="aa86e-375">指定为字符串数组，此 cmdlet 从中获取事件的事件日志提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-375">Specifies, as a string array, the event log providers from which this cmdlet gets events.</span></span> <span data-ttu-id="aa86e-376">在以逗号分隔的列表中输入提供程序名称，或使用通配符来创建提供程序名称模式。</span><span class="sxs-lookup"><span data-stu-id="aa86e-376">Enter the provider names in a comma-separated list, or use wildcard characters to create provider name patterns.</span></span>

<span data-ttu-id="aa86e-377">事件日志提供程序是可将事件写入事件日志的一种程序或服务。</span><span class="sxs-lookup"><span data-stu-id="aa86e-377">An event log provider is a program or service that writes events to the event log.</span></span> <span data-ttu-id="aa86e-378">它不是 PowerShell 提供程序。</span><span class="sxs-lookup"><span data-stu-id="aa86e-378">It is not a PowerShell provider.</span></span>

```yaml
Type: System.String[]
Parameter Sets: GetProviderSet
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: True
```

### <span data-ttu-id="aa86e-379">CommonParameters</span><span class="sxs-lookup"><span data-stu-id="aa86e-379">CommonParameters</span></span>

<span data-ttu-id="aa86e-380">此 cmdlet 支持以下常见参数：-Debug、-ErrorAction、-ErrorVariable、-InformationAction、-InformationVariable、-OutVariable、-OutBuffer、-PipelineVariable、-Verbose、-WarningAction 和 -WarningVariable。</span><span class="sxs-lookup"><span data-stu-id="aa86e-380">This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable.</span></span> <span data-ttu-id="aa86e-381">有关详细信息，请参阅 [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216)。</span><span class="sxs-lookup"><span data-stu-id="aa86e-381">For more information, see [about_CommonParameters](https://go.microsoft.com/fwlink/?LinkID=113216).</span></span>

## <span data-ttu-id="aa86e-382">输入</span><span class="sxs-lookup"><span data-stu-id="aa86e-382">INPUTS</span></span>

### <span data-ttu-id="aa86e-383">System.string、System.Xml.XmlDocument、System.object</span><span class="sxs-lookup"><span data-stu-id="aa86e-383">System.String, System.Xml.XmlDocument, System.Collections.Hashtable</span></span>

<span data-ttu-id="aa86e-384">可以通过管道将 **LogName** (string) 、 **FilterXML** 查询或 **FilterHashtable** 查询进行管道 `Get-WinEvent` 。</span><span class="sxs-lookup"><span data-stu-id="aa86e-384">You can pipeline a **LogName** (string), a **FilterXML** query, or a **FilterHashtable** query to `Get-WinEvent`.</span></span>

## <span data-ttu-id="aa86e-385">输出</span><span class="sxs-lookup"><span data-stu-id="aa86e-385">OUTPUTS</span></span>

### <span data-ttu-id="aa86e-386">System.Diagnostics.Eventing.Reader.EventLogConfiguration、System.Diagnostics.Eventing.Reader.EventLogRecord、System.Diagnostics.Eventing.Reader.ProviderMetadata</span><span class="sxs-lookup"><span data-stu-id="aa86e-386">System.Diagnostics.Eventing.Reader.EventLogConfiguration, System.Diagnostics.Eventing.Reader.EventLogRecord, System.Diagnostics.Eventing.Reader.ProviderMetadata</span></span>

<span data-ttu-id="aa86e-387">对于 **ListLog** 参数，将 `Get-WinEvent` 返回 **system.diagnostics.eventing.reader.eventlogconfiguration** 对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-387">With the **ListLog** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogConfiguration** objects.</span></span>

<span data-ttu-id="aa86e-388">对于 **ListProvider** 参数，将 `Get-WinEvent` 返回 **ProviderMetadata** 对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-388">With the **ListProvider** parameter, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.ProviderMetadata** objects.</span></span>

<span data-ttu-id="aa86e-389">对于所有其他参数， `Get-WinEvent` 返回 **system.diagnostics.eventing.reader.eventlogrecord** 对象。</span><span class="sxs-lookup"><span data-stu-id="aa86e-389">With all other parameters, `Get-WinEvent` returns **System.Diagnostics.Eventing.Reader.EventLogRecord** objects.</span></span>

## <span data-ttu-id="aa86e-390">注释</span><span class="sxs-lookup"><span data-stu-id="aa86e-390">NOTES</span></span>

<span data-ttu-id="aa86e-391">`Get-WinEvent` 旨在替换 `Get-EventLog` 运行 Windows Vista 和更高版本 windows 的计算机上的 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-391">`Get-WinEvent` is designed to replace the `Get-EventLog` cmdlet on computers running Windows Vista and later versions of Windows.</span></span> <span data-ttu-id="aa86e-392">`Get-EventLog` 仅在经典事件日志中获取事件。</span><span class="sxs-lookup"><span data-stu-id="aa86e-392">`Get-EventLog` gets events only in classic event logs.</span></span> <span data-ttu-id="aa86e-393">为实现后向兼容性保留了 `Get-EventLog`。</span><span class="sxs-lookup"><span data-stu-id="aa86e-393">`Get-EventLog` is retained for backward compatibility.</span></span>

<span data-ttu-id="aa86e-394">`Get-WinEvent` `Get-EventLog` Windows PE)  (windows 预安装环境不支持和 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="aa86e-394">The `Get-WinEvent` and `Get-EventLog` cmdlets are not supported in Windows Pre-installation Environment (Windows PE).</span></span>

## <span data-ttu-id="aa86e-395">相关链接</span><span class="sxs-lookup"><span data-stu-id="aa86e-395">RELATED LINKS</span></span>

[<span data-ttu-id="aa86e-396">about_Automatic_Variables</span><span class="sxs-lookup"><span data-stu-id="aa86e-396">about_Automatic_Variables</span></span>](../Microsoft.PowerShell.Core/about/about_automatic_variables.md)

[<span data-ttu-id="aa86e-397">about_Foreach</span><span class="sxs-lookup"><span data-stu-id="aa86e-397">about_Foreach</span></span>](../Microsoft.PowerShell.Core/about/about_Foreach.md)

[<span data-ttu-id="aa86e-398">about_Hash_Tables</span><span class="sxs-lookup"><span data-stu-id="aa86e-398">about_Hash_Tables</span></span>](../Microsoft.PowerShell.Core/about/about_hash_tables.md)

[<span data-ttu-id="aa86e-399">使用 FilterHashtable 创建 Get-WinEvent 查询</span><span class="sxs-lookup"><span data-stu-id="aa86e-399">Creating Get-WinEvent queries with FilterHashtable</span></span>](/powershell/scripting/samples/Creating-Get-WinEvent-queries-with-FilterHashtable)

[<span data-ttu-id="aa86e-400">Format-Table</span><span class="sxs-lookup"><span data-stu-id="aa86e-400">Format-Table</span></span>](../Microsoft.PowerShell.Utility/Format-Table.md)

[<span data-ttu-id="aa86e-401">Group-Object</span><span class="sxs-lookup"><span data-stu-id="aa86e-401">Group-Object</span></span>](../Microsoft.PowerShell.Utility/Group-Object.md)

[<span data-ttu-id="aa86e-402">Sort-Object</span><span class="sxs-lookup"><span data-stu-id="aa86e-402">Sort-Object</span></span>](../Microsoft.PowerShell.Utility/Sort-Object.md)

[<span data-ttu-id="aa86e-403">Where-Object</span><span class="sxs-lookup"><span data-stu-id="aa86e-403">Where-Object</span></span>](../Microsoft.PowerShell.Core/Where-Object.md)
